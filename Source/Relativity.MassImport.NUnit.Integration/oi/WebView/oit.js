/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017-2018, Relativity ODA LLC. 
 Version 2020.1.0.110 
*/
(function(O,Y){var Xb,Yb;if(O.OIT){var la=O.OIT.view;la&&(la.detach?la.detach():la.unload&&la.unload())}O.OIT=function(){var b={};Object.defineProperties(b,{uninstall:{value:function(){oc&&oc(this)},writable:!0}});return b}();var Z=function(b,e){e||(e=Uc);return b.prototype=Object.create(e.prototype)},oc=function(){if(O.OIT){var b=O.OIT.view;b&&b.detach();O.OIT=void 0}},pb=function(b,e,d){Object.defineProperty(OIT,b,{value:e,writable:!!d})},y=function(){var b=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),d=[],c=1,a=function(c){if(b.test(c)){if(0===c.lastIndexOf("#",0))return a.byId(c.slice(1));if(0===c.lastIndexOf(".",0))return a.byClass(c.slice(1));if(0===c.indexOf(" "))return a.byTagName(c)}return a.bySelector(c)};Object.defineProperties(a,{html:{get:function(){return a.wrap(Y.documentElement)}},body:{get:function(){return a.wrap(Y.body)}},head:{get:function(){return a.wrap(a.html.childByTagName("head"))}},expando:{value:e}});a.byId=function(c){return a.wrap(Y.getElementById(c))};a.byClass=
function(c){return a.wrap(Y.getElementsByClassName(c))};a.byTagName=function(c){return a.wrap(Y.getElementsByTagName(c))};a.bySelector=function(c){return a.wrap(Y.querySelectorAll(c))};a.attach=function(c){(c=a.wrap(c))&&c.data("_elem",c);return c};a.detach=function(c){c&&a.removeData(c,"_elem")};a.query=function(c){return a.data(c,"_elem")};a.isElement=function(a){return a&&(a.dom||1===a.nodeType)};a.isText=function(a){return a&&3===a.nodeType};a.isDescendantOf=function(c,d){c=a.unwrap(c);if(d=a.unwrap(d))for(;c&&
c.parentNode;){if(c.parentNode===d)return!0;c=c.parentNode}return!1};a.nodeIndex=function(c){c=a.unwrap(c);for(var d=0;;){c=c.previousSibling;if(!c)break;++d}return d};a.unwrap=function(a){a&&a.dom&&(a=a.dom);return a};a.wrap=function(c){if(c){var d;if(!a.isElement(c)&&0<=c.length&&("function"===typeof c.item?d=[]:Array.isArray(c)&&(d=c),d)){for(var b=0;b<c.length;b++)d[b]=a.wrap(c[b]);0===d.length&&(d=null);return d}if(c.tagName&&!c.dom)return(d=a.query(c))||(d=new U(c)),d}return c};a.acceptsData=
function(a){return a&&(1===a.nodeType||9===a.nodeType)};a.data=function(b,f,g){b=a.unwrap(b);if(a.acceptsData(b)&&f){var q=b[e];if(void 0!==g){if(!q){do q=c++;while(void 0!==d[q]);Object.defineProperty(b,e,{value:q})}d[q]||(d[q]={});d[q].domNode=a.nodeToString(b);return d[q][f]=g}var k;q&&(g=d[q])&&(k=g[f]);void 0===k&&b.getAttribute&&(k=b.getAttribute("data-"+f),null===k&&(k=void 0));return k}};a.destroyData=function(b){b=a.unwrap(b);a.acceptsData(b)&&(b=b[e])&&(d[b]=void 0,b<c&&(c=b))};a.removeData=
function(c,b){c=a.unwrap(c);if(a.acceptsData(c)){var f=c[e];if(f)if(b){if(f=d[f]){delete f[b];var q;a:{for(q in f)if(Object.prototype.hasOwnProperty.call(f,q)){q=!0;break a}q=!1}q||a.removeData(c)}}else d[f]=void 0}c&&c.removeAttribute&&c.removeAttribute("data-"+b)};a.removeSubtreeData=function(c){a.removeData(c);for(c=c.firstElementChild;c;c=c.nextElementSibling)a.removeSubtreeData(c)};a.reset=function(){var b,e;for(e in d){var f=d[e];f&&(a.logUnreleasedData&&a.logUnreleasedData(f),b||(b=[]),b[e]=
f)}b?d=b:(d=[],c=1)};a.hasClass=function(c,b){if(Array.isArray(b)){for(var d=0;d<b.length;d++)if(a.hasClass(c,b[d]))return!0;return!1}if(c=a.unwrap(c)){if(c.classList)return c.classList.contains(b);if(c.getAttribute&&(d=c.getAttribute("class")))return d=" "+d+" ",b=" "+b.trim()+" ",-1!=d.indexOf(b)}return!1};var f=function(c,b){if(c.classList)c.classList.add(b);else if(c.getAttribute&&!a.hasClass(c,b)){var d=c.getAttribute("class");c.setAttribute("class",d+(" "+b))}};a.addClass=function(c,b){if((c=
a.unwrap(c))&&b){var d;if(Array.isArray(b))for(d=0;d<b.length;d++)f(c,b[d]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),d=0;d<b.length;d++)f(c,b[d]);else f(c,b)}};var g=function(a,c){if(a.classList)a.classList.remove(c);else if(a.getAttribute){var b=a.getAttribute("class").replace(c,"");a.setAttribute("class",b)}};a.removeClass=function(c,b){if((c=a.unwrap(c))&&b){var d;if(Array.isArray(b))for(d=0;d<b.length;d++)g(c,b[d]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),d=0;d<b.length;d++)g(c,b[d]);
else g(c,b)}};a.create=function(a,c,b,d){return new U(a,c,b,d)};a.createText=function(a){return Y.createTextNode(a)};a.listen=function(){return Y.addEventListener.apply(Y,arguments)};a.unlisten=function(){return Y.removeEventListener.apply(Y,arguments)};a.cursor=function(a){void 0!==a&&(Y.body.style.cursor=a);return Y.body.style.cursor};a.clearSelection=function(){O.focus();if(O.getSelection){var a=O.getSelection();null!==a&&a.removeAllRanges()}};a.selectRange=function(a,c,b,d){O.focus();if(O.getSelection){var e;
Ja(a)?e=a:(e=Y.createRange(),e.setStart(a,c),e.setEnd(b,d));a=O.getSelection();a.removeAllRanges();a.addRange(e)}};a.selectedText=function(){var a;if(O.getSelection){var c=O.getSelection();c&&(a=c.toString())}else Y.selection&&"Control"!=Y.selection.type&&(a=Y.selection.createRange().text);a||(a="");return a};a.nodeToString=function(c){if((c=a.unwrap(c))&&1===c.nodeType){var b=[];b.push("<",c.tagName.toLowerCase());if(c.classList)for(var d=0;d<c.classList.length;d++)b.push(".",c.classList[d]);c.id&&
b.push("#",c.id);b.push(">");return b.join("")}};return a}(),Uc=function(){var b=function(){},e=b.prototype;e.prop=function(b,c,a,e){"string"===typeof b&&void 0!==c&&Object.defineProperty(this,b,{value:c,writable:!!a})};e.deleteAll=function(){for(var b in this)this.hasOwnProperty(b)&&delete this[b]};e.invalidArg=function(b,c,a,e){var d="",d=c?d+("Invalid value specified for argument '"+c+"'"):d+"Invalid argument";a&&(d+=": '"+Ib(a)+"'");e&&(d+=", "+e);this.logError(b,d)};e.logError=function(b,c){var a;
this.publicName&&b&&(a=this.publicName+"."+b+": ");c&&(a=(a?a+": ":"")+String(c));a&&0<a.length&&D.on.error.dispatch(a,!1)&&console.error(a)};e.logFatalError=function(b,c,a,e){var d;this.publicName&&b&&(d=this.publicName+"."+b+": ");c&&(d=(d?d+": ":"")+String(c));a&&(d=(d?d+" ":"")+String(a));d&&0<d.length&&D.on.error.dispatch(d,!0)&&("warn"!==e&&(e="error"),console[e](d),la.unload(),la.showDocumentError(c))};e.logAJAXError=function(b,c,a,e,g){e===pc?c+=" (Request aborted)":e===Zb?c+=" (Request timed out)":
void 0!==e&&(c=c+" (HTTP Status "+e+")");e=[];a&&e.push(" [",a,"]");void 0!==g&&e.push(" responseText='",g,"'");this.logFatalError(b,c,e.join(""))};return b}(),U=function(){var b=[];b[0]=b[23]="right";b[5]=b[6]="up";b[11]=b[12]="left";b[17]=b[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var c=this.dom=Y.createElement(a),b=1;if(b<arguments.length){var d;"string"==typeof arguments[b]?d=arguments[b++]:Array.isArray(arguments[b])&&(d=arguments[b++].join(" "));d&&d.length&&
c.setAttribute("class",d)}b<arguments.length&&"string"==typeof arguments[b]&&(c.id=arguments[b++]);b<arguments.length&&(c=y.wrap(arguments[b++]))&&y.isElement(c)&&c.append(this)}else y.isElement(a)&&(this.dom=y.unwrap(a))},d=Z(e),c="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),a=function(a){Object.defineProperty(d,a,{get:function(){return this.dom[a]}})},f=0;f<c.length;f++)a(c[f]);Object.defineProperties(d,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=Q(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=Q(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=Q(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=Q(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=Q(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=Q(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,c=O.getComputedStyle(this.dom);c.marginLeft&&c.marginRight&&
(a+=parseFloat(c.marginLeft)+parseFloat(c.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,c=O.getComputedStyle(this.dom);c.marginTop&&c.marginBottom&&(a+=parseFloat(c.marginTop)+parseFloat(c.marginBottom));return a}}});d.focus=function(){this.dom.focus()};d.blur=function(){this.dom.blur()};d.toString=function(){return y.nodeToString(this)};d.parent=function(){if(this.dom)return y.wrap(this.dom.parentNode)};d.firstChildElem=function(){if(this.dom)return y.wrap(this.dom.firstElementChild)};
d.nextSiblingElem=function(){if(this.dom)return y.wrap(this.dom.nextElementSibling)};d.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};d.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();y.destroyData(this.dom);this.deleteAll()}};var g=function(a){for(var c=a.firstElementChild;c;c=a){a=c.nextElementSibling;g(c);var b=y.query(c);b?b.destroy():y.removeData(c)}};d.destroyChildren=function(){g(this.dom)};d.equals=
function(a){return this.dom==y.unwrap(a)};d.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};d.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};d.data=function(a,c){return y.data(this.dom,a,c)};d.ancestorData=function(a){for(var c,b=this.dom,d=y.unwrap(u.rootNode);b;){c=y.data(b,a);if(void 0!==c)break;if(b==d)break;b=b.parentNode}return c};d.removeData=function(a){y.removeData(this.dom,a)};
d.hasClass=function(a){return y.hasClass(this.dom,a)};d.addClass=function(a){y.addClass(this.dom,a);return this};d.removeClass=function(a){y.removeClass(this.dom,a);return this};d.attr=function(a,c){var b;if(Array.isArray(a)){for(var d={},n=0;n<a.length;n++)b=a[n],d[b]=this.dom.getAttribute(b);return d}if(void 0===c){if("string"===typeof a)return this.dom.getAttribute(a);for(b in a)a.hasOwnProperty(b)&&this.dom.setAttribute(b,a[b])}else null===c?this.dom.removeAttribute(a):this.dom.setAttribute(a,
c);return this};d.css=function(a,c){var b=this.dom;if(b){var b=b.style,d;try{if(Array.isArray(a)){for(var n={},e=0;e<a.length;e++)d=a[e],n[d]=b.getPropertyValue(ib[d]||d);return n}if(void 0===c)if("string"===typeof a){if(-1==a.indexOf(":"))return b.getPropertyValue(ib[a]||a);(n=db(a))&&this.css(n)}else for(d in a)a.hasOwnProperty(d)&&(e=a[d],null===e||void 0===e?b.removeProperty(ib[d]||d):b.setProperty(ib[d]||d,e,""));else null===c?b.removeProperty(ib[a]||a):b.setProperty(ib[a]||a,c,"")}catch(Ga){}}return this};
d.removeCSS=function(a){var c=this.dom;if(Array.isArray(a))for(var b=0;b<a.length;b++)c.style.removeProperty(a[b]);else if("string"===typeof a)c.style.removeProperty(a);else for(b in a)a.hasOwnProperty(b)&&c.style.removeProperty(b);return this};d.resetStyle=function(){return this.attr("style",null)};d.computedStyle=function(){return O.getComputedStyle(this.dom)};d.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};d.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};d.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};d.isHidden=function(){return this._hidden};d.autoscroll=function(a,c){var b=this.dom;switch(arguments.length){case 0:return{left:b.scrollLeft,top:b.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(b.scrollLeft=a),void 0!==c&&(b.scrollTop=c)}return this};d.scroll=function(a,c){void 0===a&&void 0===c||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};d.dscroll=function(a,c){this.cancelKinetic();a&&(this.scrollLeft+=a);c&&(this.scrollTop+=c);return this};d.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Vc(this,a));return this};d.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};d.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};d.append=function(){if(this.dom)for(var a=arguments,c=0;c<a.length;c++){var b=a[c];Array.isArray(b)?this.append.apply(this,b):
this.dom.appendChild(y.unwrap(b))}return this};d.insert=function(a,c){this.dom&&this.dom.insertBefore(y.unwrap(a),y.unwrap(c));return this};d.insertAfter=function(a,c){this.dom&&(a=y.unwrap(a),c=y.unwrap(c),c=c.nextSibling,this.dom.insertBefore(a,c));return this};d.insertFirst=function(a){this.dom&&this.dom.insertBefore(y.unwrap(a),this.dom.firstChild);return this};d.remove=function(a){this.dom&&this.dom.removeChild(y.unwrap(a));return this};d.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};d.transferFrom=function(a){a=y.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};d.forElementAndAncestors=function(a){for(var c=this,b=y.unwrap(u.rootNode);c&&!1!==a(c)&&c!=b;)c=c.parent();return this};d.forChildElements=function(a){return k.call(this,a,!1,arguments)};d.queryChildElements=function(a){return k.call(this,a,!0,arguments)};var k=function(a,c,b){for(var d=[null,-1],n=1;n<b.length;n++)d.push(b[n]);b=0;for(var e=this.dom.firstElementChild;e;e=
n,b++)if(n=e.nextElementSibling,e=!0===c?y.query(e):y.wrap(e))if(d[0]=e,d[1]=b,!1===a.apply(null,d))break;return this};d.pos=function(a){var c=this.dom;a=y.unwrap(a);if(a==c)return{left:0,top:0};for(;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c)return c=c.getBoundingClientRect(),c={left:c.left,top:c.top},a&&a!==Y.body&&(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top),c};d.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};d.rect=function(a){a=y.unwrap(a);for(var c=this.dom;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c){var b=c.getBoundingClientRect(),b={left:b.left,top:b.top,right:b.right,bottom:b.bottom,width:b.width,height:b.height};a&&a!==Y.body&&(a==c?(b.right-=b.left,b.bottom-=b.top,b.left=0,b.top=0):(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top,b.right-=a.left,b.bottom-=a.top));return b}};d.inRect=function(a,c){var b=this.dom;return b&&0<=a&&0<=c&&a<=b.clientWidth&&
c<=b.clientHeight};d.ancestorByClass=function(a){for(var c=this.parent(),b=u.rootNode;c&&c.hasClass;){if(c.hasClass(a))return c;if(c.equals(b))break;c=c.parent()}return null};d.childByTagName=function(a){a=a.toUpperCase();for(var c=this.dom.firstElementChild;c;c=c.nextElementSibling)if(c.tagName.toUpperCase()===a)return y.wrap(c);return null};d.childrenByTagName=function(a){var c=null;a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)b.tagName.toUpperCase()===a&&(c||
(c=[]),c.push(y.wrap(b)));return c};d.childByClass=function(a){if(this)for(var c=this.firstChildElem();c;c=c.nextSiblingElem())if(c.hasClass(a))return c;return null};d.byClass=function(a){return y.wrap(this.dom.getElementsByClassName(a))};d.byId=function(a){for(var c=[y.unwrap(this.dom)];0<c.length;)for(var b=c.shift().firstElementChild;b;b=b.nextElementSibling){if(b.id===a)return y.wrap(b);c.push(b)}return null};d.byTag=function(a){a=a.toUpperCase();for(var c=[y.unwrap(this.dom)],b=[];0<c.length;)for(var d=
c.shift().firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a?b.push(y.wrap(d)):c.push(d);if(b.length)return b};d.isDescendantOf=function(a){return y.isDescendantOf(this.dom,a)};d.mousePos=function(a){a||(a=O.event);for(var c={x:0,y:0},b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;if(a.pageX||a.pageY)c.x=a.pageX-c.x,c.y=a.pageY-c.y;else if(a.clientX||a.clientY)c.x=a.clientX+Y.body.scrollLeft+Y.documentElement.scrollLeft-c.x,c.y=a.clientY+Y.body.scrollTop+Y.documentElement.scrollTop-
c.y;return c};d.touchPos=function(a){if(a){var c={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var b=y.wrap(a.target).pos(this);c.x=a.center.x+b.left;c.y=a.center.y+b.top}else{for(b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;c.x=a.pageX-c.x;c.y=a.pageY-c.y}return c}};d.select=function(){O.focus();if(O.getSelection){var a=Y.createRange();a.selectNodeContents(this.dom);y.selectRange(a)}else Y.selection&&Y.body.createTextRange&&(a=Y.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var t=function(a){for(var c=!0;c;){var b=a.currentNode;if(1===b.nodeType)if("svg"===b.nodeName)c=a.skipNode();else if(b=y.data(b,"acc"),void 0!==b)if("none"===b)c=a.skipNode();else break;else break;else if(3===b.nodeType)break;else c=a.nextNode()}return c},v=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},q=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},p=function(){return t(this)},m=function(){var a=this.nextNode();a&&
(a=t(this));return a};d.createTreeWalker=function(a,c,b){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===c&&(c=null);void 0===b&&(b=!1);a=Y.createTreeWalker(this.dom,a,c,b);a.skipNode=v;a.skipToNode=q;a.firstACCNode=p;a.nextACCNode=m;return a};d.createCanvas=function(){return new qc(this)};d.on=function(a,c,b){void 0===b&&(b=c,c=void 0);if("function"!==typeof b)this.invalidArg("on"+a,"listener",b,"Must be a function");else{var d=Array.prototype.slice.call(arguments,2);d[0]=null;
c=c||this;var n,e=this.dom;n=a;var x=y.data(e,"_events");x||(x={},y.data(e,"_events",x));(e=x[n])||(e=x[n]=[]);n=e;for(x=0;x<n.length;x++)if(e=n[x],e.fn===b){e.ref=c;e.args=d;b=null;break}b&&(n.push({fn:b,ref:c,args:d}),1==n.length&&(d=this._events[a])&&d.add&&d.add(this,a))}return this};d.off=function(a,c,b){void 0===b&&(b=c);if("function"===typeof b&&(c=l(this.dom,a))){for(var d=0;d<c.length;d++)if(c[d].fn===b){c.splice(d,1);break}0===c.length&&(b=this._events[a])&&b.remove&&b.remove(this,a)}return this};
for(var l=function(a,c){var b=y.data(a,"_events");if(b&&(b=b[c])&&0<b.length)return b},K=function(a,c,b){a["on"+c]=function(a,b){1==arguments.length&&(b=a,a=null);if(2<arguments.length){for(var d=[c,a,b],n=2;n<arguments.length;n++)d.push(arguments[n]);return this.on.apply(this,d)}return this.on(c,a,b)};a["off"+c]=function(a,b){return this.off(c,a,b)};a._events||(a._events={});a._events[c]=b},F=function(a){var c=l(a.currentTarget,a.type);if(c){for(var b=!0,d=0;d<c.length;d++){var n=c[d];n.args[0]=
a;!1===n.fn.apply(n.ref,n.args)&&(b=!1);n.args[0]=null}b||jb(a)}},c="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),a={add:function(a,c){a.dom.addEventListener(c,F)},remove:function(a,c){a.dom.removeEventListener(c,F)}},f=0;f<c.length;f++)K(d,c[f],a);for(var c="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
N=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},H=function(a,c){var b=a.data("_gestures");!b&&c&&(b={listenerCount:0},a.data("_gestures",b));return b},a={add:function(a,c){var b=H(a,!0);b.touches||(b.touches=[],a.ontouchstart(I));b.listenerCount++;N(c)&&(b.dragCount||(b.dragCount=0,a.onmousedown(X)),b.dragCount++)},remove:function(a,c){var b=H(a);b&&(b.listenerCount--,0===b.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(I)),N(c)&&0<b.dragCount&&(b.dragCount--,
b.dragCount||a.offmousedown(X)))}},f=0;f<c.length;f++)K(d,c[f],a);var R={add:function(a,c){},remove:function(a,c){}};d.customEvent=function(a){K(this,a,R)};d.dispatchCustom=function(a,c){var b=!0,d=l(this.dom,a);if(d)for(var n=0;n<d.length;n++){var e=d[n];e.args[0]=c;!1===e.fn.apply(e.ref,e.args)&&(b=!1);b&&c.defaultPrevented&&c.defaultPrevented()&&(b=!1);e.args[0]=null}return b};var C=function(a,c,d,n,e){for(var x=!0;a&&a.dom&&!l(a.dom,c);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var x=d.start,
f=d.current,m=x.center,K=f.center,W=d.delta;W||(W=d.delta={x:0,y:0});W.x=K.x-m.x;W.y=K.y-m.y;if(W.x||W.y)d.moved=!0;var q=d.moved||!1,r=d.press?!!d.press.started:!1,g=Q($b(m.x,m.y,K.x,K.y)),h=m.x,E=m.y,p=K.x,F=K.y,h=Q(h==p&&E==F?0:Math.atan2(E-F,p-h),100),L;0<g&&(L=b[Math.floor((12*h/Math.PI+24)%24)]);E=1;p=0;d.touches&&1<d.touches.length&&(0<x.distance&&(E=f.distance/x.distance),p=ac(f.angle-x.angle));d={type:c,srcEvent:n,target:a.dom,distance:g,angle:h,scale:E,rotation:p,start:m,center:K,delta:W,
direction:L,moved:q,press:r,kinetic:!!e};O.OILogGesture&&O.OILogGesture(c,a,d);x=a.dispatchCustom(c,d);for(a=a.parent();x&&a&&a.dom;a=a.parent())l(a.dom,c)&&(x=a.dispatchCustom(c,d))}return x},M=function(a,c,b){c.press&&(c.press.started=!0,C(a,"press",c,b))},G=function(a,c,b){c.press&&(c.press.started&&C(a,"pressup",c,b),c.press.timer&&ra(c.press.timer),delete c.press)},h=function(a,c,b,d,n,e){a=b.kinetic;var x=!1,f;if(a){b.start=n;b.current=e;var m=Date.now()-a.frameTime,m=Math.exp(-m/325),l;a.ax&&
(f=-a.ax*m,.5>Math.abs(f)&&(f=0),b.current.center.x=n.center.x+a.tx+f);a.ay&&(l=-a.ay*m,.5>Math.abs(l)&&(l=0),b.current.center.y=n.center.y+a.ty+l);if(f||l)f=b.dragCount?"dragmove":"panmove",C(c,f,b,d,!0),x=!0,a.anim=eb(h,null,c,b,d,n,e)}x||(f=b.dragCount?"dragend":"panend",C(c,f,b,d,!0),delete b.kinetic,delete b.start,delete b.current)},B=function(a,c,b){c.pan&&(C(a,"pancancel",c,b),delete c.pan)},V=function(a){if(a){var c=Date.now();if(1==a.length){var b=a[0];a={x:Q(b.x),y:Q(b.y)};return{distance:0,
angle:0,center:a,time:c}}if(2<=a.length){for(var d=0,n,e=a.length-1,x=0;x<e;x++)for(var f=a[x],m=x+1;m<a.length;m++){var l=a[m],l=$b(f.x,f.y,l.x,l.y);l>d&&(d=l,n=f,b=a[m])}a:{if(a){var K,q;if(1==a.length){e=a[0];a={x:e.x,y:e.y};break a}if(2==a.length){e=a[0];K=a[1];a={x:(e.x+K.x)/2,y:(e.y+K.y)/2};break a}if(2<a.length){e={x:0,y:0};x=0;f=a.length-1;for(m=0;m<a.length;m++){K=a[m];q=m<f?a[m+1]:a[0];l=K.x;K=K.y;var r=q.x;q=q.y;var g=l*q-r*K,x=x+g;e.x+=(l+r)*g;e.y+=(K+q)*g}x*=3;e.x/=x;e.y/=x;a=e;break a}}a=
void 0}a.x=Q(a.x);a.y=Q(a.y);d=Q(d);e=n.x;n=n.y;x=b.x;b=b.y;return{distance:d,angle:Q(e==x&&n==b?0:Math.atan2(n-b,x-e),100),center:a,time:c}}}};d.kinetic=function(a){!0===a?H(this,!0).enableKinetic=!0:!1===a&&(a=H(this))&&delete a.enableKinetic};d.cancelKinetic=function(){var a=H(this);a&&a.kinetic&&(a.kinetic.anim&&bc(a.kinetic.anim),delete a.kinetic)};var I=function(a){var c=H(this);if(c){this.cancelKinetic();var b=c.touches,d=a.changedTouches,e=u.viewNode,n=null;c.dragCount||(n=this.pos(e));for(var x=
0;x<d.length;x++){var f=e.touchPos(d[x]);n&&(f.x-=n.left,f.y-=n.top);f.ox=f.x;f.oy=f.y;b.push(f)}c.current=V(c.touches);c.start=c.current;1==b.length?(delete c.tap,c.tap={time:c.current.time},G(this,c,a),a=da(M,500,null,this,c,a),c.press={timer:a}):1<b.length&&!c.pinch&&(delete c.tap,G(this,c,a),B(this,c,a),delete c.distance,c.pinch||(c.pinch={},C(this,"pinchstart",c,a)));ab.setTouchCapture(r,A,ea,this);return!1}},r=function(a){var c=H(this);if(c){for(var b=c.touches,d,e=a.changedTouches,n=c.dragCount?
u.viewNode:this,x=0;x<e.length;x++)for(var f=n.touchPos(e[x]),m=0;m<b.length;m++)if(d=b[m],d.identifier===f.identifier){d.x=f.x;d.y=f.y;d.dx=f.x-d.ox;d.dy=f.y-d.oy;break}d=c.current;e=V(c.touches);if(e.distance!==d.distance||e.angle!==d.angle||e.center.x!==d.center.x||e.center.y!==d.center.y)if(c.previous=d,c.current=e,1!=b.length||c.multi)1<b.length&&(c.multi=!0,c.pinch&&(b=c.previous,d=c.current,e=c.start,0<e.distance&&(n=Q(b.distance/e.distance,100),Q(d.distance/e.distance,100)!=n&&C(this,"pinchmove",
c,a)),d.angle!=b.angle&&(c.rotate||(c.rotate={start:c.start.angle},C(this,"rotatestart",c,a)),C(this,"rotatemove",c,a))));else if(d=b[0],b=c.distance=$b(d.dx,d.dy,0,0),d=e.time-c.start.time,10<b&&50<d&&(delete c.tap,c.press&&c.press.started||G(this,c,a),c.pan||(B(this,c,a),c.pan={startTime:c.current.time},c.enableKinetic&&!c.press&&(c.kinetic={vx:0,vy:0,frameTime:c.current.time,frameX:0,frameY:0}),C(this,c.dragCount?"dragstart":"panstart",c,a)),c.pan&&(C(this,c.dragCount?"dragmove":"panmove",c,a),
a=c.kinetic)))b=c.current.time,d=b-a.frameTime,e=c.delta,c.pan.moveTime=b,c=e.y-a.frameY,a.vx=1E3*(e.x-a.frameX)/(d+1)*.8+.2*a.vx,a.vy=1E3*c/(d+1)*.8+.2*a.vy,a.vx=ca(a.vx,-1E4,1E4),a.vy=ca(a.vy,-1E4,1E4),a.frameTime=b,a.frameX=e.x,a.frameY=e.y;return!1}},A=function(a){na(this,a,!1)},ea=function(a){na(this,a,!0)},na=function(a,c,b){var d=H(a);if(d){var e=d.touches,n=e.length-c.changedTouches.length;try{if(1==e.length)if(b)delete d.tap,G(a,d,c),B(a,d,c);else{if(d.pan){var x=Date.now(),f=x-d.pan.startTime;
b=!1;var m,l=d.kinetic;l&&(150<x-d.pan.moveTime&&(l.vx=0,l.vy=0),10<Math.abs(l.vx)&&(l.ax=.8*l.vx,l.tx=Math.round(d.delta.x+l.ax)),10<Math.abs(l.vy)&&(l.ay=.8*l.vy,l.ty=Math.round(d.delta.y+l.ay)),l.ax||l.ay?(l.frameTime=x,l.anim=eb(h,null,a,d,c,d.start,d.current),b=!0):delete d.kinetic);b||(m=d.dragCount?"dragend":"panend",C(a,m,d,c));if(!(d.dragCount||d.press&&d.press.started)&&1E3>f){var K=d.touches[0],q=Math.abs(K.dx),r=Math.abs(K.dy);60<=q&&60>r?m=0>K.dx?"swiperight":"swipeleft":60<=r&&60>q&&
(m=0>K.dy?"swipeup":"swipedown");m&&C(a,m,d,c)}delete d.pan}G(a,d,c);d.tap&&(200>Date.now()-d.tap.time&&C(a,"tap",d,c),delete d.tap)}else 1<e.length&&1>=n&&(b?(d.rotate&&(C(a,"rotatecancel",d,c),delete d.rotate),d.pinch&&(C(a,"pinchcancel",d,c),delete d.pinch)):(d.rotate&&(C(a,"rotateend",d,c),delete d.rotate),d.pinch&&(C(a,"pinchend",d,c),delete d.pinch)))}catch(Mb){D.logError(null,Mb)}a=c.changedTouches;for(c=0;c<a.length;c++)for(x=a[c],f=0;f<e.length;f++)if(e[f].identifier===x.identifier){e.splice(f,
1);break}delete d.distance;0===e.length&&(delete d.start,delete d.current,delete d.previous,delete d.multi,ab.releaseTouchCapture());return!1}},L=function(a){a=u.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},X=function(a){if(0===(a.button||0)){var c=L(a),b=H(this,!0);b.start=c;b.current=c;if(!C(this,"dragstart",b,a))return ab.setMouseCapture(n,x,this),!1}},n=function(a){var c=L(a),b=H(this,!0);if(b&&b.current){var d=b.current.center;if(c.center.x!=d.x||c.center.y!=d.y)b.current=
c,C(this,"dragmove",b,a);return!1}},x=function(a){var c=H(this,!0);C(this,"dragend",c,a);ab.releaseMouseCapture();return!1};return e}(),cc=function(){var b=function(b,c,a){U.call(this,"input",a);this.dom.type="button";"string"===typeof b&&(this.dom.value=b);"string"===typeof c&&(this.dom.title=c)},e=Z(b,U);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(b){this.dom.disabled=b}}});return b}(),rc=function(){var b=function(b,c){U.call(this,"textarea",c);"string"===
typeof b&&(this.dom.value=b)},e=Z(b,U);Object.defineProperties(e,{value:{get:function(){return this.dom.value},set:function(b){this.dom.value=b}}});e.moveCaret=function(b){var c=this.dom;c.createTextRange?(c=c.createTextRange(),c.move("character",b),c.select()):void 0!==c.selectionStart?(c.focus(),c.setSelectionRange(b,b)):c.focus()};return b}(),qc=function(){var b=function(a,c){U.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=c):1===arguments.length&&(this.dom.width=a.clientWidth,
this.dom.height=a.clientHeight,y.wrap(a).append(this))},e=Z(b,U);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var d=function(a,c,b,d,e,v,q,p){this.globalAlpha=1;void 0!==e&&(this.fillStyle=e);v?(this.strokeStyle=v,this.lineWidth=q||1,this.lineCap="square",this.beginPath(),this.setLineDash(p||[]),this.rect(a,c,b,d),e&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,c,b,d))},c=function(a,c,b,
d,e,v,q){void 0!==e&&(this.strokeStyle=e);this.lineWidth=v||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(q||[]);this.moveTo(a,c);this.lineTo(b,d);this.stroke();this.closePath()};e.getContext=function(a){a=this.dom.getContext(a);a.oitrect=d;a.oitline=c;return a};return b}(),Ya=function(){var b=function(b,d){this.prop("list",b);this.prop("name",d)};Z(b);return b}(),rb=function(){var b=function(b){this._createFn=b;this._plugins={}},e=Z(b);e.item=function(b){return this._plugins[b]};
e.items=function(){return this._plugins};e.extend=function(b,c){if(Array.isArray(b))for(var a=0;a<b.length;a++)this.extend.call(this,b[a],c);else{if("string"===typeof b)return a=this._plugins[b],a||(a=this._createFn.call(this,b))&&(this._plugins[b]=a),a&&a.extend.call(a,c),a;if("object"===typeof b)for(a in b)this.extend.call(this,a,b[a])}};return b}(),u=function(){var b=new rb(function(e){return new sc(b,e)});b.reset=function(b,d){if("string"===typeof b){"boolean"!==typeof d&&(d=!0);var c=this._plugins[b];
c&&c.reset(d)}};b.resetAll=function(b){"boolean"!==typeof b&&(b=!0);for(var d in this._plugins)this._plugins[d].reset(b)};b.defaultVal=function(b){if(b=this._plugins[b])return b.defaultVal()};b.setProperty=function(b,d,c){(b=this._plugins[b])&&b.setProperty(d,c)};return b}(),sc=function(){var b=function(b,c){Ya.call(this,b,c)},e=Z(b,Ya);e.extend=function(b){b=b||{};var c={_v:{value:void 0,writable:!0}};b.init&&(c.init={value:b.init});void 0!==b.def&&(c.def={value:b.def});this.list!==u&&(!0===b.pub&&
(c.pub={value:b.pub}),b.legal&&(c.legal={value:b.legal}),b.validate&&(c.validate={value:b.validate}),b.type&&(c.type={value:b.type||"boolean"},"number"===b.type||Array.isArray(b.type)&&-1!=b.type.indexOf("number")))&&("number"===typeof b.min&&(c.min={value:b.min}),"number"===typeof b.max&&(c.max={value:b.max}));Object.defineProperties(this,c);var a=this;this.list["on"+this.name]=function(c,b){return a.listen(c,b)};this.list["off"+this.name]=function(c,b){return a.unlisten(c,b)};Object.defineProperty(this.list,
this.name,{enumerable:!0,get:function(){return void 0===a._v&&(a.init&&(a._v=a.init()),void 0===a._v)?a.defaultVal():a._v},set:function(c){a.set(c)}})};e.listen=function(b,c){void 0===c&&(c=b,b=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:b,fn:c})};e.unlisten=function(b,c){if(this._listeners){void 0===c&&(c=b);for(var a=0;a<this._listeners.length;a++)if(this._listeners[a].fn==c){this._listeners.splice(a,1);break}}};e.set=function(b,c){if(b!==this._v){if(void 0!==b){var a=
!0;if(this.type){var d=null===b?"null":typeof b,a=d===this.type;!a&&Array.isArray(this.type)&&(a=-1!=this.type.indexOf(d));a||"string"!==d||(a="color"===this.type,!a&&Array.isArray(this.type)&&(a=-1!=this.type.indexOf("color")),a&&(d="color"));a&&"color"===d?Da(b)||(this.pub&&D.invalidArg("setOptions",this.name,b,"Must be a CSS color string"),b=this._v):a||("null"===d?b=void 0:(this.pub&&(d=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,
D.invalidArg("setOptions",this.name,b,d)),b=this._v))}a&&(this.legal&&-1==this.legal.indexOf(b)?(this.pub&&D.invalidArg("setOptions",this.name,b,"Must be one of "+JSON.stringify(this.legal)),b=this._v):void 0!==this.min&&b<this.min?(this.pub&&D.invalidArg("setOptions",this.name,b,"Using minimum value of "+this.min,!1),b=this.min):void 0!==this.max&&b>this.max?(this.pub&&D.invalidArg("setOptions",this.name,b,"Using maximum value of "+this.max,!1),b=this.max):this.validate&&(b=this.validate(this.name,
b,this._v)))}if(b!==this._v){a=this._v;if("object"===this.type){this._v={};for(var e in b)b.hasOwnProperty(e)&&(this._v[e]=b[e])}else this._v=b;if(!1!==c&&this._listeners)for(e=0;e<this._listeners.length;e++)d=this._listeners[e],d.fn.call(d.context,this._v,a,this.name)}}};e.setProperty=function(b,c){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[b]!==c))if(this._v||(this._v={}),this._v[b]!==c&&(this._v[b]=c,this._listeners))for(var a=0;a<this._listeners.length;a++){var d=
this._listeners[a];d.fn.call(d.context,this._v,null,this.name)}};e.reset=function(b){this.set(void 0,b)};e.defaultVal=function(){return this.def};return b}();u.extend({URL:{init:function(){return Y.URL}},baseURL:{init:function(){return w.outputBaseUrl}},viewNode:{init:function(){var b=u.rootNode;if(b)return y.attach(b.childByClass("oit-view"))}},rootNode:{init:function(){var b=y.byClass("oit-view-root");if(b&&0<b.length)return y.attach(b[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},
documentLoaded:{def:!1},documentComplete:{def:!1},documentUnloading:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return tc()}},isMobileOrTablet:{init:function(){return uc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1},httpHeaders:{def:null},withCredentials:{def:!1}});var w=function(){var b=new rb(function(e){return new sc(b,e)});b.isPublic=function(b){return(b=this._plugins[b])&&b.pub};b.reset=
function(b){bb(this._plugins,"reset",null,b)};b.reset=function(b,d){if("string"===typeof b){"boolean"!==typeof d&&(d=!0);var c=this._plugins[b];c&&c.reset(d)}};b.resetAll=function(b){"boolean"!==typeof b&&(b=!0);for(var d in this._plugins)this._plugins[d].reset(b)};b.defaultVal=function(b){if(b=this._plugins[b])return b.defaultVal()};b.setProperty=function(b,d,c){(b=this._plugins[b])&&b.setProperty(d,c)};return b}();w.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,
type:"string",legal:["large","small","micro","none"],init:function(){return u.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},
highlightActivationBoxColor:{pub:!0,type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],
init:function(){return u.isMobileOrTablet?"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(b,e,d){return T.validateMode(e,d)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return u.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",
def:!1},showAnnotations:{pub:!0,type:"boolean",def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,
type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER","FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},
"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},"TITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},
{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"JOBTITLE","WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",
fields:[[{g:"ADDRESS",t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},
"BUSINESSPOSTALCODE"],[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",
t:"Home",id:"STATE"},"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],
{g:"ADDRESS",t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},
"OTHERPOSTALCODE"],[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM",
"TO","CC","BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME","CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(u.viewNode.clientWidth/
2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"},normalizeAccentsForSearch:{pub:!0,type:"boolean",def:!0},disableLoadingSkeleton:{pub:!0,type:"boolean",def:!1}});var Wc=function(){var b=function(a,c,b){Ya.call(this,c,b);this.prop("host",a,!1,!0)},e=Z(b,Ya),d=function(a,c,b){var d=a._int;if(d)for(var e=
0;e<d.length;e++){var m=d[e];if(!(m.fn!==c||void 0!==b&&m.context!==b||a._xint&&-1!==a._xint.indexOf(e)))return e}return-1},c=function(a,c){var b=a._pub;return b?b.indexOf(c):-1},a=function(a,c,b,e){void 0===b&&(b=c,c=void 0);if(-1===d(a,b,c)){var m=!a.hasListeners(),f={context:c,fn:b};!0===e&&(f.listenOnce=!0);a.single&&a.hasListeners()?a.logError(null,"Only one listener may be registered for the "+a.name+" event."):(a._int||a.prop("_int",[],!0),a._int.push(f),m&&a.isSystemEvent()&&a.list.addElementListeners(a.name),
a.onListen&&a.onListen.call(null,a,b,c))}},f=function(a,c){-1!=c&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(c)):(a._int.splice(c,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},g=function(a,c){-1!=c&&(a.dispatching?(a._xpub||(a._xpub=[]),a._xpub.push(c)):(a._pub.splice(c,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},k=function(){var a;this.detail&&
(a=this.detail.apply(null,arguments));var c=this.systemEventName||this.name,b=Y.createEvent("CustomEvent");b.initCustomEvent(c,!0,!0,a);return b},t=function(){var a=!0,c,b;this.dispatching=!0;var d=this._int;if(d)for(c=d.length,b=0;b<c;b++){var e=d[b];e.listenOnce&&f(this,b);!1===e.fn.apply(e.context,arguments)&&(a=!1)}d=this._pub;if(a&&d){a=k.apply(this,arguments);c=d.length;for(b=0;b<c;b++)d[b].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));
this.dispatching=!1;if(this._xint){for(b=this._xint.length-1;0<=b;b--)f(this,this._xint[b]);delete this._xint}if(this._xpub){for(b=this._xpub.length-1;0<=b;b--)g(this,this._xpub[b]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",
a.onUnlisten),this.prop("onAdd",a.onAdd),this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,value:this}))};e.enable=function(){this.disabled=!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,c){if(a){this._def&&this.setDefaultListener(null);var b=!this.hasListeners();this._def=
{context:c,fn:a};b&&this.isSystemEvent()&&this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,a,c)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,this))};e.listen=function(c,b){a(this,c,b,!1)};e.listenOnce=function(c,b){a(this,c,b,!0)};e.unlisten=function(a,c){void 0===c&&(c=a,a=void 0);f(this,d(this,c,a))};e.addPublicListener=function(a){var b=!1;
if(this.pub&&"function"===typeof a)if(-1!==c(this,a))b=!0;else{var d=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,"Only one listener may be registered for the "+this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(a),d&&this.isSystemEvent()&&this.list.addElementListeners(this.name),this.onAdd&&this.onAdd.call(null,this,a),b=!0)}return b};e.removePublicListener=function(a){a=c(this,a);if(-1==a)return!1;g(this,a);return!0};e.dispatch=function(){this.logDispatch&&
this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay||u.documentUnloading)return t.apply(this,arguments);this._dispatchTimer&&ra(this._dispatchTimer);this._ddArgs=arguments;this._dispatchTimer=da(v,this.delay,this)}return!0};var v=function(){t.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=function(a,c){var b=k.apply(this,c);a.call(void 0,b);return!b.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};
return b}(),vc=function(){var b="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),e=function(a){for(a=y.unwrap(a);a;){var c=y.data(a,"dispatcherData");if(c)return c;a=a.parentNode}},d=function(a){return new Wc(this._host,this,a)},c=function(a,c){rb.call(this,d);this.name=c;this._host=a;this._eventElements=[];var b=this;this.onSystemEvent=function(a){var c=!0,d=b[a.type];if(d&&d.hasListeners()&&!d.disabled){var f=e(a.currentTarget||
a.target);if(f)for(var m=0;c&&m<f.length;m++){var l=f[m];l.args[1]=a;c=d.dispatch.apply(d,l.args);l.args[1]=null}}c||jb(a);return c}},a=Z(c,rb);a.enable=function(){this.disabled=!1};a.disable=function(){this.disabled=!0};a.addElementListeners=function(a){if(this[a]){var c,d;if(-1!==b.indexOf(a))for(c=0;c<this._eventElements.length;c++)d=this._eventElements[c],d.addEventListener(a,this.onSystemEvent,!1);else for(c=0;c<this._eventElements.length;c++)d=this._eventElements[c],y.wrap(d).on(a,this,this.onSystemEvent)}};
a.removeElementListeners=function(a){if(this[a]){var c;if(-1!==b.indexOf(a))for(c=0;c<this._eventElements.length;c++)this._eventElements[c].removeEventListener(a,this.onSystemEvent);else for(c=0;c<this._eventElements.length;c++)y.wrap(this._eventElements[c]).off(a,this,this.onSystemEvent)}};a.addElement=function(a,c){if((a=y.unwrap(a))&&a.addEventListener){var d;if(-1==this._eventElements.indexOf(a))for(d in this._eventElements.push(a),this._plugins){var f=this[d];if(f.isSystemEvent()&&f.hasListeners())if(-1!==
b.indexOf(d))a.addEventListener(d,this.onSystemEvent,!1);else y.wrap(a).on(d,this,this.onSystemEvent)}f={context:c,args:[y.wrap(a),null]};for(d=1;d<arguments.length;d++)f.args.push(arguments[d]);var g=e(a);g||(g=[],y.data(a,"dispatcherData",g));var q=!1;for(d=0;d<g.length;d++)if(g[d].context===c){g[d]=f;q=!0;break}q||g.push(f)}};a.removeElement=function(a,c){a=y.unwrap(a);var d=this._eventElements.indexOf(a);if(-1!=d){var f=!0;if(void 0===c)y.removeData(a,"dispatcherData");else{var g=e(a);if(g){for(var q=
0;q<g.length;q++)if(g[q].context===c){1==g.length?g=null:g.splice(q,1);break}g&&0!==g.length?f=!1:y.removeData(a,"dispatcherData")}}if(f){this._eventElements.splice(d,1);for(var p in this._plugins)d=this[p],d.isSystemEvent()&&d.hasListeners()&&(-1!==b.indexOf(p)?a.removeEventListener(p,this.onSystemEvent):y.wrap(a).off(p,this,this.onSystemEvent))}}};a.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};a.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=
this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+="]")}return this._eventMessage};return c}(),Qa=new vc(null,"globalEvents");Qa.extend({install:{},init:{}});var za=function(){return new rb(function(b){return new Xc(b)})}(),Xc=function(){var b="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
e=function(a){Ya.call(this,za,a)},d=Z(e,Ya),c=function(a,c){a["on"+c.name]=function(a,b){c.listen(a,b)};a["off"+c.name]=function(a,b){c.unlisten(a,b)}};d.extend=function(a){this.def=a;Qa.install.listen(this,this.install);var d=a.events;a=a.userEventDef;if(d||a){this.on||(this.on=new vc(this,this.name));if(d)for(var e in d){var f=d[e],v=this.on.extend.call(this.on,e,f);c(this,v);f&&f.pub&&(this.hasPublicEvents=!0)}a&&(a.systemEvent=!0,this.on.extend.call(this.on,b,a),a.pub&&(this.hasPublicEvents=!0))}};
d.install=function(){var a=this,c=this.def;delete this.def;c.install&&c.install(this);if(a.hasPublicEvents||c.exports&&0<c.exports.length){OIT[a.name]||(pb(a.name,{}),a.publicName="OIT."+a.name);var b={};a.hasPublicEvents&&(a.addEventListener||(b.addEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.addPublicListener(b):a.invalidArg("addEventListener","name",c,a.on.eventMessage());return d}}),a.removeEventListener||(b.removeEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.removePublicListener(b):
a.invalidArg("removeEventListener","name",c,a.on.eventMessage());return d}}));if(c.exports&&0<c.exports.length)for(var d=0;d<c.exports.length;d++){var e=c.exports[d],q=a[e];void 0!==q&&(b||(b={}),b[e]={value:q})}Object.defineProperties(OIT[a.name],b)}};var a=function(c,b){if(Array.isArray(b))for(var d=0;d<b.length;d++){if(a(c,b[d]))return!0}else{if(void 0===c)return!0;switch(b){case "null":if(null===c)return!0;break;case "function":if(null===c||Fa(c))return!0;break;case "DOMRange":if(null===c||Ja(c))return!0;
break;case "DOMSelection":if(null===c||Aa(c))return!0;break;case "RegExp":if(null===c||c instanceof RegExp)return!0;break;case "string":if(null===c||"string"===typeof c)return!0;break;default:if(typeof c===b)return!0}}return!1};d.processArguments=function(c,b,d){for(var e={},f=0,g=0;f<d.length;f++){var p=d[f];e&&p.def&&(e[p.name]=p.def);if(g>=b.length)p.req&&(this.logError(c,"Argument '"+p.name+"' is required"),e=null);else{var m=b[g];if(a(m,p.type)){var l=null;p.val?l=p.val(m):p.legal&&-1==p.legal.indexOf(m)&&
(l="Must be one of "+JSON.stringify(p.legal));l?(this.invalidArg(c,p.name,m,l),e=null):e&&(e[p.name]=m);g++}else p.req&&(this.invalidArg(c,p.name,m,"Must be of type "+JSON.stringify(p.type)),g++,e=null)}}return e};return e}(),sb=function(){return new rb(function(b){return new Yc(b)})}(),Yc=function(){var b=function(b){Ya.call(this,sb,b)},e=Z(b,Ya);e.extend=function(b){this.def=b;Qa.install.listen(this,this.install)};e.install=function(){var b=this.def;delete this.def;b.install&&b.install(this)};e.init=
function(b){if(b.isLoaded())this.load(b);else{var c=this;b.load(!0,function(){c.load(b)})}};e.load=function(b){};e.unload=function(){};e.visiblePages=function(){return[z.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(b){};e.maxPageWidth=function(){return z.maxWidth()};e.maxPageHeight=function(){return z.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollPadding=function(){};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=
function(){return u.viewNode.scroll()};e.startElasticScroll=function(){};e.elasticScroll=function(b,c){};e.endElasticScroll=function(b,c){};e.getSelectedText=function(){return y.selectedText()};e.select=function(b){return!1};e.keydown=function(b){return!0};e.showHidden=function(b){};e.loadRange=function(b,c){c&&c(b)};e.expandRange=function(b){return b};e.moveto=function(b,c,a){return!1};e.pageRange=function(b,c){};e.pageRect=function(b,c,a){return z.elementRect(z.page(b),c)};e.rangeRect=function(b,
c,a,e){};e.rangeFromRect=function(b,c,a,e,g,k,t){};e.extendRange=function(b,c,a,e){};e.moveAnchor=function(b,c,a,e){return!1};e.incrementSelection=function(b,c,a,e,g){return!1};e.layoutChanged=function(b){};e.update=function(b){};return b}(),va=function(){var b=new rb(function(b){return new Zc(b)});b.createDisplay=function(e){if(e=b.item(e))return sb.item(e.de)};b.features=function(e){if(e=b.item(e))return e.features};return b}(),Zc=function(){var b="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),
e=function(b){Ya.call(this,va,b)};Z(e,Ya).extend=function(d){this.de=d.de;for(var c=this.features={},a=0;a<b.length;a++){var e=b[a],g=d[e];void 0===g&&(g=!0);c[e]=g}};return e}(),ib,db,dc,kb,La,Da,ec,zb,aa=function(b){return"number"===typeof b},fb=function(b){return"string"===typeof b};(function(){var b={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,d=1/3,c=2/3,a=function(a,b,d){0>d?d+=1:1<d&&--d;d<e?a+=(b-a)*d*6:.5>d?a=b:d<c&&(a+=(b-a)*(c-d)*6);return 255*a|0},f=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],g=function(a,c,b){var d=Y.documentElement;
if(fb(d.style[a]))return c;if(!1!==b)for(a=a.charAt(0).toUpperCase()+a.slice(1),b=0;b<f.length;b++)if(fb(d.style[f[b].property+a]))return f[b].css+c},k=function(a,c){for(var b,d=Y.createElement("div"),e=0;e<c.length;e++)if(d.style[a]=c[e],d.style[a]===c[e]){b=c[e];break}return b};ib={transform:g("transform","transform"),"transform-origin":g("transformOrigin","transform-origin")};Xb=k("cursor",["grab","-webkit-grab","-moz-grab","move"]);Yb=k("cursor",["grabbing","-webkit-grabbing","-moz-grabbing",
"move"]);var t=function(a,c){if(-1!=c)for(var b=a.chars;c<b.length;c++){var d=b[c];if(" "!==d&&"\n"!==d&&"\r"!==d&&"\t"!==d){"/"===d&&"*"===b[c+1]&&(b=a.string.indexOf("*/",c+2),c=-1==b?a.string.length:b+2);break}}return c},v=function(a,c,b){return-1!=c&&a.chars[c]!==b?-1:++c};db=function(a){var c;if(a){c={};a={string:a,chars:a.split("")};for(var b=0;-1!=b&&b<a.chars.length;){var d=a,e=b,b=c,f={},g=e=t(d,e);if(-1!=g){for(var q=d.chars,e=g;e<q.length;e++){var k=q[e];if(!("a"<=k&&"z">=k||"A"<=k&&"Z">=
k||"0"<=k&&"9">=k)&&"-"!==k&&"_"!==k)break}e>g?(f.name=d.string.substring(g,e),g=e):g=-1}e=g;e=t(d,e);e=v(d,e,":");g=e=t(d,e);if(-1!=g){q=d.chars;for(e=g;e<q.length;e++){k=q[e];if("!"===k||";"===k)break;if('"'===k||"'"===k||"("===k){"("===k&&(k=")");for(var C=e+1;C<q.length;C++){var M=q[C];if(M===k){e=C;break}else if("\\"===M){M=q[++C];if("0"<=M&&"9">=M||"a"<=M&&"f">=M||"A"<=M&&"F">=M){do M=q[++C];while("0"<=M&&"9">=M||"a"<=M&&"f">=M||"A"<=M&&"F">=M)}e=C;break}}}}e>g?(f.value=d.string.substring(g,
e),g=e):g=-1}e=g;e=t(d,e);g=f;-1!=e&&"!important"===d.string.substring(e,e+10)&&(g.important=!0,e+=10);e=t(d,e);e<d.chars.length&&(e=v(d,e,";"));-1!=e&&(b[f.name]=f.value);b=e}}return c};dc=function(a,c){var b=[];if(a)for(var d in a)a.hasOwnProperty(d)&&(c?b.push(d,":",a[d]," !important;"):b.push(d,":",a[d],";"));return b.join("")};kb=function(a,c){if(a&&fb(a)&&fb(c)){for(var b=0;;){b=a.indexOf(c,b);if(-1===b||0===b)break;var d=a.charAt(b-1);if(";"==d||" "==d)break;b++}if(-1!=b){for(b+=c.length;" "===
a.charAt(b);)b++;if(":"===a.charAt(b)){for(b++;" "===a.charAt(b);)b++;d=a.indexOf(";",b);-1===d&&(d=a.length);for(;d>b&&" "===a.charAt(d-1);)d--;return a.substring(b,d)}}}};La=function(){var a=arguments;if(1==a.length){a=a[0];if(fb(a))a=Da(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return La(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var c=Q(ca(a[0],0,255)),b=Q(ca(a[1],0,255)),d=Q(ca(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=ca(a[3],0,1));if(1!=e)return"rgba("+
c+","+b+","+d+","+e+")";c=c.toString(16);b=b.toString(16);d=d.toString(16);2>c.length&&(c="0"+c);2>b.length&&(b="0"+b);2>d.length&&(d="0"+d);return"#"+c+b+d}};Da=function(c){if(c){var e,f;if(0===c.indexOf("#")){if(e={r:parseInt(c.substring(1,3),16),g:parseInt(c.substring(3,5),16),b:parseInt(c.substring(5,7),16),a:1},isNaN(e.b)){f=c.substring(1,2);var l=c.substring(2,3);c=c.substring(3,4);l+=l;c+=c;e.r=parseInt(f+f,16);e.g=parseInt(l,16);e.b=parseInt(c,16)}}else if(0===c.indexOf("rgba(")||0===c.indexOf("rgb(")){e=
c.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===c.indexOf("hsla(")||0===c.indexOf("hsl(")){e=c.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);f=e[0];c=e[1];l=e[2];f/=360;c/=100;l/=100;if(0===c)l=c=f=255*l|0;else{var K=.5>l?l*(1+c):l+c-l*c,g=2*l-K,l=a(g,K,f+d);c=a(g,K,f);f=a(g,K,f-d)}e={r:l,g:c,
b:f,a:e[3]}}else if(f=b[c.toLowerCase()])return Da(f);if(e)return e.r=ca(e.r,0,255),e.g=ca(e.g,0,255),e.b=ca(e.b,0,255),e.a=ca(e.a,0,1),e}};ec=function(a,c,b,d){1<b||(b=1);var e=Da(a);c=Da(c);if(!e||!c)return a;var f;!0===d?(a=(e.r+c.r*b)/(1+b),d=(e.g+c.g*b)/(1+b),f=(e.b+c.b*b)/(1+b),b=(e.a+c.a*b)/(1+b)):(c.a=1-e.a,a=e.r*e.a+c.r*c.a,d=e.g*e.a+c.g*c.a,f=e.b*e.a+c.b*c.a,b=1);return La(a,d,f,b)};zb=function(a){if(void 0!==a&&null!==a&&""!==a){var c=Number(a);if(!isNaN(c))return c+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();
var S;OIT.local||pb("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",
DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",MOVED_TEXT:"Moved Text",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",
PLEASE_WAIT_CONVERTING:"Document conversion in progress...",PLEASE_WAIT_DOWNLOADING:"Loading document...",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",
HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",
HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",
DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",
DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",
DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",
EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",
EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",
EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",
EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",
EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",
EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",
EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",
EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",
EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",
EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",
EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",
EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",
EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",
EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",EMAIL_DATE:"Date",MULTIMEDIA_AUDIO:"audio",MULTIMEDIA_AUDIO_IND:"an audio",MULTIMEDIA_VIDEO:"video",MULTIMEDIA_VIDEO_IND:"a video",MULTIMEDIA:"multimedia",MULTIMEDIA_IND:"a multimedia",MULTIMEDIA_UNSUPPORTED_FORMAT:"Sorry, your browser does not support playing this multimedia format.",MULTIMEDIA_INTERNAL_ERROR:"Sorry, Relativity encountered an error while attempting to play this multimedia file.<br/>Please contact your administrator.",
MULTIMEDIA_PLAYBACK_WARNING_TITLE:"Video playback issues",MULTIMEDIA_PLAYBACK_WARNING_MESSAGE:"Sorry, we're experiencing playback issues with this multimedia file. <ul><li>Ensure that you are connected to Relativity.</li><li>Your browser may not fully support this multimedia format.</li><li>The native file may be partially corrupted.</li></ul>",MULTIMEDIA_MISSING_STREAM_TITLE_FMT:"Unable to play {STREAM_TYPE} stream",MULTIMEDIA_MISSING_STREAM_MESSAGE_FMT:"Unable to play {STREAM_TYPE} stream <ul><li>Your browser may not support the {STREAM_TYPE} codec.</li><li>The native file may not have {STREAM_TYPE_IND} stream.</li><li>The native file may be partially corrupted.</li></ul>"});
S=OIT.local;var Ma,lb,pc=598,Zb=599;(function(){var b=[],e=Date.now(),d=function(a){return gb(b,"request",a)},c=function(a){var c=d(this);if(!c)throw"request.start(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==typeof a||0>a)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==c.contentLength)throw"request.start(): start should only be called once per request";
c.contentLength=a;p(c,"")}},a=function(a){var c=d(this);if(!c)throw"request.loading(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof a)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";if(void 0!==this.contentLength&&a.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";
c.responseText=a;void 0!==c.contentLength&&p(c,a)}},f=function(a){var c=d(this);if(!c)throw"request.done(): Invalid request object";if(!c.aborted){if("number"!==typeof a||0>=a)throw"request.done(): status must be a positive integer HTTP status code";if(0===a)c.timeout=!0;else if(200===a){if(void 0===c.responseText)throw"request.done(): request.loading() was never called";if(void 0!==c.contentLength&&c.responseText.length!==c.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";
}Object.defineProperty(this,"status",{value:a});c.contentLength=c.responseText.length;Object.defineProperty(this,"responseText",{value:c.responseText});Na(b,c);q(c)}},g=function(){var a=d(this);if(!a)throw"request.abort(): Invalid request object";a.aborted=!0;q(a)},k=function(d,e){var l={};Object.defineProperties(l,{url:{value:d},start:{value:c},loading:{value:a},done:{value:f},abort:{value:g}});e.request=l;e.isLocal=!0;b.push(e);return l},t=function(a){a.inDispatch=!0;D.on.ajax.dispatch(a.request);
a.inDispatch=!1},v=function(a,c){var b=a[c];if(b){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));b.apply(a.context,d)}},q=function(a){var c="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,b=a.request.status;0===b||a.aborted?(b=pc,a.aborted=!0,D.on.ajax.hasListeners()&&D.on.ajaxabort.hasListeners()&&D.on.ajaxabort.dispatch(this)):a.timeout&&(b=Zb);a.contentLength=c.length;200===b?v(a,"success",a.url,a.contentLength,c,b):v(a,"error",a.url,a.contentLength,
c,b);v(a,"complete",a.url,a.contentLength,c,b)},p=function(a,c){v(a,"loading",a.url,a.contentLength,c,a.request.status)};Ma=function(a){var c=a.url,d;if("string"===typeof c&&0<c.length){var f={context:null},m;for(m in a)f[m]=a[m];if(D.on.ajax.hasListeners())k(c,f),da(t,0,null,f),d=f;else if(O.XMLHttpRequest){f.request=new XMLHttpRequest;!1===a.cache&&(c=-1!=c.indexOf("?")?c+"&":c+"?",++e,c+="_="+e);f.request.onreadystatechange=function(){if(!f.aborted)switch(f.request.readyState){case 2:f.contentLength=
Number(f.request.getResponseHeader("Content-Length"));p(f,"");break;case 3:p(f,"unknown"!=typeof f.request.responseText?f.request.responseText:void 0);break;case 4:q(f),Na(b,f)}};f.request.ontimeout=function(){f.timeout=!0;q(f)};u.withCredentials&&(f.request.withCredentials=!0);f.request.open("GET",c,!0);if(a=u.httpHeaders)for(var l in a)a.hasOwnProperty(l)&&f.request.setRequestHeader(l,a[l]);f.request.send();b.push(f);d=f}}return d};var m=function(a){a.aborted=!0;a.request&&a.request.abort()};lb=
function(a){a?(Na(b,a),m(a)):(ga(b,m),b=[])}})();var Q=function(b,e){return e&&1<e?Math.round(b*e)/e:Math.floor(0>b?b-.5:b+.5)},ca=function(b,e,d){b<e?b=e:b>d&&(b=d);return b},$b=function(b,e,d,c){if(b==d&&e==c)return 0;b=d-b;e=c-e;return Q(Math.sqrt(b*b+e*e))},ac=function(b,e){if("deg"===e)b%=360,0>b&&(b+=360);else{var d=Math.PI,c=2*d;b%=c;b<-d?b+=c:b>d&&(b-=c)}return b},fc=function(b,e,d){void 0===d&&(d=1.01);return(b>e?Math.abs(b/e):Math.abs(e/b))<=d},gc,tb,Ta,da,ra,eb,bc;(function(){for(var b=
[],e=[],d=[],c=O.requestAnimationFrame,a=O.cancelAnimationFrame,f=0,g=["ms","moz","webkit","o"],k=0;k<g.length&&!c;++k)c=O[g[k]+"RequestAnimationFrame"],a=O[g[k]+"CancelAnimationFrame"]||O[g[k]+"CancelRequestAnimationFrame"];c||(c=function(a){var c=(new Date).getTime(),b=Math.max(0,16-(c-f)),d=O.setTimeout(function(){a(c+b)},b);f=c+b;return d});a||(a=function(a){O.clearTimeout(a)});gc=function(){var c;for(c=0;c<b.length;c++)O.clearInterval(b[c].id);b=[];for(c=0;c<e.length;c++)O.clearTimeout(e[c].id);
e=[];for(c=0;c<d.length;c++)a.call(O,d[c].id);d=[]};var t=function(a,c,b,d){var e=0;d={fn:a[e++],remove:!!d};c&&(d.timeout=a[e++]);d.context=a[e++];b&&(d.args=[0],d.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,e),d.args=d.args?d.args.concat(a):a);return d},v=function(a,c,b){try{a.remove&&Na(c,a),a.ts&&(a.args[0]=b),a.fn.apply(a.context,a.args)}catch(l){O.OILogDebugError&&O.OILogDebugError("Error in asynchronous timer function: "+l.message)}};tb=function(a,c,d){var e=t(arguments,!0,!1,!1);b.push(e);
e.id=O.setInterval(function(){v(e,b)},e.timeout);return e.id};Ta=function(a){O.clearInterval(a);Ab(b,"id",a)};da=function(a,c,b){var d=t(arguments,!0,!1,!0);e.push(d);d.id=O.setTimeout(function(){v(d,e)},c);return d.id};ra=function(a){O.clearTimeout(a);Ab(e,"id",a)};eb=function(a,b){for(var e,f=0;f<d.length;f++)if(e=d[f],e.fn===a&&e.context===b)return e.id;e=t(arguments,!1,!0,!0);d.push(e);e.id=c.call(O,function(a){v(e,d,a)});return e.id};bc=function(c){a.call(O,c);Ab(d,"id",c)};Qa.install.listen(function(){D.onreset(function(){gc();
b=[];e=[];d=[]})})})();var Ua,jb,Jb,Va,Za,Fa,Ja,Aa,wc,Ra,Wa,ga,mb,xc,bb,yc,zc,Na,Ab,gb,hc,Ib,Bb,Ac,Bc,Nb,Cc,hb,Dc,Ec,ic,tc,uc;(function(){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,d=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,
c=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,a=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,g=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t=Math.pow(2,53),v="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");Ua=function(a){for(a=y.unwrap(a);a&&!y.isElement(a);)a=a.parentNode;var c;a&&(a=y.wrap(a),c=a.hasClass(v)?a:a.ancestorByClass(v));return c?c:null};jb=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
Jb=function(a,c,b){var d=a.indexOf(":");if(0<d){var e=Jb(a.slice(0,d),c,b);a=Jb(a.slice(d+1),c,b);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,d=0,f=!1,m=0,g=0,h=a.length,l=a.charCodeAt(g);g<h&&36==l&&(e=!0,g++,l=a.charCodeAt(g));for(!1===(g<h&&65<=l&&90>=l)&&(f=e);g<h&&65<=l&&90>=l;)d=26*d+(l-65+1),g++,l=a.charCodeAt(g);g<h&&36==l&&(f=!0,g++,l=a.charCodeAt(g));for(;g<h&&48<=l&&57>=l;)m=10*m+(l-48),g++,l=a.charCodeAt(g);0<d&&d--;0<m&&m--;!e&&c&&(d+=c);!f&&b&&(m+=b);return ta(d,m,d,m)};Va=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return b[a];var c=a%26,d=(a-c)/26-1;if(702>a)return b[d]+b[c];a=Math.floor(d);d=a%26;return b[(a-d)/26-1]+b[d]+b[c]}};Za=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Fa=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Ja=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};Aa=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};wc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Ra=function(a,c){return a&&0!==a.length?c&&0!==c.length?"/"==a.charAt(a.length-1)?"/"==c.charAt(0)?a+c.substr(1):a+c:"/"==c.charAt(0)?a+c:a+"/"+c:a:c};Wa=function(a){var c;if(Array.isArray(a)){c=[];for(var b=0;b<a.length;b++)c[b]=Wa(a[b])}else{if(Fa(a))return null;if(null===a)c=null;else switch(typeof a){case "object":c={};for(b in a)a.hasOwnProperty(b)&&!Fa(a[b])&&(c[b]=Wa(a[b]));break;case "string":c=
new String(a);break;case "number":case "boolean":case "undefined":c=a}}return c};ga=function(a,c,b){q(!1,!1,null,arguments)};mb=function(a,c){q(!1,!1,a,c)};xc=function(a,c,b){q(!1,!0,null,arguments)};bb=function(a,c,b){q(!0,!1,null,arguments)};yc=function(a,c){q(!0,!1,a,c)};var q=function(a,c,b,d){var e=0;b||(b=d[e++]);if(b&&(a||0<b.length)){var f,g=d[e++],l=d[e++],h="string"==typeof g;h||e--;d=d.length>e?Array.prototype.slice.call(d,e):void 0;h?e=m:(e=p,d||(d=[null]));if(a)for(f in b)b.hasOwnProperty(f)&&
e(b[f],g,l,d);else if(c?(f=b.length-1,c=a=-1):(f=0,a=b.length,c=1),b.item)for(;f!=a;f+=c)e(b.item(f),g,l,d);else for(;f!=a;f+=c)e(b[f],g,l,d)}},p=function(a,c,b,d){null===a||void 0===a||null!==b&&void 0!==b&&!a.filter(b)||(d[0]=a,c.apply(null,d))},m=function(a,c,b,d){a&&(null===b||void 0===b||a.filter(b))&&a[c].apply(a,d)};zc=function(a,c,b){if(a===c)return!0;if(null===a||void 0===a)return null===c||void 0===c;if(null===c||void 0===c||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(c)||a.length!=c.length)return!1;for(var d=0;d<a.length;d++)if(a[d]!==c[d])if(!0===b){if(JSON.stringify(a[d])!==JSON.stringify(c[d]))return!1}else return!1;return!0};Na=function(a,c){var b=a.indexOf(c);-1!=b&&a.splice(b,1)};Ab=function(a,c,b){c=hc(a,c,b);-1!=c&&a.splice(c,1)};gb=function(a,c,b){c=hc(a,c,b);if(-1!=c)return a[c]};hc=function(a,c,b){if(Array.isArray(a)&&"string"===typeof c)for(var d=0;d<a.length;d++){var e=a[d];if(e&&e[c]===b)return d}return-1};Ib=function(a){return Ja(a)?
"[DOM Range]":Aa(a)?"[DOM Selection]":y.isElement(a)?y.unwrap(a).outerHTML:y.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};Bb=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return k[a]}));return a};var l;a:{try{(new Date).toLocaleDateString("i")}catch(K){l="RangeError"===K.name;break a}l=!1}Ac=function(a){if(l&&(a.match(e)||a.match(d)))try{a=(new Date(a)).toLocaleDateString()}catch(F){}return a};Bc=function(a){if(l&&(a.match(e)||a.match(d)))try{a=(new Date(a)).toLocaleTimeString()}catch(F){}return a};
Nb=function(a){if(l&&(a.match(e)||a.match(d)))try{a=(new Date(a)).toLocaleString()}catch(F){}return a};Cc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};hb=function(){if(u.isMobileOrTablet){var a=z.activePage();if(a){var c=y.create("div");a.append(c);da(function(){c.destroy()},10)}}};Dc=function(a){for(var c=a.css("width"),b=1,d=t;b<d;){var e=
Math.ceil((b+d)/2);a.css("width",e+"px");a.clientWidth!=e?d=e-1:b=e}a.css("width",c);return b};Ec=function(a){for(var c=a.css("height"),b=1,d=t;b<d;){var e=Math.ceil((b+d)/2);a.css("height",e+"px");a.clientHeight!=e?d=e-1:b=e}a.css("height",c);return b};ic=function(a){var c=!1;switch(a){case "firefox":c=-1!=navigator.userAgent.toLowerCase().indexOf("firefox");break;case "ie11":c=!!O.MSInputMethodContext&&!!Y.documentMode}return c};tc=function(){var b=!1,d=navigator.userAgent||navigator.vendor||O.opera;
if(c.test(d)||a.test(d.substr(0,4)))b=!0;return b};uc=function(){var a=!1,c=navigator.userAgent||navigator.vendor||O.opera;if(f.test(c)||g.test(c.substr(0,4)))a=!0;return a}})();var $c=function(){var b=function(){U.call(this,"div","oit-skeleton");this._content=y.create("div","skeleton-overlay generic");this.append(this._content);U.prototype.hide.call(this);this.show()},e=Z(b,U);e.getZoom=function(){return void 0!==this._zoom?this._zoom:1};e.setZoom=function(b){b!=this._zoom&&(this._zoom=b,this.update())};
e.destroy=function(){this.stopShowTimer();this.stopHideTimer();this._pendingHide=!1;this._callback=void 0;U.prototype.destroy.call(this)};e.show=function(){this.stopHideTimer();this.startShowTimer();return this};e.hide=function(){this._showTimer?this.stopShowTimer():this._hideTimer?this._pendingHide=!0:this.hideAndDetach();return this};e.wait=function(b){!this.isHidden||this._showTimer||this._hideTimer?this._callback=b:b&&b()};e.startShowTimer=function(){if(this.isHidden&&void 0===this._showTimer){var b=
this;this._showTimer=O.setTimeout(function(){b._showTimer=void 0;U.prototype.show.call(b);b.startHideTimer()},250)}};e.stopShowTimer=function(){this._showTimer&&(O.clearTimeout(this._showTimer),this._showTimer=void 0)};e.startHideTimer=function(){var b=this;this._hideTimer=O.setTimeout(function(){b._hideTimer=void 0;b._pendingHide&&b.hideAndDetach()},250)};e.stopHideTimer=function(){this._hideTimer&&(O.clearTimeout(this._hideTimer),this._hideTimer=void 0)};e.hideAndDetach=function(){U.prototype.hide.call(this);
this.detach();this._callback&&this._callback();this._callback=void 0};e.update=function(){if(this.domElem&&(this.css({transform:null,"transform-origin":null}),this._content.css({width:null,height:null}),1!=this._zoom)){var b=this.clientWidth,c=this.clientHeight;this.css({transform:"scale("+this._zoom+")","transform-origin":"left top"});this._content.css({width:b+"px",height:c+"px"})}};return b}(),ad=function(){function b(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}
var d={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};return function(a,f){var g,k,t,v,q,p;p=f?e:b;if(3>a.length)return a;t=a.substr(0,1);"y"==t&&(a=t.toUpperCase()+a.substr(1));v=/^(.+?)(ss|i)es$/;k=/^(.+?)([^s])s$/;v.test(a)?
(a=a.replace(v,"$1$2"),p("1a",v,a)):k.test(a)&&(a=a.replace(k,"$1$2"),p("1a",k,a));v=/^(.+?)eed$/;k=/^(.+?)(ed|ing)$/;v.test(a)?(k=v.exec(a),v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(k[1])&&(v=/.$/,a=a.replace(v,""),p("1b",v,a))):k.test(a)&&(k=k.exec(a),g=k[1],k=/^([^aeiou][^aeiouy]*)?[aeiouy]/,k.test(g)&&(a=g,p("1b",k,a),k=/(at|bl|iz)$/,q=/([^aeiouylsz])\1$/,g=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,k.test(a)?(a+="e",p("1b",k,a)):q.test(a)?(v=/.$/,a=a.replace(v,""),p("1b",
q,a)):g.test(a)&&(a+="e",p("1b",g,a))));v=/^(.*[aeiouy].*)y$/;v.test(a)&&(k=v.exec(a),g=k[1],a=g+"i",p("1c",v,a));v=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;v.test(a)&&(k=v.exec(a),g=k[1],k=k[2],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(g)&&(a=g+d[k],p("2",v,a)));v=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;v.test(a)&&(k=v.exec(a),g=k[1],k=k[2],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
v.test(g)&&(a=g+c[k],p("3",v,a)));v=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;k=/^(.+?)(s|t)(ion)$/;v.test(a)?(k=v.exec(a),g=k[1],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(g)&&(a=g,p("4",v,a))):k.test(a)&&(k=k.exec(a),g=k[1]+k[2],k=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,k.test(g)&&(a=g,p("4",k,a)));v=/^(.+?)e$/;v.test(a)&&(k=v.exec(a),g=k[1],
v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,k=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,q=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,v.test(g)||k.test(g)&&!q.test(g))&&(a=g,p("5",v,k,q,a));v=/ll$/;k=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;v.test(a)&&k.test(a)&&(v=/.$/,a=a.replace(v,""),p("5",v,k,a));"y"==t&&(a=t.toLowerCase()+a.substr(1));return a}}(),Fc={"\u00c0":"A",
"\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\u00c7":"C","\u1e08":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u1e2e":"I","\u020a":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O",
"\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\u00e7":"c","\u1e09":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i",
"\u1e2f":"i","\u020b":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E",
"\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k",
"\u1e30":"K","\u1e31":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s",
"\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","\u0174":"W","\u0175":"w","\u1e82":"W","\u1e83":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z",
"\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A","\u01fb":"a","\u01fe":"O","\u01ff":"o","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","\u0403":"\u0413","\u0453":"\u0433",
"\u040c":"\u041a","\u045c":"\u043a","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h","\u01e8":"K","\u01e9":"k","\u1e66":"S","\u1e67":"s","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u1e28":"H","\u1e29":"h"},
bd=Object.keys(Fc).join("|"),cd=new RegExp(bd,"g"),jc=function(b){return b.replace(cd,function(b){return Fc[b]})},Gc=function(){var b=[{rule:/(\S{3})(\S*)(ies)$/,replace:"y"},{rule:/(\S{3})(\S*)(ing)$/,replace:""},{rule:/(\S{4})(\S*)(ness)$/,replace:""},{rule:/(\S{0})(\S*)(ss)$/,replace:"ss"},{rule:/(\S{3})(\S*)(s)$/,replace:""},{rule:/(\S{4})(\S*)(ion)$/,replace:""},{rule:/(\S{4})(\S*)(ism)$/,replace:""},{rule:/(\S{4})(\S*)(ly)$/,replace:""},{rule:/(\S{3})(\S*)(eed)$/,replace:"ee"},{rule:/(\S{4})(\S*)(ied)$/,
replace:"y"},{rule:/(\S{4})(\S*)(ed)$/,replace:""},{rule:/(\S{3})(\S*)(ed)$/,replace:"e"},{rule:/(\S{4})(\S*)(er)$/,replace:""},{rule:/(\S{4})(\S*)(ful)$/,replace:""},{rule:/(\S{4})(\S*)(able)$/,replace:""},{rule:/(\S{4})(\S*)(ible)$/,replace:""},{rule:/(\S{3})(\S*)(v)$/,replace:"f"},{rule:/(\S{4})(\S*)(e)$/,replace:""},{rule:/(\S{3})(\S*)(dd)$/,replace:"d"},{rule:/(\S{3})(\S*)(gg)$/,replace:"g"},{rule:/(\S{3})(\S*)(ll)$/,replace:"l"},{rule:/(\S{3})(\S*)(mm)$/,replace:"m"},{rule:/(\S{3})(\S*)(nn)$/,
replace:"n"},{rule:/(\S{3})(\S*)(pp)$/,replace:"p"},{rule:/(\S{3})(\S*)(rr)$/,replace:"r"},{rule:/(\S{3})(\S*)(ss)$/,replace:"s"},{rule:/(\S{3})(\S*)(tt)$/,replace:"t"}];return function(e,d){for(var c=0,a=e;c<b.length;){var f=b[c].rule.exec(a);if(f)if(rStem=f[1]+f[2]+b[c].replace,rStem===a)break;else c=0,a=rStem;else c++}return a}}(),Hc=za.extend("fonts",{events:{fontload:{}},install:function(b){var e=["serif","sans-serif","monospace","cursive","fantasy"],d={},c=0,a;b.loadWebFont=function(b){var e=
d[b];if(void 0===e){var g=u.rootNode;if(g){e=y.create("div","oit-fontpreloader");e.css("font-family",b);var v=y.create("span");e.append(v);v.html("AEIMNOTaeimnot130");g.append(e);d[b]=e}c=0;a||(a=da(f,250))}};var f=function(){var g=!1,k=!1,t,v;a=void 0;for(t in d)if((v=d[t])&&!0!==v){for(var q=!0,p,m=0;m<e.length;m++){v.css("font-family",t+","+e[m]);var l=v.offsetWidth;if(0<m&&l!=p){q=!1;break}p=l}q?(v.destroy(),k=d[t]=!0):(v.css("font-family",t),g=!0)}if(g)if(c++,20>c)a=da(f,250);else for(t in d)(v=
d[t])&&!0!==v&&(v.destroy(),d[t]=!1);k?b.on.fontload.dispatch():0===c%2&&b.on.fontload.dispatch()};D.onreset(function(){for(var b in d){var e=d[b];e&&!0!==e&&e.destroy()}d=[];c=0;a=void 0})}}),la=za.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),events:{resize:{delay:80},detach:{},update:{}},install:function(b){var e,d=0,c,a,f,g,k={},t=0,v=0,q,p,m,l,K,F,N;b.hasFeature=function(a){var c=!1;switch(a){case "string":case "dtsearch":case "lucene":case "phsterms":case "literal":case "literal*":case "enhancedhighlight":c=
!0}return c};b.dispatchResize=function(){var d=u.viewNode;d&&(f&&H(),c!=d.clientWidth||a!=d.clientHeight)&&(c=d.clientWidth,a=d.clientHeight,b.on.resize.dispatch())};var H=function(){if(f){var a=f.computedStyle(),c=f.offsetWidth-parseInt(a.borderLeftWidth,10)-parseInt(a.borderRightWidth,10),a=f.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);u.rootNode.css({width:c+"px",height:a+"px"})}};b.dispatchScroll=function(a){var c=u.viewNode;if(c&&(b.invalidateCanvas(),D.on.scrollupdate.dispatch(),
c=c.scroll(),a||c.left!=v||c.top!=t)){a=c.left-v;var d=c.top-t;v=c.left;t=c.top;D.on.scroll.dispatch(a,c.left,d,c.top)}};var R=function(){},C=function(){},M=function(){w.nochrome?u.viewNode.addClass("oit-nochrome"):u.viewNode.removeClass("oit-nochrome")},G=function(){var a=u.rootNode;a&&(a.addClass("oit-view-root"),a=u.viewNode,a||(a=y.attach(y.create("div","oit-view")),u.viewNode=a),e="oitview"+d++,a.id=e,M(),a.attr("tabindex","-1"),a.onscroll(b.dispatchScroll),b.fitToContainer(),oa.showLoadingSkeleton());
O.matchMedia&&(a=O.matchMedia("print"))&&a.addListener(function(a){});O.addEventListener("beforeprint",R);O.addEventListener("afterprint",C);O.addEventListener("resize",b.dispatchResize)};Qa.init.listen(function(){var a=u.rootNode;if(a){var c=a.data("json"),b=a.data("icd"),d=a.data("page");if(c||b)g=a.parent();G();fa.initializeContent(c,b,d);D.initializeDocument()}});b.attach=function(a){a&&a!==y.unwrap(f)&&(b.detach(),f=y.wrap(a),a=u.rootNode,a||(a=u.rootNode=y.attach(y.create("div"))),a.addClass("oit-view-embedded"),
f.append(a),G())};b.detach=function(){D.unload();u.viewNode&&(u.viewNode.offscroll(b.dispatchScroll),u.viewNode.removeData("_events"),y.detach(u.viewNode));u.rootNode&&y.detach(u.rootNode);y.reset();b.on.detach.dispatch();var a=u.viewNode;if(a)try{a.destroy()}catch(ea){}if(a=u.rootNode)try{a.destroy()}catch(ea){}O.removeEventListener("beforeprint",R);O.removeEventListener("afterprint",C);O.removeEventListener("resize",b.dispatchResize);u.rootNode=u.viewNode=null;e=f=g=void 0};b.stage=function(a){u.staging=
!0;b.load(a)};var h=function(a){b.logAJAXError("load","Timed out waiting for document to load",a)};b.load=function(a,c){f||g?void 0===a?u.staging&&(u.staging=!1,D.showNotifications()):(b.unload(),u.dynamicContent=!0,u.documentLoading=!0,c&&(c.headers&&(u.httpHeaders=c.headers),c.withCredentials&&(u.withCredentials=!0)),p&&ra(p),p=da(h,3E4,null,a),Ma({url:a,loading:B,success:V,error:I}),oa.showLoadingSkeleton()):b.logError("load","Call OIT.view.attach before OIT.view.load")};var B=function(a,c,b){p&&
ra(p);p=da(h,3E4,null,a)},V=function(a,c,d,e){c=!0;p&&(ra(p),p=void 0);try{0===d.length?(b.logAJAXError("load","The document is empty or is still being exported",a,e,d),c=!1):c=D.installDocument(a,d)}catch(X){b.logAJAXError("load","The document could not be installed ("+X.message+")",a,e,d),c=!1}c||oa.showLoadingSkeleton()},I=function(a,c,d,e){p&&(ra(p),p=void 0);b.logAJAXError("load","Failed to load the document index file from the server",a,e,d);oa.showLoadingSkeleton()};b.unload=function(){D.unload();
u.httpHeaders=null;u.withCredentials=!1;y.reset()};b.fitToContainer=function(){f&&(H(),b.dispatchResize())};b.width=function(a){a=zb(a);null!==a&&(f&&f.css("width",a),u.rootNode.css("width",a),b.dispatchResize());return u.rootNode.offsetWidth};b.height=function(a){a=zb(a);null!==a&&(f&&f.css("height",a),u.rootNode.css("height",a),b.dispatchResize());return u.rootNode.offsetHeight};b.info=function(){var a=Wa(k);a.libversion=u.libversion?Wa(u.libversion):"Unknown";var c=fa.manifest();c&&(a.manifest=
Wa(c));return a};b.infoRaw=function(){return k};b.showDocumentError=function(a){q||(q=new Ob({title:S.DOCUMENT_ERRORS,closeButton:!0,className:"oit-toast-error"}));q.message(a);q.expand(!1)};var r=function(){var a=u.rootNode,c=a.clientWidth,d=a.clientHeight,e;m=void 0;F&&(l!=c||K!=d?(F.destroy(),F=null):(e=F.getContext("2d"),e.clearRect(0,0,c,d)));F||(N||(N=y.create("div","oit-viewcanvas"),a.insertFirst(N)),l=c,K=d,F=N.createCanvas());e||(e=F.getContext("2d"));b.on.update.dispatch(e)};b.invalidateCanvas=
function(){!m&&b.on.update.hasListeners()&&(m=eb(r,this))};u.onviewNode(function(a,c){c&&c.destroy();if(a){for(var b=u.rootNode,d=b.childByClass("oit-toolframe");d;){d=d.childByClass("oit-toolcontent");if(!d)break;b=d;d=b.childByClass("oit-toolframe")}b&&b.append(a)}});D.onreset(function(){oa.showLoadingSkeleton();q&&(q.destroy(),q=null);F&&(F.destroy(),F=null);N&&(N.destroy(),N=null);m&&(bc(m),m=void 0);K=l=-1;a=c=void 0;k={};v=t=0});fa.ondata(function(a,c,b){if(a.info){k||(k={});for(var d in a.info)k[d]=
a.info[d];k.fi||(k.fi=1999);k.fistring||(k.fistring="Unknown");k.product||(k.product="Outside In Technology");k.version||(k.version="Unknown")}});w.onnochrome(M)}}),oa=za.extend("dialog",{install:function(b){var e=[],d=null,c=!1,a,f=!1,g;b.createProgressDialog=function(a,c){var b={dialog:null,text:null,ticks:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:c,display:t,update:v,hide:p};e.push(b);O.performance&&O.performance.now?(b.startTime=performance.now(),b.interval=tb(k,200,b)):b.display();
return b};var k=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,a=1E3<=a):a=500<=a;a&&(Ta(this.interval),this.display())},t=function(){var a=e.indexOf(this);if(!this.active&&0===a&&!this.dialog)if(this.active=!0,D.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;b.showModalOverlay(!0,200);if(a=u.rootNode){this.dialog=y.create("div","oit-dialog oit-progress-dialog");this.text=y.create("div","oit-dialog-text");this.ticks=y.create("div",
"oit-progress-dialog-ticks");for(var c=this.showTicks?20:4,d=0;d<c;d++)this.ticks.append(y.create("div"));this.dialog.append(this.text,this.ticks);a.append(this.dialog)}this.ticks.css("display","block");this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=!0},v=function(a){var c=this;c.showTicks?"number"===typeof a&&
(0>a?a=0:100<a&&(a=100),c.percentDone=a,c.active&&(D.on.progress.dispatch(a),c.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=c.tickCount&&(c.tickCount=a,c.ticks.forChildElements(q,a))))):(c.percentDone+=1,4<=c.percentDone&&(c.percentDone=0),c.active&&c.dialog&&c.ticks.forChildElements(function(a,b){b==c.percentDone?a.addClass("filled"):a.removeClass("filled")}))},q=function(a,c,b){c<b?a.addClass("filled"):a.removeClass("filled")},p=function(){var a=this;a.interval&&(Ta(a.interval),a.interval=void 0);
a.active&&D.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},endFn:function(){a.dialog.destroy();a.dialog=null},time:200}),b.showModalOverlay(!1,200));Na(e,a)};b.showModalOverlay=function(c,b){b=b||200;var d=f;if(c){if(!a){var e=u.rootNode;e&&(a=y.create("div","oit-screen"),e.append(a))}a&&!f&&(f=!0,a.abortAnimation(),a.animate({opacity:.5,time:b,startCSS:{opacity:0,display:"block"}}))}else f&&(f=!1,a.abortAnimation(),a.animate({opacity:0,
time:b,endCSS:{display:null}}));f!=d&&(d=z.activeOverlay())&&d.updateCSS()};b.modalOverlayVisible=function(){return f};b.showMessage=function(a){c&&b.hideMessage();if(D.on.showmessage.dispatch(a,!1,!1)){if(!d){var e=u.rootNode;e&&(d=y.create("div","oit-background-message"),e.append(d))}d&&(c||(d.abortAnimation(),d.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),d.html(a))}c=!0};b.hideMessage=function(){c&&(D.on.hidemessage.dispatch(),d&&(d.abortAnimation(),d.animate({opacity:0,
time:200,endCSS:{display:null}})),c=!1)};b.messageVisible=function(){return c};b.isLoadingSkeletonShown=function(){g&&!g.parent()&&(g.destroy(),g=void 0);return!!g};b.showLoadingSkeleton=function(){w.disableLoadingSkeleton||(g&&!g.parent()&&(g.destroy(),g=void 0),!g&&u.viewNode&&(g=new $c,u.viewNode.append(g)))};b.hideLoadingSkeleton=function(a){!w.disableLoadingSkeleton&&g?(g.hide(),g.wait(function(){g.destroy();g=null;a&&a()})):a&&a()};D.onreset(function(){for(;0<e.length;)e[e.length-1].hide();
d&&d.destroy();a&&a.destroy();d=null;c=!1;a=null;f=!1})}}),Ic=function(){function b(a){if(-1===a.indexOf("*"))return!1;for(var c=0;c<a.length;c++)if("*"!==a.charAt(c))return!1;return!0}function e(a,c,b){this.value=a;this.type=c;this.subtype=b}function d(){this.items=[];this.add=function(a,c,b){b||(b="");a=new e(a,c,b);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=
this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function c(a,c){this.regEx=c;this.type=a}function a(c,b){for(var e=new d,x=c.slice(0);x;){for(var f=0;f<b.length;f++){var r=x.match(b[f].regEx);if(r){var g=b[f].type;if("LUCENE_WITHIN"===g){var h,
g=e,l=/\"(.*)\"~(\d+)/.exec(r[0]);if(l){var m=a(l[1],q);if(m&&m.items&&m.items.length){var L=0,k=0;for(h=0;h<m.items.length;h++){var F=m.items[h];"OPEN_PAREN"===F.type?k++:"CLOSE_PAREN"===F.type&&k--;if(0===k){L=h+1;break}}for(h=0;h<L;h++)g.addRef(m.items[h]);h=Number(l[2]);isNaN(h)||h++;g.add("WI"+h,"WITHIN",0);for(h=L;h<m.items.length;h++)g.addRef(m.items[h])}}}else"CONNECTOR_TILDE"===g?e.add(r[0].substring(0,r[0].length-1),"WORD",0):e.add(r[0],g,0);x=x.slice(r[0].length);break}}f==b.length&&(x=
x.slice(1))}return e}function f(a,c,b){a.push("(");!1===b&&a.push("?:");a.push(c);a.push(")")}function g(a,c,b,d,e){a.push("(");!1===d&&a.push("?:");k(a,c,b,e);a.push(")")}function k(a,c,b,d){var e;e=c.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");w.normalizeAccentsForSearch&&(e=jc(e));e=e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");e=e.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");e=e.replace(/\s+/g,"\\s+");if(b)b=
e.replace(/\?/g,"[\\u003F]"),b=b.replace(/\*/g,"[\\u002A]");else if(b=e.replace(/\?/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),b=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),"dtsearch"===d.searchType)if(b=b.replace(/=/g,"[=\\d]"),d.stemAll||"~"===b.substring(b.length-1))c=0,"~"===b.substring(b.length-
1)&&(c=1),b=b.substring(0,b.length-c).toLowerCase(),b=d.stemmerFunction(b),d.stems.push(b),b+="\ue000*";else{if(d.fuzzies&&0<=b.indexOf("%")&&(c=b.indexOf("%"),0<=c)){var n=b.lastIndexOf("%")-c+1;b=b.replace(/%/g,"");b=b.toLowerCase();d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:n});0<c&&c--;b=b.slice(0,c)+"\ue001+";e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]")}}else if(d.fuzzies&&"lucene"===d.searchType&&0<=b.indexOf("~")){c=0;n=1;e=b.lastIndexOf("~");
if(e+1<b.length){var x=Number(b.slice(e+1,b.length));isNaN(x)||(n=x)}b=b.slice(0,e);b=b.toLowerCase();d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:n});b=b.slice(0,c)+"\ue001+"}a.push(b)}var t="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",v=[new c("NUMERICAL_PATTERN",/^(=[=\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]*)/),new c("CONNECTOR_TILDE",/^(\bNOT~(?=\s|$)|\bnot~(?=\s|\)|$))/),new c("CONNECTOR_TILDE",/^(\bAND~(?=\s|$)|\band~(?=\s|\)|$))/),new c("CONNECTOR_TILDE",/^(\bOR~(?=\s|$)|\bor~(?=\s|\)|$))/),
new c("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new c("AND_NOT",/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),new c("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new c("AND",/^(\bAND\b|\band\b)/),new c("OR",/^(\bOR\b|\bor\b)/),new c("NOT",/^(\bNOT\b|\bnot\b)/),new c("AndAny",/^(\bAndAny\b|\bandany\b)/),new c("XFIRSTWORD",/^(\bxfirstword\b)/),new c("XLASTWORD",/^(\bxlastword\b)/),new c("DATE",/^\b[dD][aA][tT][eE]\(\s*\**\s*\)/),new c("DATE_WITH_PARAM",/^\b[dD][aA][tT][eE]\([^\)]*\)/),
new c("MAIL",/^\b[mM][aA][iI][lL]\(\s*\**\s*\)/),new c("MAIL_WITH_PARAM",/^\b[mM][aA][iI][lL]\([^\)]*\)/),new c("CREDITCARD",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\(\s*\**\s*\)/),new c("CREDITCARD_WITH_PARAM",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\([^\)]*\)/),new c("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new c("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new c("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new c("OPEN_PAREN",/^\(/),new c("CLOSE_PAREN",/^\)/),new c("DTSEARCH_REGULAREXPRESSION",
/^\"##[^\"]*\"/),new c("WHITESPACE",/^\s+/),new c("PHRASE",/^"[^"]*"/),new c("WORD",/^[^\s)]+/)],q=[new c("AND",/^(\bAND\b|\s*\u0026\u0026\s*|\s*\u002B\s*)/),new c("OR",/^(\bOR\b|\s*\u007C\u007C\s*)/),new c("NOT",/^(\bNOT\b|\s*\u0021\s*|\s*\u002D\s*)/),new c("LUCENE_WITHIN",/^\"[^\"]*\"~\d+/),new c("OPEN_PAREN",/^\(/),new c("CLOSE_PAREN",/^\)/),new c("LUCENE_REGULAREXPRESSION",/^\/[^\/]*\//),new c("WHITESPACE",/^\s+/),new c("PHRASE",/^"[^"]*"/),new c("WORD",/^[^\s)]+/)],p="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",
t="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",p="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",m=function(a,c,b){var d,e=null,n=b+c[0].length,f=c.length;for(d=1;d<c.length;d++)void 0===c[d]&&f--;if(0<f){e={range:{type:"text",acc:b,accend:n},terms:[],lastTermACC:-1};for(n=1;n<c.length;n++)if(c[n]){var r=c[n];d=a.modifier;
"\ue010"===r?f="\ue010+":(f=!!r.match(t),r=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),f=f?["(",r,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))(",r,")",p].join(""));d=new RegExp(f,d);for(f=null;r=d.exec(c[0]);){f||(f=r);if(0===r.index)break;if(r.index+r[0].length>=c[0].length){f=r;break}}if(f){r=f[0];d=f.index;if(f[1]){var h=
f[0].indexOf(f[1]);-1!=h&&(r=f[1],d+=h)}var h=b+d,g=h+r.length,m=!1;for(d=0;d<e.terms.length;d++){var l=e.terms[d];if(l.range.acc<g&&h<l.range.accend){h<l.range.acc&&(l.range.acc=h);g>l.range.accend&&(l.range.accend=g);m=!0;break}}m||(d=sa(h,g),e.terms.push({term:r,range:d}),d=f.index+f[0].length-1,void 0!==a.nextOffset&&(0===a.nextOffset||a.nextOffset>d)&&(a.nextOffset=d))}}if(0===e.terms.length)e=null;else{a=e.terms[0].range;c=e.terms[0].range;e.range=ha(e.terms[0].range);for(d=1;d<e.terms.length;d++)b=
e.terms[d].range,b.acc<e.range.acc&&(e.range.acc=b.acc),b.accend>e.range.accend&&(e.range.accend=b.accend),b.acc<a.acc&&(a=b),b.accend>c.accend&&(c=b);e.lastTermACC=c.acc}}return e},l=function(a,c,b){var d;O.performance&&"function"===typeof performance.now&&(d=performance.now());c=c.exec(b);void 0!==d&&(a.searchTime+=performance.now()-d);return c},K=function(a,c){var b=c.minMatch,d=c.searchTerm,e=c.maxDistance;if(a.length<b||d.length<b)return null;for(var f=0;f<b;f++)if(d.charAt(f)!==a.charAt(f))return null;
for(var r=0,h=f,g,l,m,L,k=0;d.length-k>f&&a.length-k>f&&d.charAt(d.length-1-k)===a.charAt(a.length-1-k);)k++;for(var F=a.slice(0,a.length-k),p=d.slice(0,d.length-k);f<p.length;)if(g=p.charAt(f),d=h<F.length?F.charAt(h):0,f++,h++,g!==d){r++;if(r>e)return null;l=f<p.length?p.charAt(f):0;m=h<F.length?F.charAt(h):0;g===m?(g=f+1<p.length?p.charAt(f+1):0,L=h+1<F.length?F.charAt(h+1):0,l===d&&g===L?(f++,h++):l===d&&g===m?f++:l===L?h++:l===m?(f++,h++):l===d?(f++,h++):(f>=p.length||k)&&h++):l===d?(g=f+1<p.length?
p.charAt(f+1):0,h+1<F.length&&F.charAt(h+1),g===m?f++:l===m?(f++,h++):f++):l===m&&(f++,h++)}F.length>h&&(r+=F.length-h);if(r>e)return null;0<b&&b--;e=a.slice(0,b);for(h=b;h<a.length;h++)e+="\ue001";return e},F=new RegExp("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))((?:([1-2][0-9]{3})(?:[[/\\-,\\u0020\\u002e]+))?(?:(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?)(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020\\u002e]+)((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))|((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020\\u002e]+)(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?))(?:(?:[ \\t\\-,/.]+)(?:((?:[0-9]{2})?[0-9]{2})|((?:(?:(?:(?:(?:twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety)[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:ty)?(?:teen)?(?:th)?|seven(?:ty)?(?:teen)?(?:th)?|eight(?:y)?(?:een)?(?:h)?|ninth|nine(?:ty)?(?:teen)?(?:th)?))|(?:forty|fifty|sixty|seventy|eighty|ninety|thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[\\-\\u0020]?(?:hundred|thousand)?(?:and| )*)){1,3})))?)"+
("(?="+p+"|[^0-9])"),"ig"),N=/(\w+)/ig,H=function(a){var c=parseInt(a,10);2==a.length&&(c=50>a?c+2E3:c+1900);return c},R="jan feb mar apr may jun jul aug sep oct nov dec".split(" "),C=function(a){if("0"<=a.charAt(0)&&"9">=a.charAt(0))return parseInt(a);if(2<a.length)return a=a.slice(0,3),a=a.toLowerCase(),R.indexOf(a)+1},M="thousandth hundredth twentieth thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth".split(" "),u="thousand hundred twenty thirty forty fifty sixty seventy eighty ninety".split(" "),
h="zero one two three four five six seven eight nine".split(" "),B="ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),V="zeroth first second third fourth fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth".split(" "),I=["st","th","rd","nd"],r=function(a,c){for(var b=0;b<c.length;b++)if(0===a.indexOf(c[b]))return b;return-1},A=function(a){result=0;var c,b=0;for(a=a.toLowerCase();a;)if("0"<=
a.charAt(0)&&"9">=a.charAt(0)){for(c=1;c<a.length&&!("0">a.charAt(0)||"9"<a.charAt(0));c++);result=parseInt(a.slice(0,c));a=a.slice(c)}else c=r(a,M),0<=c?a=a.slice(M[c].length):(c=r(a,u),0<=c&&(a=a.slice(u[c].length))),0<=c?0==c?(0<b?result-=b:b=1,result+=1E3*b,b=0):1==c?(0<b?result-=b:b=1,result+=100*b,b=0):(result===b&&0<b&&100>b&&(result*=100),b=10*c,result+=b):(c=r(a,V),0<=c?(b=c,result+=c,a=a.slice(V[c].length)):(c=r(a,B),0<=c?(result===b&&0<b&&100>b&&(result*=100),b=c+10,result+=b,a=a.slice(B[c].length)):
(c=r(a,h),0<=c?(b=c,result+=c,a=a.slice(h[c].length)):(c=r(a,I),a=0<=c?a.slice(I[c].length):a.slice(1)))));return result},ea=function(a,c,b,d,e,f,r,h){a=0;c?a=1E4*H(c):r?a=1E4*H(r):h&&(a=1E4*A(h));b&&d?(a+=100*C(b),a+=A(d)):f&&e?(a+=100*C(f),a+=A(e)):a=0;if(1E7>a||2901E4<=a)a=null;return a},na=function(a,c){function b(a,b,d,e){b=b.toLowerCase();if(c.stems)for(e=0;e<c.stems.length;e++)if(b.charAt(0)==c.stems[e].charAt(0)&&(d=c.stemmerFunction(b),d===c.stems[e])){for(a=d.length;a<b.length;a++)d+="\ue000";
return d}if(c.fuzzies)for(e=0;e<c.fuzzies.length;e++)if(d=K(b,c.fuzzies[e]))return d;return a}function d(a,b,d,e,n,f,x,r,h,g,l){if(c.dates){var m=!0;if(!d&&!h&&!r)m=!1;else if(g+a.length+1<l.length&&"."==l.charAt(g+a.length)&&"0"<=l.charAt(g+a.length+1)&&"9">=l.charAt(g+a.length+1)&&!h)m=!1;else if(e&&2>=e.length||x&&2>=x.length){for(var W=0,k=0,p=0;p<b.length&&m;p++)l=b.charAt(p),"0"<=l&&"9">=l||" "==l||"\t"==l||(0!=W&&W!=l?1==k&&(m=!1):(W=l,k++));if(2>k||"."==W)m=!1;3==k&&d&&r&&(m=!1)}if(m)for(l=
ea(b,d,e,n,f,x,r,h),i=0;i<c.dates.length;i++){if(l>=c.dates[i].startDate&&l<=c.dates[i].endDate){e="";for(n=0;n<a.length-b.length;n++)e+=a.charAt(n);b=a.length;if(l=a.match(/(\sand)+\s*$/))b=l.index;if(d&&r){for(b-=r.length;0<b;)if(l=a.charAt(b-1)," "==l||"\t"==l||","==l||"-"==l||"/"==l)b--;else break;F.lastIndex=g+b}for(;n<b;n++)e+="\ue010";for(;n<F.lastIndex-g;n++)e+=a.charAt(n);return e}}else F.lastIndex=g+a.length-b.length+1,a=a.substring(0,a.length-b.length+1)}return a}var e="";if(a){if(c.fuzzies&&
0<c.fuzzies.length||c.stems&&0<c.stems.length)e=a.replace(N,b);if(c.dates&&0<c.dates.length){for(F.lastIndex=0;e.length<a.length;){var f=F.exec(a);if(f){var r=d(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f.index,f.input);r&&(e=e.concat(a.substring(e.length,f.index),r))}else e=e.concat(a.substring(e.length,a.length))}F.lastIndex=0}}return e};return{findStart:function(c,d,e,x,r,h,l){e=!1===e?"ig":"g";x={type:c,reverse:"up"===x,hits:[],hitIndex:0,lastHit:null,modifier:e,stemAll:!!h,stemmer:l,searchTime:0,
prepTime:0};"number"==typeof r&&(x.startACC=r);if("string"==typeof d)if("dtsearch"===c||"lucene"===c){if(b(d))e=null;else{var n="\\S*(?:\\s+\\S+)",m=!1;r=!1;d.match(t)&&(n="(?:\\s*\\S)",m=!0);d="lucene"===c?a(d,q):a(d,v);var W=null;d&&(W=d.items);var E=[];d={searchType:c,stems:[],fuzzies:[],dates:[],stemAll:x.stemAll,stemmerFunction:x.stemmer};x.stemmer&&("dtsearch"===x.stemmer?d.stemmerFunction=Gc:"porter"===x.stemmer&&(d.stemmerFunction=ad));d.stemmerFunction||"dtsearch"!==c||(d.stemmerFunction=
Gc);var L=[],V=0;l=h=!1;for(var B=!0,K=!1,A,I,H,N=0;N<W.length;N++)if(A=W[N],0<V)"OPEN_PAREN"===A.type?V++:"CLOSE_PAREN"===A.type?(V--,1===V&&V--):1===V&&"WHITESPACE"!==A.type&&V--;else{H=!1;if("WORD"===A.type){K=A.value.match(t);E.push("(");E.push("?:");K||E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))");E.push("(");!1===
B&&E.push("?:");k(E,A.value,!1,d);for(N++;N<W.length;N++)if("WHITESPACE"===W[N].type&&N+1<W.length&&"WORD"===W[N+1].type)"lucene"===c?E.push("|"):E.push("\\s+");else if("WORD"===W[N].type)k(E,W[N].value,!1,d);else{N--;break}E.push(")");K||E.push(p);E.push(")");H=!0}else if("PHRASE"===A.type)K=A.value.match(t),E.push("("),E.push("?:"),K||E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"),
g(E,A.value.substring(1,A.value.length-1),!0,B,d),K||E.push(p),E.push(")"),H=!0;else if("WHITESPACE"!==A.type)if("WITHIN"===A.type){if(N+1<W.length)if("WI"===A.value.substring(0,2)||"wi"===A.value.substring(0,2))A=Number(A.value.slice(2,A.value.length)),isNaN(A)||(L.push(E.length),0<A&&A--,A=n+"{0,"+A+"}",m&&(A+="\\s*"),E.push(A));else if("WORD"===W[N+1].type)if(A=Number(W[N+1].value),!isNaN(A))N++,L.push(E.length),0<A&&A--,A=n+"{0,"+A+"}",m&&(A+="\\s*"),E.push(A);else if("S"===W[N+1].value||"s"===
W[N+1].value)N++,L.push(E.length),E.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");else if("P"===W[N+1].value||"p"===W[N+1].value)N++,L.push(E.length),E.push("(?:[^\\u000a\\u000d]*)")}else if("NOT_WITHIN"===A.type)N+1<W.length&&"WORD"===W[N+1].type&&(A=Number(W[N+1].value),isNaN(A)||(N++,L.push(E.length),B=!1,0<A&&A--,A="(?!("+n+"{0,"+A+"})",m&&(A+="\\s*"),E.push(A)));else if("PRE"===A.type)N+1<W.length&&"WORD"===W[N+1].type&&(A=Number(W[N+1].value),isNaN(A)||(N++,0<A&&A--,A=n+"{0,"+A+
"}",m&&(A+="\\s*"),E.push(A)));else if("MAIL"===A.type)f(E,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',B),H=!0;else if("MAIL_WITH_PARAM"===A.type)A=A.value.substring(5,A.value.length-1),A=A.replace(/\s+$/,""),1<A.length&&(g(E,A,!1,B,d),H=!0);else if("CREDITCARD"===A.type)f(E,"(?:\\d[ -]*?){13,16}",B),H=!0;else if("CREDITCARD_WITH_PARAM"===A.type)A=A.value.substring(11,A.value.length-
1),A=A.replace(/\s+$/,""),1<A.length&&(g(E,A,!1,B,d),H=!0);else if("VISA_CREDIT_CARD_REGEX"===A.type)f(E,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",B),H=!0;else if("DATE"===A.type)d.dates.push({startDate:1E7,endDate:2901E4}),E.push("(\ue010+)"),H=!0;else if("DATE_WITH_PARAM"===A.type){var X=A.value.substring(5,A.value.length-1);if(H=F.exec(X))A=H=ea(H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8]),(X=F.exec(X))&&(A=ea(X[1],X[2],X[3],X[4],X[5],X[6],X[7],X[8])),H&&A&&(H>A&&
(X=H,H=A,A=X),d.dates.push({startDate:H,endDate:A})),E.push("(\ue010+)");F.lastIndex=0;H=!0}else if("AND"===A.type)E.push("|");else if("OR"===A.type)E.push("|");else if("NOT"===A.type)V=1;else if("AND_NOT"===A.type)V=1;else if("OR_NOT"===A.type)V=1;else if("AndAny"===A.type)E.push("|");else if("XFIRSTWORD"===A.type)E.push("("),E.push("?:"),E.push("^\\s*"),E.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),
E.push(")"),h=H=!0;else if("XLASTWORD"===A.type)E.push("("),E.push("?:"),E.push("\\s*"),E.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),E.push("\\s*$"),E.push(")"),l=H=!0;else if("DTSEARCH_REGULAREXPRESSION"===A.type){K||(E.push("("),E.push("?:"),E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"));
E.push("(");!1===B&&E.push("?:");E.push(A.value.substring(3,A.value.length-1));for(N++;N<W.length;N++)if("DTSEARCH_REGULAREXPRESSION"===W[N].type)E.push(p),E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"),E.push(W[N].value.substring(3,W[N].value.length-1));else if("WHITESPACE"!==W[N].type){N--;break}E.push(")");K||(E.push(p),
E.push(")"));H=!0}else"LUCENE_REGULAREXPRESSION"===A.type?(K||(E.push("("),E.push("?:"),E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))")),E.push("("),E.push(A.value.substring(1,A.value.length-1)),E.push(")"),K||(E.push(p),E.push(")")),H=!0):"OPEN_PAREN"===A.type?(E.push("("),E.push("?:")):"CLOSE_PAREN"===A.type?(E.push(")"),
H=!0):"NUMERICAL_PATTERN"===A.type&&(E.push("("),E.push("?:"),E.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]))"),E.push("("),!1===B&&E.push("?:"),H=E,A=A.value.replace(/([\^\(\)\[\]])/g,"\\$1"),A=A.replace(/\s+$/,""),A=A.replace(/[\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]+/g,"[\\u0020!@,:;<>\\$\\+\\-\\.\\\\\\/\\^\\{\\|\\}\\(\\)\\*\\?#~\\u2012\\u2013\\u2014\\uFE58\\uFF0D]+"),
A=A.replace(/=/g,"[=\\d]"),H.push("[\\(]?"+A),E.push(")"),E.push(p),E.push(")"),H=!0);if(0<L.length&&H){X=L[L.length-1];I=0;A=X-1;for(var ba=X+1;ba<E.length;ba++)"("===E[ba]?I++:")"===E[ba]&&I--;if(0===I&&")"==E[A])for(;0<=A&&(")"===E[A]?I++:"("===E[A]&&I--,0!==I);A--);H=E[X];if(0===I&&"(?!("===H.substring(0,4))E.push(")");else if(0===I){r=!0;E.push(")");E.push("|");E.push("(");E.push("?:");for(var C=[],B=X+1;B<ba;B++)if(E.push(E[B]),"^\\s*"===E[B])for(C.push("^\\s*"),I=A;I<X;I++)C.push(E[I]);else if("\\s*$"===
E[B]){for(I=A;I<X;I++)C.push(E[I]);C.push("\\s*$")}E.push(E[X]);for(B=A;B<X;B++)if(E.push(E[B]),"^\\s*"===E[B])for(C.push("^\\s*"),I=X+1;I<ba;I++)C.push(E[I]);else if("\\s*$"===E[B]){for(I=X+1;I<ba;I++)C.push(E[I]);C.push("\\s*$")}E.push(")");if(C.length)for(E.push("|"),I=0;I<C.length;I++)E.push(C[I]);E.push(")");E.push(" ");E.push(" ");E.push(" ");E.push(" ");for(B=E.length;B>A+4;B--)E[B-1]=E[B-5];E[A]="(";E[A+1]="?:";E[A+2]="(";E[A+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===
H||"(?:[^\\u000a\\u000d]*)"===H)for(B=A;B<E.length;B++)if(E[B]===H)for(B++;B<E.length;B++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"===E[B]){E[B]="(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===H?"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002D\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))":
"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))";break}L.pop();B=!0}}}E=E.join("");1==W.length&&(h?E="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":l&&(E="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));
c=null;if(0!==E.length)try{c=new RegExp(E,e)}catch(Cb){}n=e=c;h?n=c=null:l&&(e=c=null);0===d.stems.length&&0===d.fuzzies.length&&0===d.dates.length&&(d=null);e={regex:c,first:e,last:n,searchParameters:d,checkForMultipleMatches:r}}x.regex=e}else{r=null;w.normalizeAccentsForSearch&&(d=jc(d));if(!1===b(d)||"literal"===c)d=d.replace(/([\^\$\+\?\.\|\(\)\{\}\[\]\\])/g,"\\$1"),d=d.replace(/^\s+/,""),d=d.replace(/\s+$/,""),d=d.replace(/['\u0060\u00B4\u2018\u2019]/g,"['\\u0060\\u00B4\\u2018\\u2019]"),d=d.replace(/[\"\u201C\u201D\u030B\u030F]/g,
'[\\"\\u201C\\u201D\\u030B\\u030F]'),d=d.replace(/\s+/g,"\\s+"),"phsterms"===c||"string"===c?(c=d.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),r=d.replace(/\*/g,t+"*"),r=new RegExp("(?:^|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])("+c+")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])|(?="+
t+")("+r+")",e)):"literal*"===c?(d=d.replace(/\*/g,"[^\\s]*"),r=new RegExp("("+d+")",e)):"literal"===c&&(d=d.replace(/\*/g,"\\*"),r=new RegExp("("+d+")",e));x.regex={regex:r}}else d instanceof RegExp&&(x.regex={regex:d});return x},findNext:function(a,c){if(a.regex){if(void 0===a.blockIndex){if(void 0!==a.startACC){var b;a:{b=a.startACC;for(var d=0;d<c.length;d++){var e=c[d].range;if(b>=e.acc&&b<e.accend){b=d;break a}if(d==c.length-1&&(b=e.accend)){b=d;break a}}b=void 0}a.blockIndex=b}if(void 0===
a.blockIndex)if(a.reverse){if(fa.isPending())return;a.blockIndex=c.length-1}else a.blockIndex=0}for(;;){if(a.hitIndex>=a.hits.length){a.hits=[];a.hitIndex=0;for(b=a.reverse?0:c.length;;){d=c[a.blockIndex];if(!d)break;if(!d.text)break;var f,e=0;f=a.regex.searchParameters;var r=a.regex.regex;a.regex.last&&!fa.isPending()&&a.blockIndex==c.length-1&&(r=a.regex.last);a.regex.first&&0===a.blockIndex&&(r=a.regex.first);if(r){var h=d.text;if(f){var g;O.performance&&"function"===typeof performance.now&&(g=
performance.now());h=na(d.text,f);void 0!==g&&(a.prepTime+=performance.now()-g)}for(;(f=l(a,r,h))&&""!==f[0];){var k=d.range.acc+f.index;a.nextOffset=0;var F=m(a,f,k);if(F){if("dtsearch"===a.type||"lucene"===a.type){for(var A=F.lastTermACC-k,p=null;0<A;){var A=f[0].substring(0,A),t=r.source,B="";r.global&&(B+="g");r.ignoreCase&&(B+="i");r.multiline&&(B+="m");A=(new RegExp(t,B)).exec(A);if(!A||""===A[0])break;A=m(a,A,k+A.index);if(!A)break;p||(p=[]);p.push(A);A=A.lastTermACC-k}if(p)for(k=p.length-
1;0<=k;k--)a.hits.push(p[k])}a.hits.push(F)}f.index>e&&(e=f.index);e+=a.nextOffset+1;r.lastIndex=e}}a.blockIndex+=a.reverse?-1:1;if(0<a.hits.length)break;if(a.reverse){if(a.blockIndex<=b)break}else if(a.blockIndex>=b)break}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;){b=a.hits[a.hitIndex];d=!0;void 0!==a.startACC&&(d=a.reverse?b.range.acc<=a.startACC:b.range.acc>=a.startACC);void 0!==a.prevRange&&(d=a.reverse?b.range.acc<a.prevRange.acc||b.range.acc==
a.prevRange.acc&&b.range.accend<a.prevRange.accend:b.range.acc>a.prevRange.acc||b.range.acc==a.prevRange.acc&&b.range.accend>a.prevRange.accend);if(d)return a.hitIndex++,a.prevRange=b.range,b;if(d&&fa.isPending())return;a.hitIndex++}}}}}}(),ja=za.extend("rawtext",{events:{add:{}},install:function(b){var e=/(\r\n|\r|\n)/g,d=/\s/g,c=[],a,f,g=function(){if(void 0===a)for(var b=a=0;b<c.length;b++)c[b].text&&a++;return a};b.findStart=function(a,c,b,d,e,f,g){return Ic.findStart(a,c,b,d,e,f,g)};b.findNext=
function(a){return Ic.findNext(a,c)};b.findBoundaryStart=function(a,b){var f;if(0<c.length){var g="line"===b?e:d;g.lastIndex=0;for(var l=t(a);void 0!=l;){var m=c[l];if(!m.text)break;for(var k;k=g.exec(m.text);){k=m.range.acc+k.index;if(k>a)break;f=k+1}if(void 0!==f)break;if(0===l)break;l--}}void 0===f&&(f=a);return f};b.findBoundaryEnd=function(a,b){var f;if(0<c.length){var g="line"===b?e:d;g.lastIndex=0;for(var l=t(a);void 0!=l;){var m=c[l];if(!m.text)break;for(var k;k=g.exec(m.text);)if(k=m.range.acc+
k.index,k>a){f=k;break}if(void 0!==f)break;if(l+1>=c.length)break;l++}}void 0===f&&(f=a);return f};b.firstACC=function(){if(0<c.length)return c[0].range.acc};b.lastACC=function(){if(0<c.length)return c[c.length-1].range.accend};b.hasRawText=function(){if(0<c.length)return!0;if(!fa.isPending())return!1};b.isPending=function(){return fa.isPending()?!0:g()<c.length};b.getRawTextBlock=function(a){if(0<=a&&a<c.length)return a=c[a],a.text||v(a),a};var k=function(){var a=t(this.acc),d=t(this.accend);if(void 0===
a||void 0===d)b.isPending()?(b.onadd(this,k),fa.onadd(this,k)):(b.offadd(this,k),fa.offadd(this,k),this.callback());else{for(var e=0,f=a;f<=d;f++){var g=c[f];!g.text&&g.src?v(g,k,this):e++}e==d-a+1&&(b.offadd(this,k),fa.offadd(this,k),this.callback())}};b.loadRawText=function(a,c,b){k.call({acc:a,accend:c,callback:b})};b.getRawText=function(a,b){for(var d=t(a),e=t(b),f;d<=e;d++){var g=c[d];if(!g.text){f=void 0;break}var l=a-g.range.acc;0>l&&(l=0);var m=b-g.range.acc;m>g.text.length&&(m=g.text.length);
g=g.text.substring(l,m);f=f?f+g:g}return f};var t=function(a){for(var b=0;b<c.length;b++){var d=c[b].range;if(a>=d.acc&&a<d.accend||b==c.length-1&&(a=d.accend))return b}},v=function(a,c,b){if(!a.text&&a.src){if(c){a.callbacks||(a.callbacks=[]);for(var d=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==c&&a.callbacks[e].context==b){d=!0;break}d||a.callbacks.push({func:c,context:b})}a.loading||(c=Ra(u.baseURL,a.src),g(),a.loading=!0,Ma({url:c,complete:q,args:[a]}))}else c&&c.call(b,a)},q=function(d,
e,f,g,k){k.loading=!1;200==g?fa.isICD(f)?fa.processContentData(f):(k.text=f,p(k)):(k.text="",b.logAJAXError(null,"Failed to load a document text block from the server",d,g,f));a++;e=c.indexOf(k);d=c[e-1];e=c[e+1];d&&d.text&&(k.text=d.text.substr(d.text.length-2048,2048)+k.text,k.range.acc-=2048);e&&e.text&&(e.text=k.text.substr(k.text.length-2048,2048)+e.text,e.range.acc-=2048);if(k.callbacks){for(d=0;d<k.callbacks.length;d++)k.callbacks[d].func.call(k.callbacks[d].context,k);delete k.callbacks}200==
g&&b.on.add.dispatch(k.range.acc,k.range.accend)};b.replaceRawText=function(a){if(a&&(f=f?f.concat(a):a,0<c.length))for(a=0;a<c.length;a++)p(c[a])};var p=function(a){if(f&&f.length&&a.text)for(var c,b=a.range.acc,d=a.range.acc+a.text.length,e=0;e<f.length;e++)if(c=f[e],c.acc<=d&&c.accend>=b){var g=c.acc-b;0>g&&(g=0);c=c.accend-b;c>a.text.length&&(c=a.text.length);for(var m=c-g,k="";0<m--;)k+=" ";a.text=a.text.substr(0,g)+k+a.text.substr(c)}a.text&&w.normalizeAccentsForSearch&&(a.text=jc(a.text))};
D.onreset(function(){f=a=void 0;c=[]});fa.ondata(function(a,b,d){if(a.text)for(b=0;b<a.text.length;b++){d=a.text[b];p(d);for(var e=0;e<c.length;e++)if(0===Xa(d.range,c[e].range)){c[e].text=d.text;d=null;break}d&&(c.push(d),v(d))}})}}),kc,wa,sa,Pb,Fb,ta,Gb,xa,Xa,Jc,cb,ha,Kc,lc,Qb,nb,ub;(function(){var b=function(b,d){return b.acc-d.acc};kc=function(b){return!!wa(b,!1,!1)};wa=function(b,d,c){var a;if(b&&b.type)switch(b.type){case "text":aa(b.acc)&&aa(b.accend)&&(a=b);a&&c&&(b=z.forRange(a,0,!0))&&b.isEmailHeader()&&
(b=z.findTextRange(a))&&(b=b[0].startContainer)&&(y.isText(b)||y.isElement(b))&&(b=Ua(b),b=Fb(b))&&(Array.isArray(b)&&(b=sa(b[0].acc,b[b.length-1].accend)),a.acc<b.acc||a.accend>b.accend)&&(a=ha(a),a.acc<b.acc&&(a.acc=b.acc),a.accend>b.accend&&(a.accend=b.accend));break;case "cell":if(aa(b.page)&&aa(b.c1)&&aa(b.r1)&&aa(b.c2)&&aa(b.r2)&&(a=b,0>a.page?a=void 0:a.page<z.count()?(c=z.page(a.page))&&"worksheet"!==c.type&&"database"!=c.type&&(a=void 0):a.offsets&&(aa(a.offsets.left)&&aa(a.offsets.top)&&
aa(a.offsets.right)&&aa(a.offsets.bottom)||(a=void 0)),a&&!0===d&&(c=z.page(b.page)))&&(c=c.spreadsheetModel())){var e=c.colCount()-1;d=c.rowCount()-1;if(b.c1>e||0>b.c2||b.r1>d||0>b.r2)a=void 0;else{c=ca(b.c1,0,e);var e=ca(b.c2,0,e),g=ca(b.r1,0,d);d=ca(b.r2,0,d);if(c!==b.c1||e!==b.c2||g!==b.r1||d!==b.r2)a=ha(b),a.c1=c,a.c2=e,a.r1=g,a.r2=d}}break;case "rect":if(aa(b.page)&&aa(b.left)&&aa(b.top)&&aa(b.right)&&aa(b.bottom)&&fb(b.units)&&("px"===b.units||"tw"===b.units||"pct"===b.units)&&(a=b,"pct"!==
b.units||aa(b.embedId)?0>a.page?a=void 0:void 0===b.embedId&&a.page<z.count()&&(c=z.page(a.page))&&"page"!==c.type&&"drawing"!==c.type&&"slide"!==c.type&&"chart"!==c.type&&"bitmap"!==c.type&&"email"!==c.type&&"html"!==c.type&&"rt"!==c.type&&"sn"!==c.type&&(a=void 0):a=void 0,a&&void 0===b.embedId&&!0===d&&(c=z.page(b.page))&&(d=c.pageRect())))if(b.left>d.right||b.right<d.left||b.top>d.bottom||b.bottom<d.top)a=void 0;else{var e=ca(b.left,d.left,d.right),g=ca(b.top,d.top,d.bottom),k=ca(b.bottom,g,d.bottom),
t=b.right;"html"!==c.type&&(t=ca(b.right,e,d.right));if(e!=b.left||t!=b.right||g!=b.top||k!=b.bottom)a=ha(b),a.left=e,a.right=t,a.top=g,a.bottom=k}}return a};sa=function(){var b=arguments,d,c;switch(b.length){case 2:aa(b[0])&&aa(b[1])&&(d=b[0],c=b[1]);break;case 1:if(aa(b[0]))d=b[0],c=b[0];else if(Ja(b[0])||Aa(b[0])){if(b=Fb(b[0]))Array.isArray(b)?(d=b[0].acc,c=b[b.length-1].accend):(d=b.acc,c=b.accend)}else if((b=wa(b[0]))&&"cell"===b.type){var a=z.page(b.page);if(a&&("worksheet"===a.type||"database"===
a.type)&&(a=a.spreadsheetModel()))return a.mapToText(b)}}var f;aa(d)&&aa(c)&&(f=new OIT.TextRange(d,c));return f};Pb=function(b,d){b=y.unwrap(b);d=d||0;var c;a:{if(1===b.nodeType&&b.childNodes&&(c=b.childNodes[d]))break a;c=void 0}c&&(b=c,d=0);var a;c=u.viewNode;for(var e=b;e;e=e.parentNode){var g=y.data(e,"acc");if(void 0!==g){"none"!==g&&(a=y.wrap(e));break}if(e===c)break}if(c=a){a=parseInt(c.data("acc"),10);if(!c.equals(b))for(c=c.createTreeWalker(),e=c.firstACCNode();e;){e=c.currentNode;if(e===
b)break;1===e.nodeType?(e=y.data(e,"acc"))&&(a=parseInt(e,10)):3===e.nodeType&&(a+=e.nodeValue.length);e=c.nextACCNode()}return a+d}};Fb=function(b){var d;Ja(b)?d=b:Aa(b)&&"number"===typeof b.rangeCount&&0<b.rangeCount?d=b.getRangeAt(0):y.isElement(b)&&(d=Y.createRange(),d.selectNode(y.unwrap(b)));if(d){b=d.startContainer;var c=d.startOffset,a=d.endContainer,e=d.endOffset,g,k;if(b===a){g=Pb(b,c);if(c===e)return sa(g,g);if(y.isText(b))return sa(g,g+e-c)}for(var t=d.commonAncestorContainer;t&&!y.isElement(t);)t=
t.parentNode;t=y.wrap(t);d=Pb(t);var v=[],q,t=t.createTreeWalker();g=t.firstACCNode();for(var p=!1,m=!1,l=!1;g;){var K=t.currentNode;K===b&&y.isText(b)?p=!0:p||K.parentNode!==b||(m=!0,0!==c&&y.nodeIndex(K)!=c)||(p=!0);m&&!p&&(y.isDescendantOf(K,b)||(p=!0));if(l&&!y.isDescendantOf(K,a))break;1===K.nodeType?(g=y.data(K,"acc"))&&(d="none"===g?void 0:Number(g)):3===K.nodeType&&void 0!==d&&(p&&0<K.nodeValue.length&&(g=d,K===b&&(g+=c),k=d+K.nodeValue.length,K===a&&(k=d+e),q&&q.accend!=d&&q.accend!=d-1&&
(q=null),q?q.accend=k:(q=sa(g,k),v.push(q))),d+=K.nodeValue.length);if(K===a&&y.isText(a))break;else if(K.parentNode===a&&(l=!0,0===e||y.nodeIndex(K)>=e))break;g=t.nextACCNode()}v=Kc(v);0===v.length?v=void 0:1==v.length&&(v=v[0]);return v}};ta=function(){var b,d,c,a,f,g,k,t=arguments;switch(t.length){case 9:d=t[0];c=t[1];a=t[2];f=t[3];g=t[4];k={left:t[5],top:t[6],right:t[7],bottom:t[8]};break;case 5:d=t[0];c=t[1];a=t[2];f=t[3];g=t[4];break;case 4:c=t[0];a=t[1];f=t[2];g=t[3];break;case 3:d=t[0];c=
t[1];a=t[2];f=t[1];g=t[2];break;case 2:c=t[0];a=t[1];f=t[0];g=t[1];break;case 1:if((t=wa(t[0]))&&"text"===t.type&&(b=z.forRange(t))&&("worksheet"===b.type||"database"===b.type)&&(b=b.spreadsheetModel()))return b.mapToCells(t)}if(void 0===d)d=z.current();else if(fb(d)){if(b=z.byName(d))d=b.index}else if(aa(d)){if(0>d||d>=z.count())d=void 0}else d=void 0;var v;aa(d)&&aa(c)&&aa(a)&&aa(f)&&aa(g)?v=new OIT.CellRange(d,c,a,f,g,k):D.invalidArg("cellRange");return v};Gb=function(){var b,d,c,a,f,g,k="px",
t=arguments;if(2<=t.length&&6>=t.length){var v=0;if(fb(t[v])){var q=z.byName(t[v]);q&&(d=q.index,v++)}for(var q=0,p=v;p<t.length;p++)if(aa(t[p]))q++;else break;switch(q){case 6:b=t[v++];case 5:d=t[v++];case 4:c=t[v++];a=t[v++];f=t[v++];g=t[v++];break;case 3:d=t[v++];case 2:c=t[v++],a=t[v++],f=c,g=a}v<t.count&&fb(t[v])&&(k=t[v++])}if(void 0===d)d=z.current();else if(aa(d)){if(0>d||d>=z.count())d=void 0}else d=void 0;var m;aa(d)&&aa(c)&&aa(a)&&aa(f)&&aa(g)&&("px"===k||"tw"===k||"pct"===k)?m=new OIT.RectRange(b,
d,c,a,f,g,k):D.invalidArg("rectRange");return m};xa=function(b,d){if(b&&"rect"===b.type&&b.units!==d){var c,a,e;switch(d){case "px":"tw"===b.units?(c=z.page(b.page))&&c.dpi&&(b.left=Q(b.left*c.dpi/1440,1E4),b.top=Q(b.top*c.dpi/1440,1E4),b.right=Q(b.right*c.dpi/1440,1E4),b.bottom=Q(b.bottom*c.dpi/1440,1E4),b.units="px"):"pct"===b.units&&void 0!==b.embedId&&(c=z.page(b.page))&&(c=c.embeddingRect(b.embedId))&&(a=c.width/100,e=c.height/100,b.left=Q(b.left*a,1E4),b.right=Q(b.right*a,1E4),b.top=Q(b.top*
e,1E4),b.bottom=Q(b.bottom*e,1E4),b.units="px");break;case "tw":"px"===b.units&&(c=z.page(b.page))&&c.dpi&&(b.left=Q(1440*b.left/c.dpi,1E4),b.top=Q(1440*b.top/c.dpi,1E4),b.right=Q(1440*b.right/c.dpi,1E4),b.bottom=Q(1440*b.bottom/c.dpi,1E4),b.units="tw");break;case "pct":if("px"===b.units&&(c=z.page(b.page))){if(void 0!==b.embedId){if(c=c.embeddingRect(b.embedId))a=100/c.width,e=100/c.height}else e=c.pageRect(),a=100/e.width,e=100/e.height;void 0!==a&&(b.units="pct",b.left=Q(b.left*a,1E4),b.right=
Q(b.right*a,1E4),b.top=Q(b.top*e,1E4),b.bottom=Q(b.bottom*e,1E4))}}}};Xa=function(b,d){if(!b)return d?-1:0;if(!d)return 1;if(b.page<d.page)return-1;if(b.page>d.page)return 1;if(b.type===d.type)switch(b.type){case "text":return b.acc<d.acc?-1:d.acc<b.acc?1:b.accend<d.accend?-1:d.accend<b.accend?1:0;case "cell":if(b.r1<d.r1)return-1;if(d.r1<b.r1)return 1;if(b.c1<d.c1)return-1;if(d.c1<b.c1)return 1;if(b.r2<d.r2)return-1;if(d.r2<b.r2)return 1;if(b.c2<d.c2)return-1;if(d.c2<b.c2)return 1;if(b.offsets)if(d.offsets){if(b.offsets.top<
d.offsets.top)return-1;if(b.offsets.top>d.offsets.top)return 1;if(b.offsets.left<d.offsets.left)return-1;if(b.offsets.left>d.offsets.left)return 1;if(b.offsets.bottom<d.offsets.bottom)return-1;if(b.offsets.bottom>d.offsets.bottom)return 1;if(b.offsets.right<d.offsets.right)return-1;if(b.offsets.right>d.offsets.right)return 1}else return 1;else if(d.offsets)return-1;return 0;case "rect":return b.units!=d.units&&(d=ha(d),xa(d,b.units)),b.top<d.top?-1:d.top<b.top?1:b.left<d.left?-1:d.left<b.left?1:b.bottom<
d.bottom?-1:d.bottom<b.bottom?1:b.right<d.right?-1:d.right<b.right?1:0}};Jc=function(b,d){if(b.type===d.type)switch(b.type){case "text":return d.acc>=b.acc&&d.accend<=b.accend}return!1};cb=function(b,d){if(b&&d&&d.type===b.type)switch(d.type){case "text":return b.accend>d.acc&&b.acc<d.accend;case "cell":return b.c2>=d.c1&&b.c1<=d.c2&&b.r2>=d.r1&&b.r1<=d.r2;case "rect":return b.right>=d.left&&b.left<=d.right&&b.bottom>=d.top&&b.top<=d.bottom}return!1};ha=function(b){var d;if(b)switch(b.type){case "text":d=
new OIT.TextRange(b.acc,b.accend);break;case "cell":d=new OIT.CellRange(b.page,b.c1,b.r1,b.c2,b.r2);!0===b.selectingCols&&(d.selectingCols=!0);!0===b.selectingRows&&(d.selectingRows=!0);b.offsets&&(d.offsets={left:b.offsets.left,top:b.offsets.top,right:b.offsets.right,bottom:b.offsets.bottom});break;case "rect":d=new OIT.RectRange(b.embedId,b.page,b.left,b.top,b.right,b.bottom,b.units,b.section)}return d};ub=function(b,d){if(d)if(Array.isArray(d))for(var c=0;c<d.length;c++)b=ub(d[c],b);else if(!b)b=
ha(d);else if(b.type===d.type)switch(b.type){case "cell":d.c1<b.c1&&(b.c1=d.c1);d.r1<b.r1&&(b.r1=d.r1);d.c2>b.c2&&(b.c2=d.c2);d.r2>b.r2&&(b.r2=d.r2);break;case "text":d.acc<b.acc&&(b.acc=d.acc),d.accend>b.accend&&(b.accend=d.accend)}return b};Kc=function(e){if(e&&1<e.length){e.sort(b);for(var d=[],c,a=0;a<e.length;a++){var f=e[a];c&&3>f.acc-c.accend?f.accend>c.accend&&(c.accend=f.accend):(c=f,d.push(f))}e=d}return e};lc=function(b){if(1===b.length)return b[0];if(1<b.length){var d=b[0],c=Y.createRange();
c.setStart(d.startContainer,d.startOffset);c.setEnd(d.endContainer,d.endOffset);for(var d=Ua(d.startContainer),a=1;a<b.length;a++){var e=b[a],g=Ua(e.endContainer);y.unwrap(g)==y.unwrap(d)&&c.setEnd(e.endContainer,e.endOffset)}return c}};Qb=function(b){if(b=wa(b))switch(b.type){case "text":return b.acc==b.accend;case "cell":return!1;case "rect":return b.left==b.right||b.top==b.bottom}return!0};nb=function(b){if(b)switch(b.type){case "cell":var d=[];d.push(Va(b.c1),b.r1+1);b.c2==b.c1&&b.r2==b.r1||d.push(":",
Va(b.c2),b.r2+1);return d.join("")}}})();var J=za.extend("display",{events:{displayload:{},displayunload:{}},install:function(b){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},d=null,c=null,a=e,f=!1,g;b.loadDisplay=function(e){b.unloadDisplay();var f=e.type;e.overlay&&e.overlay.firstPage&&(f=e.overlay.firstPage.type);if(d=va.createDisplay(f))c=e.overlay,u.deType=f,
a=va.features(f),u.drawing.resetOrigin(),oa.hideLoadingSkeleton(),d.init(e),b.on.displayload.dispatch(c.firstPage,c.lastPage)};b.unloadDisplay=function(){d&&(b.on.displayunload.dispatch(c.firstPage,c.lastPage),d.unload(),c=d=null,u.deType=null,oa.showLoadingSkeleton());a=e};b.features=function(){var b=a;if("vertical"!==w.scrollMode){var c=z.activePage();c&&(b=va.features(c.type))}return b};b.isSelectionModeSupported=function(a){var c=!1;switch(a){case "none":c=!0;break;case "text":b.features().textselection&&
(c=!0);break;case "rect":b.features().rectselection&&(c=!0);break;case "cell":b.features().cellselection&&(c=!0)}return c};b.isHighlightModeSupported=function(a){var c=b.isSelectionModeSupported(a);c||"text"!==a||"worksheet"!==u.deType&&"database"!==u.deType||(c=!0);return c};b.visiblePages=function(){return d?d.visiblePages():[]};b.startElasticScroll=function(){if(d)return d.startElasticScroll()};b.elasticScroll=function(a,b){if(d)return d.elasticScroll(a,b)};b.endElasticScroll=function(a,b){if(d)return d.endElasticScroll(a,
b)};b.saveScrollPos=function(){if(d)return d.saveScrollPos()};b.restoreScrollPos=function(a){d&&d.restoreScrollPos(a)};b.maxPageWidth=function(){if(d)return d.maxPageWidth()};b.maxPageHeight=function(){if(d)return d.maxPageHeight()};b.padding=function(){if(d)return d.padding()};b.scrollPadding=function(){if(d)return d.scrollPadding()};b.margin=function(){if(d)return d.margin()};b.scrollOffset=function(){if(d)return d.scrollOffset()};b.keydown=function(a){return d?d.keydown(a):!0};b.showHidden=function(a){d&&
d.showHidden(a)};b.loadRange=function(a,b){d&&d.loadRange(a,b)};b.expandRange=function(a){d&&(a=d.expandRange(a));return a};b.moveto=function(a,b,c){return d?d.moveto(a,b,c||{}):!1};b.getSelectedText=function(){return d?d.getSelectedText():""};b.select=function(a){return d?d.select(a):!1};b.pageRange=function(a,b){if(d&&c.containsPage(a))return d.pageRange(a,b)};b.pageRect=function(a,b){if(d&&c.containsPage(a))return d.pageRect(a,b)};b.rangeRect=function(a,b,e,f){if(d&&("text"===a.type||c.containsPage(a.page)))return d.rangeRect(a,
b,e,f)};b.rangeFromRect=function(a,b,e,f,g,m,l,K){if(d&&c.containsPage(a))return d.rangeFromRect(a,b,e,f,g,m,l,K)};b.extendRange=function(a,b,c,e){if(d)return d.extendRange(a,b,c,e)};b.moveAnchor=function(a,b,c,e){return d?d.moveAnchor(a,b,c,e):!1};b.incrementSelection=function(a,b,c,e,f){return d?d.incrementSelection(a,b,c,e,f):!1};b.suspendUpdate=function(){f||(f=!0)};b.resumeUpdate=function(){f&&(f=!1,b.update())};b.layoutChanged=function(a){d&&d.layoutChanged(a)};b.update=function(a,c){if(!f)if(!0===
c)g&&ra(g),g=da(b.update,50,this,a,!1);else if(d)return d.update(a);return!1};b.activeOverlay=function(){return c};D.onreset(b.unloadDisplay);Hc.onfontload(function(){b.update(!0)})}}),T=za.extend("selection",{events:{beginselection:{},selectionchanged:{}},install:function(b){var e=null,d=!0,c,a=null,f=!0,g=!1,k=!0,t=!1,v,q,p,m,l,K,F,N,H,R,C,M=0,G,h,B,V=0,I,r,A=0,ea=0,na,L,X,n=[],x,W,E,ba;b.reset=function(){b.select(null);w.selectionMode=b.validateMode(w.selectionMode)};b.style=function(b,c){f=!1===
c?!1:!0;null!==b&&"string"!==typeof b||b===a||(a=b,e=db(a),Ca(),ma());return a};b.isSelecting=function(){return t};var Ca=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var b=e["background-color"];b&&(a+="background-color:"+b+";")}a&&0<a.length?(x||(x=y.create("style"),x.type="text/css",y.byTagName("head")[0].append(x)),x.html(".oit-view ::selection, .oit-annopane ::selection { "+a+"}")):x&&x.html("")},ma=function(){if(q){var a=q.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),
a.css(e)):a.addClass("oit-sel-rect");a.update()}};b.textSelection=function(){if(p){if("text"===p.type)return ha(p);if("cell"===p.type)return sa(p)}};b.cellSelection=function(){if(p&&"cell"===p.type)return ha(p)};b.rectSelection=function(){if(p&&"rect"===p.type)return ha(p)};b.selectionType=function(){return p?p.type:"none"};b.hide=function(a){d=!1;c=a;ic("firefox")?b.select(null):c?Ca(c):Ca("background-color: rgba(255,255,255,0);");q&&q.showSelectionRect(!1)};b.select=function(a,e,n,f){var x=!1;d=
!0;c=null;if(null===a)x=!!p,qa(),b.update();else if(a)if(Aa(a)||Ja(a))x=b.select(sa(a));else if(a=wa(a),!a||a.selectingRows||a.selectingCols||!1===a.autoExpand||(a=J.expandRange(a)),a&&0!==Xa(a,p)){var r=z.forRange(a,0,!0);r&&(x=!0,b.on.beginselection.dispatch(a),qa(),q=r,p=ha(a),v=ha(a),ma(),b.update())}if(x||e!==ba)b.on.selectionchanged.dispatch(p,!0),ba=e,D.on.select.dispatch(p,n||null,f||null,Qb(p),e)&&(u.drawing&&u.drawing.update(!0),p&&void 0===e&&(a=J.rangeRect(p,"view"),"text"===p.type&&b.update(),
a&&P.activateNearest(a.left,a.top)));return x};b.saveSelection=function(){if(!p)return null;var a={range:ha(p)};d||(a.visible=!1,a.hideStyle=c);return a};b.restoreSelection=function(a){if(a){var c=a.range,d=z.forRange(c,0,!0);d&&(b.on.beginselection.dispatch(c),qa(),q=d,p=ha(c),v=ha(c),ma(),b.update(),a.visible||b.hide(a.hideStyle))}};b.startRectSelection=function(a,e,n){qa();z.deactivateAnnotation();t=!0;J.isSelectionModeSupported("text")||P.startSelection();n=z.mapToPage(a,e,null,!0);b.logRect&&
b.logRect(n.page,n.x,n.y,!0);m={x:a,y:e};q=n.page;F=n.x;N=n.y;H=a;R=e;d=K=!0;c=null;p=J.rangeFromRect(q.index,F,N,F,N,q,"select");"cell"!==p.type||g||delete p.offsets;v=ha(p);b.on.beginselection.dispatch(p);ma();b.update();b.on.selectionchanged.dispatch(p,!1);return!0};b.extendRectSelection=function(a,c,d){v&&(K&&(d=Math.abs(c-R),2<Math.abs(a-H)||2<d)&&(K=!1,J.isSelectionModeSupported("text")&&P.startSelection()),Ga(l,a,c),a=z.mapToPage(a,c,q,!0),b.logRect&&b.logRect(a.page,a.x,a.y),p=J.extendRange(v,
a.x,a.y,a.page),k&&(p=wa(p,!0)),b.update(),b.on.selectionchanged.dispatch(p,!1))};b.endRectSelection=function(a,c,d){pa();t=!1;b.extendRectSelection(a,c);b.on.selectionchanged.dispatch(p,!0);var e={x:a,y:c},n=K;ba=void 0;D.on.select.dispatch(p,m,e,K)&&"rect"===w.selectionMode&&b.select(null);n&&d&&(e=y.wrap(d.target),e.isDescendantOf(z.activeOverlay())||e.isDescendantOf(u.drawing))&&((e=z.activePage())&&e.isSpreadsheet()?P.activateNearest(a,c,d,!0):(a=P.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||
P.deactivate());P.endSelection()};b.cancelRectSelection=function(a,c){pa();b.select(null)};b.startTouchTextSelection=function(a,e){d=!0;c=null;W&&b.abortTouchTextSelection();t=!0};b.updateTouchTextSelection=function(){var a=O.getSelection();!a.anchorNode||E&&E.anchorNode==a.anchorNode&&E.anchorOffset==a.anchorOffset&&E.focusNode==a.focusNode&&E.focusOffset==a.focusOffset||(E||(E={}),E.anchorNode=a.anchorNode,E.anchorOffset=a.anchorOffset,E.focusNode=a.focusNode,E.focusOffset=a.focusOffset,W=sa(a))};
b.abortTouchTextSelection=function(){W=null;t=!1};b.startTextSelection=function(a,e,n,f){qa();t=!0;B=C=null;l=y.wrap(f.target);d=!0;c=null;m={x:a,y:e};K=!0;H=a;R=e;if(!J.features().customtextselection)return!1;a=z.mapToPage(a,e,null,!0,!0);a.inAnnotation||z.deactivateAnnotation();e=a.page.mapPointToText(a.x,a.y,null,a.inAnnotation);if(!e||!e.overlaps)return!1;r=a;h=Ua(e.node);var x;if("line"===n||"word"===n)x=a.page.findTextBoundary(e.node,e.offset,n);x?(I=n,G=x,C=G.startContainer,M=G.startOffset,
B=G.endContainer,V=G.endOffset):(I=void 0,C=e.node,M=e.offset,B=e.node,V=e.offset);if(C&&B&&(b.update(),y.selectRange(C,M,B,V),n=O.getSelection(),n.anchorNode&&n.focusNode))if(n=sa(n))b.on.beginselection.dispatch(n);else return B=C=null,!1;return!0};b.extendTextSelection=function(a,b,c){if(!J.features().customtextselection)return!1;K&&(c=Math.abs(b-R),2<Math.abs(a-H)||2<c)&&(K=!1,J.isSelectionModeSupported("text")&&P.startSelection());Ga(l,a,b);c=null;var d=!1;r&&r.inAnnotation&&(c=r.page,d=!0);a=
z.mapToPage(a,b,c,!0,!0,d);b=a.page.mapPointToText(a.x,a.y,h,a.inAnnotation);if(!b)return!1;if(b.node!=B||b.offset!=V){if(I){if(b=a.page.findTextBoundary(b.node,b.offset,I))a=b.compareBoundaryPoints(Range.START_TO_START,G),-1==a?(B=b.startContainer,V=b.startOffset,C=G.endContainer,M=G.endOffset):(C=G.startContainer,M=G.startOffset,B=b.endContainer,V=b.endOffset)}else B=b.node,V=b.offset;C&&B&&(C==B?M>V?y.selectRange(B,V,C,M):y.selectRange(C,M,B,V):(a=C.compareDocumentPosition(B),2==a?y.selectRange(B,
V,C,M):y.selectRange(C,M,B,V)))}return!0};b.endTextSelection=function(a,c,d){pa();t=!1;r=l=null;if("text"==w.selectionMode){var e,n=K;I&&(n=!1);W?(e=W,W=null):(e=O.getSelection(),e=e.anchorNode&&e.focusNode?sa(e):null);if(!e)qa(),P.autoHighlight()&&y.clearSelection();else if(0!==Xa(e,p)){e.acc!==e.accend&&(n=!1);var f=z.forRange(e);f&&(K=!1,R=H=N=F=void 0,q=f,p=e,v=ha(e),b.on.selectionchanged.dispatch(p,!0),e={x:a,y:c},ba=void 0,D.on.select.dispatch(p,m,e,Qb(p)))}n&&d&&(d=y.wrap(d.target),d.isDescendantOf(z.activeOverlay())||
d.isDescendantOf(u.drawing))&&((a=P.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||P.deactivate());C=void 0;M=0;B=G=void 0;V=0;I=void 0}P.endSelection()};b.incrementSelection=function(a,c,d){var e=!1;p&&(e=J.incrementSelection(v,p,a,c,d))&&(b.update(),b.on.selectionchanged.dispatch(p,!0));return e};b.moveAnchor=function(a,c,d){var e=!1;v&&(e=J.moveAnchor(v,a,c,d))&&(p=ha(v),b.update(),b.on.selectionchanged.dispatch(p,!0));return e};b.update=function(a){if(p)if("text"===p.type)y.clearSelection(),
b.logUpdate&&b.logUpdate(p),(a=z.findTextRange(p))&&y.selectRange(lc(a));else{if(q)if(a=J.rangeRect(p,"overlay",!0),b.logUpdate&&b.logUpdate(p,a),!a)q.showSelectionRect(!1);else if(q.hasSelectionRect()){var c=q.selectionRect();c.move(a.left,a.top,a.width,a.height);c.show(d&&(!K||f)&&("rect"===p.type||"cell"===p.type))}}else!1!==a&&y.clearSelection();J.select(p)&&J.update()};var qa=function(){y.clearSelection();q&&q.showSelectionRect(!1);t=!1;d=!0;c=null;K=!1;R=H=N=F=void 0;p=v=q=null;Ca();ma()};b.validateMode=
function(a,c){J.isSelectionModeSupported(a)||("rect"===a?J.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(c?a=b.validateMode(c):J.isSelectionModeSupported("text")?a="text":J.isSelectionModeSupported("rect")?a="rect":J.isSelectionModeSupported("cell")&&(a="cell"));return a};b.addAutoscrollRoot=function(a){n.push(y.wrap(a))};var Ga=function(a,b,c){if(b!=na||c!=L){var d=u.viewNode;na=b;for(L=c;a&&-1==n.indexOf(a);){if(a===d||!(a instanceof U)){a=null;
break}a=a.parent()}var e;a?(e=a.pos(d),b-=e.left,c-=e.top,e=a.clientWidth*w.zoom,d=a.clientHeight*w.zoom):(a=d,e=d.clientWidth,d=d.clientHeight);1>=b?(A=b-1,-30<A&&(A=-30)):b>=e-1?(A=b-(e-1),30>A&&(A=30)):A=0;1>=c?(ea=c-1,-30<ea&&(ea=-30)):c>=d-1?(ea=c-(d-1),30>ea&&(ea=30)):ea=0;A||ea?X||(X=tb(ka,100,null,a)):pa()}},ka=function(a){a.dscroll(A,ea);C?b.extendTextSelection(na,L):b.extendRectSelection(na,L)},pa=function(){X&&(Ta(X),X=void 0,ea=A=0)};b.enableCellOffsets=function(a){g=!!a};b.bindSelectionToPage=
function(a){k=!!a};qa();w.onselectionMode(function(a){b.select(null);(a=z.activeOverlay())&&a.updateCSS()});D.onreset(function(){b.reset();n=[]});J.ondisplayload(b.reset);la.ondetach(function(){a=e=null;x&&(x.destroy(),x=null)});D.onzoom(function(a,c,d){b.update()})}}),ab=za.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(b){var e=!1,d=!1,c=!1,a=!1,f,g,k=null,t,v,q,p=null,m,l,K,F,N,H,R,C,M,G=0,h=0,B=0,V=0;D.onload(function(){var a=u.rootNode;
a.onmousedown(A);a.onwheel(na);O.addEventListener("mouseup",ea,!1);O.addEventListener("keydown",I,!1);u.isMobileOrTablet&&(a=u.viewNode,a.kinetic(!0),a.ontap(Ga),a.onpress(ka),a.onpressup(pa),a.onpanstart(ya),a.onpanmove(Sa),a.onpanend(Ha),a.onpancancel(Ha),a.onpinchstart(Q),a.onpinchmove(S),a.onpinchend(Db),a.onpinchcancel(Db),a.onrotatestart(Eb),a.onrotatemove(Ka),a.onrotateend(qb),a.onrotatecancel(qb))});D.onreset(function(){var a=u.rootNode;a&&(a.offmousedown(A),a.offwheel(na));O.removeEventListener("mouseup",
ea);O.removeEventListener("keydown",I);u.isMobileOrTablet&&(a=u.viewNode)&&(a.offtap(Ga),a.offpress(ka),a.offpressup(pa),a.offpanstart(ya),a.offpanmove(Sa),a.offpanend(Ha),a.offpancancel(Ha),a.offpinchstart(Q),a.offpinchmove(S),a.offpinchend(Db),a.offpinchcancel(Db),a.offrotatestart(Eb),a.offrotatemove(Ka),a.offrotateend(qb),a.offrotatecancel(qb))});var I=function(a){var c,d;b.logKeydown&&b.logKeydown(a);if(b.isViewEventTarget(a.target)||e&&a.target==Y.body){if((d=D.on.keydown.dispatch(a))&&!u.editingComment&&
(d=J.keydown(a))){c=u.viewNode;var n=P.active(),f=0,x=0;switch(a.keyCode){case 33:J.features().pages&&(c.finishAnimation(),z.updateActivePage(),0<c.scrollTop?c.dscroll(void 0,-c.clientHeight):z.movetoPrev(),d=!1);break;case 34:J.features().pages&&(c.finishAnimation(),z.updateActivePage(),c.scrollTop<Math.max(c.clientHeight,c.scrollHeight,c.offsetHeight)-c.innerHeight?c.dscroll(void 0,c.clientHeight):z.movetoNext(),d=!1);break;case 35:c.scroll(c.scrollWidth,c.scrollHeight);d=!1;break;case 36:c.scroll(0,
0);d=!1;break;case 37:f=-1;break;case 38:x=-1;break;case 39:f=1;break;case 40:x=1;break;case 45:void 0!==n&&P.getOption(n,"enableUserComment")&&(P.showComment(n,{mode:"edit",removeOnCancel:!1}),d=!1);break;case 46:void 0!==n&&P.getOption(n,"enableUserDelete")&&(P.remove(),n=void 0,d=!1);break;case 48:a.ctrlKey&&(D.zoom(1),d=!1);break;case 187:a.ctrlKey&&(D.zoomIn(),d=!1);break;case 189:a.ctrlKey&&(D.zoomOut(),d=!1)}if(f||x){var r;void 0!==n&&(c=P.range(n))&&(r=c.type);r||(r=w.selectionMode);if("cell"===
r||"rect"===r)if(r=a.ctrlKey,void 0!==n){if(a.shiftKey){var g=c=0,h=0,l=0;d=w.rotation;switch(d){case 0:h=f;l=x;break;case 90:l=f;c=-x;break;case 180:c=-f;g=-x;break;case 270:g=-f,h=x}P.move(n,c,g,h,l,r)}else{d=w.rotation;if(0!==d)switch(c=f,g=x,d){case 90:f=-g;x=c;break;case 180:f=-c;x=-g;break;case 270:f=g,x=-c}P.move(n,f,x,f,x,r)}(c=P.range(n))&&z.moveto(c);d=!1}else d=a.shiftKey?!T.incrementSelection(f,x,r):!T.moveAnchor(f,x,r)}}!1===d&&jb(a);return d}},r=function(a){(a.button||0)==N&&(b.releaseMouseCapture(),
b.on.endscroll.dispatch());N=void 0},A=function(n){e=!1;b.logMouse&&b.logMouse(n);if(!u.editingComment){var f=u.viewNode,x=f.mousePos(n);if(b.isViewEventTarget(n.target)){var g=n.button||0,h=f.inRect(x.x,x.y);if(1==g||0===g&&!h)b.on.beginscroll.dispatch(),N=g,b.setMouseCapture(null,r);else{h=!0;f.focus();e=!0;if(0===g){f=w.selectionMode;if("rect"===f||"cell"===f)T.startRectSelection(x.x,x.y,n)&&(c=!0,b.setMouseCapture(Ca)),h=!1;else if("text"==f){var E,f=1;if(void 0!==m){var W;if(n.pageX||n.pageY)E=
n.pageX,W=n.pageY;else if(n.clientX||n.clientY)E=n.clientX,W=n.clientY;E=Math.abs(E-l.x);W=Math.abs(W-l.y);3>=E&&3>=W&&((new Date).getTime()-m<=w.doubleClickInterval&&(f=K+1),m=void 0)}E=f;var k;2===E?k="word":E=1;if(T.startTextSelection(x.x,x.y,k,n))if(a=!0,b.setMouseCapture(ma),x=E,m=(new Date).getTime(),K=x,n.pageX||n.pageY)l={x:n.pageX,y:n.pageY};else if(n.clientX||n.clientY)l={x:n.clientX,y:n.clientY};h=!1}d=!0}!1===h&&jb(n);return h}}}},ea=function(e){var n;b.logMouse&&b.logMouse(e);if(g)n=
g.call(k,e);else if(d){n=!0;if(!u.editingComment){var f=u.viewNode.mousePos(e);0===(e.button||0)&&(c?(c=!1,b.releaseMouseCapture(),T.endRectSelection(f.x,f.y,e)):(a&&(a=!1,b.releaseMouseCapture()),T.endTextSelection(f.x,f.y,e)),n=!1)}d=!1}!1===n&&jb(e);return n},na=function(a){if(!u.editingComment&&b.isViewEventTarget(a.target))if(a.ctrlKey){if(!w.browserZoom){var c=a.deltaY||a.wheelDelta||0;0<c?OIT.document.zoomIn():0>c&&OIT.document.zoomOut();jb(a);return!1}}else b.on.beginscroll.dispatch(),void 0!==
F&&ra(F),F=da(L,500)},L=function(){F=void 0;b.on.endscroll.dispatch()};b.setMouseCapture=function(a,c,d){b.releaseMouseCapture();"function"===typeof a&&(O.addEventListener("mousemove",X,!0),f=a);"function"===typeof c&&(g=c);if(f||g)y.body.onmouseover(n),y.body.onmouseout(x);k=d};var X=function(a){if(f&&!1===f.call(k,a))return jb(a),!1},n=function(a){if(H){var b=qa(a);if(b!==H.buttons&&H.buttons&1&&!(b&1)){var b=H,c;Y.createEvent?(c=Y.createEvent("MouseEvent"),c.initMouseEvent("mouseup",!0,!0,O,null,
b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):c=new MouseEvent("mouseup",{screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});ea(c)}H=void 0}},x=function(a){H={buttons:qa(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};b.releaseMouseCapture=function(){f&&
(O.removeEventListener("mousemove",f,!1),f=null);g=null;y.body.offmouseover(n);y.body.offmouseout(x)};b.setTouchCapture=function(a,c,d,e){b.releaseTouchCapture();"function"===typeof a&&(y.listen("touchmove",W,{capture:!0,passive:!1}),t=a);"function"===typeof c&&(y.listen("touchend",E,{capture:!0,passive:!1}),v=c);"function"===typeof d&&(y.listen("touchcancel",ba,{capture:!0,passive:!1}),q=d);p=e};var W=function(a){t&&t.call(p,a)},E=function(a){v&&v.call(p,a)},ba=function(a){q&&q.call(p,a)};b.releaseTouchCapture=
function(){t&&(y.unlisten("touchmove",W,!1),t=null);p=q=v=null};var Ca=function(a){if(c){var b=u.viewNode.mousePos(a);T.extendRectSelection(b.x,b.y,a);return!1}return!0},ma=function(b){if(a){var c=u.viewNode.mousePos(b);T.extendTextSelection(c.x,c.y,b);return!1}return!0};b.isViewEventTarget=function(a){for(var b=u.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName||"VIDEO"===a.tagName||"AUDIO"==a.tagName)break;if("oit-em_allheaders"===a.id)break;if(y.hasClass(a,"oit-emheadervalues")||
y.hasClass(a,"oit-em_allheaders")||y.hasClass(a,"oit-note-icons")||y.hasClass(a,"oit-ssoverlay"))return!0;if(y.hasClass(a,"oit-button")||y.hasClass(a,"oit-note")||y.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};var qa=function(a){var b;if(void 0!==a.buttons)b=a.buttons;else switch(a.button){case 0:b=1;break;case 1:b=4;break;case 2:b=2;break;case 3:b=8;break;case 4:b=16}return b},Ga=function(a){"text"===T.selectionType()&&T.select(null);z.deactivateAnnotation();var b=a.center;P.activateNearest(b.x,
b.y,a.srcEvent)},ka=function(b){e=!1;if(!u.editingComment){var d=b.center;u.viewNode.focus();e=!0;var n=w.selectionMode;"rect"===n||"cell"===n?(c=!0,T.startRectSelection(d.x,d.y)):"text"==n&&T.startTextSelection(d.x,d.y,"word",b)&&(a=!0)}},pa=function(b){var d;if(c||a)c?(c=!1,d=b.center,T.endRectSelection(d.x,d.y,b.srcEvent)):a&&(a=!1,d=b.center,T.endTextSelection(d.x,d.y,b.srcEvent))},ya=function(a){a.press||(a=u.viewNode,R=a.scroll(),h=G=0,B=a.scrollWidth-a.clientWidth,V=a.scrollHeight-a.clientHeight,
J.startElasticScroll())},Sa=function(b){if(b.press)c?(b=b.center,T.extendRectSelection(b.x,b.y)):a&&(b=b.center,T.extendTextSelection(b.x,b.y));else if(R){var d=u.viewNode,e=b.delta,n=R.left-e.x,e=R.top-e.y,f=ca(n,0,B),x=ca(e,0,V);d.autoscroll(f,x);b.kinetic||(G=n-f,h=e-x,(G||h)&&J.elasticScroll(G,h))}},Ha=function(a){a.press||(R=void 0,J.endElasticScroll(G,h),h=G=0)},Q=function(a){C=w.zoom;b.on.beginpinchzoom.dispatch()},S=function(a){C&&D.zoom(C*a.scale,a.center,!0)},Db=function(a){C=void 0;b.on.endpinchzoom.dispatch()},
Eb=function(a){M=w.rotation},Ka=function(a){if(void 0!==M){var b=M;a=ac(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);D.rotate(b)}},qb=function(a){M=void 0}}}),fa=za.extend("content",{events:{data:{},add:{},first:{},last:{}},install:function(b){var e=!1,d=!0,c=!1,a=[],f=[],g,k,t=0,v=!1,q=!1,p=!0,m=null,l=[],K=function(b){b&&(f.push({data:b}),e&&!k&&(k=da(h,0)),(b=a.shift())&&b.destroy())},F=function(a){a={url:a,cache:!0,startTime:Date.now(),pendingText:""};a.ajax=Ma({url:a.url,
cache:a.cache,complete:C,args:[a]});f.push(a)};b.isPending=function(){return 0<f.length||0<l.length||!u.documentComplete};b.manifest=function(){return m};b.initializeContent=function(a,b,c){OIT.content&&(K(OIT.content),delete OIT.content);c?(u.singlePageIndex=Number(c),b&&u.dynamicContent&&H(b)):b?(u.dynamicContent=!0,H(b)):a&&"none"!==a&&(u.dynamicContent=!0,R(a));e=!0;0<f.length&&!k&&(k=da(h,0))};var N=function(a){if(!g&&a){if((void 0===w.outputBaseUrl||null===w.outputBaseUrl||""===w.outputBaseUrl)&&
w.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var b=u.URL.lastIndexOf("/");if(-1!=b){b=u.URL.substr(0,b+1);if(0===b.search(/http/i)){var c=Y.createElement("a");c.href=b;b=c.pathname||c.pathName;"/"!=b[0]&&(b="/"+b)}0!==a.indexOf(b)&&(u.baseURL=b||null)}}g=u.baseURL}return g},H=function(b){if(b){var c=N(b);c&&"/"!=b.charAt(0)&&(b=Ra(c,b));0===u.URL.indexOf("file://")?(c=y.create("script"),c.attr("src",b),y.head.append(c),a.push(c)):F(b)}},R=function(a){if(a&&"none"!==a){var b=N(a);b&&"/"!=a.charAt(0)&&
(a=Ra(b,a));F(a)}},C=function(a,c,e,g,h){h.status=g;404===g&&(e="");200===g||404==g?404==g||0===e.length||0===e.indexOf("%")?(e!==h.pendingText&&(h.pendingText=e,h.startTime=Date.now()),Date.now()-h.startTime>w.contentTimeout?(oa.showLoadingSkeleton(),b.logAJAXError(null,"Timed out while loading the document content data from the server",a,Zb),lb(),f=[]):(d&&oa.showLoadingSkeleton(),h.cache=!1,da(function(){h.ajax=Ma({url:h.url,cache:h.cache,complete:C,args:[h]})},200))):M(h,e):(oa.showLoadingSkeleton(),
b.logAJAXError(null,"Failed to load the document content data from the server",a,g,e),lb(),f=[])};b.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};var M=function(a,c){var d,e=c.indexOf("else OIT.content={");-1!=e?(e+=18,d=c.lastIndexOf("}"),-1!=d&&(c="{"+c.substring(e,d)+"}")):b.isICD(c)&&(e=31,d=c.lastIndexOf(");"),-1!=d&&(c=c.substring(e,d)));try{var f=JSON.parse(c);a.data=f;k||(k=da(h,0))}catch(na){b.logAJAXError(null,"Document data is corrupt ("+na+")",a.url,a.status,
c)}},G=function(a){Ma({url:a,complete:function(a,c,d,e){if(200==e)try{if(m=JSON.parse(d),p){var f=m.files?m.files.content:null;if(f){for(c=1;c<f.length;c++)l.push(f[c].url);h()}}}catch(L){b.logAJAXError(null,"The document manifest is corrupt ("+L+")",a,e,d),p=q=!1,m=null}else b.logAJAXError(null,"Failed to load the document manifest from the server",a,e,d),p=q=!1,m=null}})},h=function(){k=void 0;if(e&&!v&&0<f.length&&f[0].data){for(var a=d;0<f.length&&f[0].data;){var g=f.shift();if(!q&&g.data.info&&
g.data.info.manifest&&u.dynamicContent){var h=g.data.info.manifest,m=N(h);m&&"/"!=h.charAt(0)&&(h=Ra(m,h));G(h);q=!0}B(g.data);d=!1;void 0===u.singlePageIndex?g.data.nextContent?q||(p=!1,H(g.data.nextContent)):g.data.nextData?q||(p=!1,R(g.data.nextData)):c=!0:c=!0}a&&b.on.first.dispatch();b.on.add.dispatch();c&&b.on.last.dispatch()}for(;20>f.length&&0<l.length;)R(l.shift())},B=function(a){if(a){if(a.info&&a.info.version){var c=a.info.version.split("."),e=parseInt(c[0],10),f=parseInt(c[1],10),c=parseInt(c[2],
10);0<e&&0<=f&&9>=f&&0<=c&&9>=c&&(t=e+f/10+c/100)}b.on.data.dispatch(a,d,t)}};b.processICD=function(a,c,d){if(b.isICD(a)){var e=a.lastIndexOf(");");if(-1!=e){a=a.substring(31,e);try{a=JSON.parse(a),B(a)}catch(ea){b.logAJAXError(null,"ICD data is corrupt ("+ea+")",c,d,a)}}}};D.onreset(function(){k&&ra(k);oa.showLoadingSkeleton();e=!1;d=!0;c=!1;a=[];f=[];k=g=void 0;t=0;q=v=!1;p=!0;m=null;l=[];u.singlePageIndex=void 0;b.on.add.reset()});ab.onbeginscroll(function(){v=!0});ab.onendscroll(function(){v=
!1;h()});pb("icd",K)}}),D=za.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),events:{load:{pub:!0,detail:function(){return{url:u.URL}},onAdd:function(b,e){u.documentLoaded&&da(function(){b.dispatchTo(e)},
0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(b,e,d){return{zoom:b,mode:e}}},rotate:{pub:!0,detail:function(b){return{angle:b}}},resize:{},idle:{pub:!0,onListen:function(){D.resetIdleTimer()},onUnlisten:function(){D.resetIdleTimer()},onAdd:function(){D.resetIdleTimer()},onRemove:function(){D.resetIdleTimer()}},error:{pub:!0,detail:function(b,e){return{message:b,fatal:!!e}}},select:{pub:!0,detail:function(b,e,d,c,a){b={selection:b,empty:c};e&&d&&(b.start=e,b.end=d);void 0!==a&&(b.highlightid=
a);return b}},scroll:{pub:!0,detail:function(b,e,d,c){e=u.viewNode;b=z.mapToPage(0,0);e=z.mapToPage(e.clientWidth,e.clientHeight);return b&&e?{viewUpperLeft:{pageIndex:b.page.index,x:b.x,y:b.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(b){return{srcEvent:b}}},optionschanged:{pub:!0,detail:function(b){return b}},showmessage:{pub:!0,detail:function(b,e,d){return{message:b||
"",modal:e||!1,progress:d||!1}}},progress:{pub:!0,detail:function(b){return{percentDone:b||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(b,e){var d={},c,a;for(a=0;a<e.length;a++)c=e[a],c.supported&&b[c.name]&&(w[c.option]!==c.optionValue?(d.supportedNotVisible||(d.supportedNotVisible=[]),d.supportedNotVisible.push(S[c.message])):(d.supportedVisible||(d.supportedVisible=[]),d.supportedVisible.push(S[c.message])));for(a=0;a<e.length;a++)c=e[a],!c.supported&&b[c.name]&&
(d.unsupported||(d.unsupported=[]),d.unsupported.push(S[c.message]));return d}},ajax:{pub:!0,single:!0,detail:function(b){return{request:b}}},ajaxabort:{pub:!0,single:!0,detail:function(b){return{request:b}}},highlight:{pub:!0,detail:function(b,e,d,c){return{highlights:b,searchTerm:e,style:d,properties:c}}}},install:function(b){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],d=e[0],c=e[e.length-1],a=["rows","columns","all","none"],f=[{name:"hidden-pages",supported:!0,message:"HIDDEN_CONTENT_PAGES",
option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",option:"showAnnotations",optionValue:!0},{name:"tracked-changes",supported:!0,
message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,message:"HIDDEN_CONTENT_TEXT"},{name:"tracked-changes-unsupported",supported:!1,
message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],g=!1,k,t,v,q=!1,p=0,m,l,K={},F={},N,H,R,C={},M,G=[],h={},B,V=!1,I,r=0,A,ea=[],na=[],L=[];b.properties=function(){if(u.documentLoaded)return Wa(K)};b.externalValue=function(a){if(u.documentLoaded)return F[a]};b.externalData=function(){if(u.documentLoaded)return F};b.revisions=function(){return A};b.getOptions=function(a){if(void 0===a){a=w.items();var b={},c;for(c in a)w.isPublic(c)&&
(b[c]=w[c]);b.showSlideComments=b.showAnnotations;return b}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),w.isPublic(a)))return w[a]};b.setOptions=function(a){if(a){for(var b in a){"showSlideComments"===b&&(b="showAnnotations");var c=a[b];w.isPublic(b)&&w[b]!=c&&("disableLoadingSkeleton"===b&&!0===c&&oa.hideLoadingSkeleton(),w[b]=c)}Lb()}};ab.onbeginpinchzoom(function(a,b){g=!0});ab.onendpinchzoom(function(){g=!1;b.dispatchPageEvents(!0);hb()});var X=function(a){a<d?a=d:
a>c&&(a=c);return a};b.zoom=function(a,c,d){if("number"===typeof a){var e=X(a);e!=a&&(d||b.invalidArg("zoom","zoom",a,"using fallback zoom factor "+e,!1),a=e);if(w.zoomMode||a!=w.zoom)w.zoom=a,w.zoomMode=null,b.dispatchPageEvents(!1,c)}else"string"===typeof a?a!=w.zoomMode&&(w.zoomMode=a,b.dispatchPageEvents(!1,c)):"undefined"===typeof a||d||b.invalidArg("zoom","zoom",a);return w.zoom};b.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>w.zoom){b.zoom(e[a]);break}return w.zoom};b.zoomOut=function(){for(var a=
e.length-1;0<=a;a--)if(e[a]<w.zoom){b.zoom(e[a]);break}return w.zoom};b.rotate=function(a){"number"===typeof a?w.rotation=ac(a,"deg"):void 0!==a&&b.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return w.rotation};b.showHidden=function(c){u.documentLoaded&&!u.documentUnloading&&J.features().showhidden&&(void 0!==c&&-1==a.indexOf(c)?b.invalidArg("showHidden","mode",c,"Must be one of "+JSON.stringify(a)):J.showHidden(c))};var n=[{name:"searchTerm",type:["string","RegExp"],
req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];b.find=function(a,c,d,e,f){if(u.documentLoaded&&!u.documentUnloading){var x=b.processArguments("find",arguments,n);x&&da(Ga,0,{finder:ja.findStart(x.searchType,x.searchTerm,x.caseSensitive,x.direction,
f),callbackFn:x.callbackFn})}};var x=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"searchType",type:"string",legal:"string dtsearch lucene phsterms literal literal*".split(" "),def:"string"}];b.findAll=function(a,c,d){if(u.documentLoaded&&!u.documentUnloading){var e=b.processArguments("findAll",arguments,x);e&&b.findAllArgs(e)}};b.findAllArgs=function(a){u.documentLoaded&&!u.documentUnloading&&a&&
b.on.idle.listenOnce({finder:ja.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(c){var d=!0;if(!c){if(a.callbackFn)try{a.callbackFn.call(null)}catch(Cb){b.logError("findAll","Exception in callback function: "+Cb)}d=!1}else if(a.callbackFn)try{var e=ja.getRawText(c.range.acc,c.range.accend),d=a.callbackFn.call(null,c.range,e)}catch(Cb){b.logError("findAll","Exception in callback function: "+Cb),d=!1}!1!==d&&(d=!0);return d},startIterationFn:null,endIterationFn:null},ka)};b.getRawText=
function(a){u.documentLoaded&&(Fa(a)?da(pa,0,{callbackFn:a,textBlockIndex:0}):b.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var W=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];b.highlight=function(a,c,d,
e,n){if(u.documentLoaded)if(!1===ja.hasRawText())b.logError("highlight","Search functionality has been disabled for this document");else if(P)if(!1===J.features().highlights)b.logError("highlight","Highlighting functionality is not available for this document type");else{var f;"object"===typeof c?(f=c,f={searchTerm:a,style:f.style,searchType:f.mode||"string",properties:f.properties,callbackFn:f.callbackFn,caseSensitive:!1!==f.caseSensitive,visible:!1!==f.visible,enableUserDelete:!1!==f.enableUserDelete,
enableUserMove:!1!==f.enableUserMove,enableUserResize:!1!==f.enableUserResize,enableUserComment:!1!==f.enableUserComment,stemAll:!0===f.stemAll,stemmer:f.stemmer}):f=b.processArguments("highlight",arguments,W);f&&(5>na.length?b.highlightArgs(f):ea.push(f))}else b.logError("highlight","Highlighting functionality has been disabled for this document")};b.highlightArgs=function(a){u.documentLoaded&&a&&(na.push(a),a.batchStarted=!1,a.highlights=[],a.complete=!1,a.iteration=0,O.performance&&"function"===
typeof performance.now&&(a.startTime=performance.now()),b.on.idle.listenOnce({finder:ja.findStart(a.searchType,a.searchTerm,a.caseSensitive,"down",void 0,a.stemAll,a.stemmer),callbackFn:function(c){var d=!0;if(!c||a.aborted){d=["Highlight term '",a.searchTerm,"': ",a.highlights.length," hits, "];O.performance&&"function"===typeof performance.now&&(c=Q(performance.now()-a.startTime,10),d.push(c,"ms, "));d.push("searchType='",a.searchType,"', stemAll=",a.stemAll,", stemmer=",a.stemmer,", style='",a.style,
"', caseSensitive=",a.caseSensitive,", visible=",a.visible,", terms remaining="+(ea.length+na.length-1));if(a.aborted)d.push(" [ABORTED]"),console.warn(d.join(""));else if(console.log(d.join("")),a.callbackFn)try{a.callbackFn.call(null,null,null,a.highlights,a.searchTerm,a.style,a.properties)}catch(mc){b.logError("findAll","Exception in callback function: "+mc)}d=!1}else{var e;if(c.terms){e=[];for(var n=0;n<c.terms.length;n++)e.push(c.terms[n].range);e=P.add(a.style,e,a.properties)}else e=P.add(a.style,
c.range,a.properties);if(void 0!==e)for(Array.isArray(e)||(e=[e]),n=0;n<e.length;n++){var f=e[n];if(-1==a.highlights.indexOf(f)){a.highlights.push(f);!1===a.visible&&P.hide(f);if(!1===a.enableUserDelete||!1===a.enableUserMove||!1===a.enableUserResize||!1===a.enableUserComment){var x={};!1===a.enableUserDelete&&(x.enableUserDelete=!1);!1===a.enableUserMove&&(x.enableUserMove=!1);!1===a.enableUserResize&&(x.enableUserResize=!1);!1===a.enableUserComment&&(x.enableUserComment=!1);P.setOptions(f,x)}if(a.callbackFn)try{var g=
ja.getRawText(c.range.acc,c.range.accend),d=a.callbackFn.call(null,c.range,f,a.highlights,a.searchTerm,a.style,a.properties,g)}catch(mc){b.logError("findAll","Exception in callback function: "+mc),d=!1}}}}!1!==d&&(d=!0);d||(a.batchStarted&&P.endBatch(),a.complete=!0,a.aborted||b.on.highlight.dispatch(a.highlights,a.searchTerm,a.style,a.properties),c=na.indexOf(a),-1!=c&&na.splice(c,1),5>na.length&&0<ea.length&&(a=ea.shift(),b.highlightArgs(a)));return d},startIterationFn:function(b){J.suspendUpdate();
a.iteration++},endIterationFn:function(){!a.complete&&!a.batchStarted&&2<=a.iteration&&(P.beginBatch(),a.batchStarted=!0);J.resumeUpdate()}},ka))};b.select=function(a,c){if(u.documentLoaded){var d=!1;if(!1===ja.hasRawText())b.logError("select","Javascript selection functionality has been disabled for this document");else if(null===a)d=T.select(null);else if(Aa(a)||Ja(a))d=T.select(a);else{var e=wa(a,!0,!0);e?(d=b.selection(),d=0!==Xa(e,d),!1!==c?z.movetoEx(e,{callbackFn:function(){T.select(e)},animate:!1}):
T.select(e)):b.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return d}};b.selectionType=function(){if(u.documentLoaded)return T.selectionType()};b.selectionMode=function(a){a&&(w.selectionMode=a);return w.selectionMode};b.selectionStyle=function(a){var c;void 0!==a&&null!==a&&"string"!==typeof a?b.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):c=T.style(a);return c};b.selection=function(){var a;if(u.documentLoaded)switch(T.selectionType()){case "text":a=
T.textSelection();break;case "cell":a=T.cellSelection();break;case "rect":a=T.rectSelection()}return a};b.textSelection=function(){if(u.documentLoaded)return T.textSelection()};b.cellSelection=function(){if(u.documentLoaded)return T.cellSelection()};b.rectSelection=function(){if(u.documentLoaded)return T.rectSelection()};b.getSelectedText=function(){if(u.documentLoaded)return J.getSelectedText()};b.textRange=function(){return sa.apply(this,arguments)};b.cellRange=function(){return ta.apply(this,arguments)};
b.rectRange=function(){return Gb.apply(this,arguments)};b.updateViewSize=function(){la.dispatchResize()};var E=function(){if(J.features().fitpage){var a=90==w.rotation||270==w.rotation,b,c=J.padding();b=J.margin();var d=c.left+c.right+b.left+b.right,c=c.top+c.bottom+b.top+b.bottom;a?(a=J.maxPageHeight(),b=J.maxPageWidth()):(a=J.maxPageWidth(),b=J.maxPageHeight());var a=a+z.annotationPaneWidth(),e=u.viewNode;return{w:X((e.clientWidth-d)/a),h:X((e.clientHeight-c)/b)}}};b.dispatchPageEvents=function(a,
c){!1!==a&&(a=!0);if(u.documentLoaded&&!V){var d;if(w.zoomMode){var e=1;if(d=E()){switch(w.zoomMode){case "page":e=Math.min(d.w,d.h);break;case "pagewidth":e=d.w;break;case "pageheight":e=d.h;break;case "mobile":switch(u.deType){case "page":e=d.h<d.w&&d.h>=.9*d.w?d.h:d.w;break;case "drawing":e=(e=la.infoRaw())&&1557===e.fi?d.w:Math.min(d.w,d.h);break;case "slide":case "chart":case "bitmap":e=Math.min(d.w,d.h)}}e=X(e)}w.zoom=e}else if(u.nochrome||u.isMobile)if(d=E())d=Math.min(d.w,d.h),w.zoom<d&&(w.zoom=
d);d=w.zoom;var e=N!=d||H!=w.zoomMode,n=R!=w.rotation;if(a||e||n)J.layoutChanged(c),la.invalidateCanvas(),u.drawing&&u.drawing.update(!0);if(a||e)N=d,H=w.zoomMode,b.on.zoom.dispatch(d,w.zoomMode,g);if(a||n)R=w.rotation,b.on.rotate.dispatch(w.rotation);la.dispatchScroll(a)}};var ba=function(){b.dispatchPageEvents(!0)};b.pauseIdleTimer=function(a){p++;1==p&&b.resetIdleTimer()};b.resumeIdleTimer=function(a){0<p&&(p--,0===p&&b.resetIdleTimer())};b.resetIdleTimer=function(){var a;k&&(ra(k),k=null);t&&
(Ta(t),t=null);b.on.idle.hasListeners()&&u.documentLoaded&&!u.documentUnloading&&0===p?(q||(a=b.resetIdleTimer,y.listen("mousemove",a,!0),y.listen("touchmove",a,!0),y.listen("keydown",a,!0),b.onscroll(a),q=!0),k=da(function(){t=tb(function(){b.on.idle.dispatch(!1)},50,b.on.idle)},200),v||(v=tb(function(){b.on.idle.dispatch(!0)},200,b.on.idle))):(v&&(Ta(v),v=null),a=b.resetIdleTimer,y.unlisten("mousemove",a),y.unlisten("touchmove",a),y.unlisten("keydown",a),b.offscroll(a))};var Ca=function(){var a=
J.pageRect(z.count()-1,"overlay");a&&(a=a.bottom-20*(z.count()-1),b.printCSS(".oit-view-root","height:"+a+"px;"));for(;void 0!==r;)if(z.on.change.disable(),a=z.page(r))if(a.overlay&&!a.overlay.isHidden()){a.load(!0,ma);r=void 0;break}else r++;else{if(!u.documentComplete)break;b.logFatalError(null,"No visible pages were found in the document");r=void 0;break}},ma=function(a){oa.hideLoadingSkeleton(function(){z.moveto(a.index);u.documentLoaded=!0;b.on.load.dispatch();u.documentLoading=!1;z.on.change.enable();
z.dispatchChange(void 0,!0);b.dispatchPageEvents(!0);u.documentComplete&&b.on.done.dispatch();b.resetIdleTimer()})},qa=/\sdata-json="([^"]*)"/;b.installDocument=function(a,c){var d=!0,e=null,n=qa.exec(c);n&&(e=n[1]);if(e&&"none"!=e){if(wc(a)){var n=Y.URL,f=n.indexOf("//");if(-1===f)u.URL=a;else{var f=f+2,x=n.lastIndexOf("/"),n=-1!=x&&x>f?n.substr(0,x+1):n+"/";"/"===a[0]&&(f=n.indexOf("/",f)+1,n=n.substr(0,f));u.URL=Ra(n,a)}}else u.URL=a;fa.initializeContent(e);b.initializeDocument()}else d="This document can't be loaded into the web view.",
la.logFatalError("load","none"==e?d+" \nThe html file must be created in Ajax mode.":d+" \nThe html file does not appear to have been created by Web View Export.",c),d=!1;return d};b.unload=function(){var a=u.documentLoaded;u.documentUnloading=!0;J.suspendUpdate();b.resetIdleTimer();try{J.unloadDisplay()}catch(Ka){b.logError("unload","Error while unloading display ("+Ka+")")}u.documentLoaded=!1;u.documentComplete=!1;u.hasHiddenText=!1;u.hasWorksheetRevisions=!1;try{T.reset()}catch(Ka){b.logError("unload",
"Error while resetting selection ("+Ka+")")}try{P.clear()}catch(Ka){b.logError("unload","Error while clearing highlights ("+Ka+")")}try{gc()}catch(Ka){b.logError("unload","Error while aborting timers ("+Ka+")")}try{lb()}catch(Ka){b.logError("unload","Error while aborting AJAX requests ("+Ka+")")}try{b.on.reset.dispatch()}catch(Ka){b.logError("unload","Error while resetting view ("+Ka+")")}a&&b.on.unload.dispatch();w.zoom=1;w.zoomMode=null;g=!1;r=0;k&&(Ta(k),k=null);t&&(Ta(t),t=null);v&&(Ta(v),v=null);
p=0;K={};F={};G=[];u.documentLoading=!1;h={};V=!1;A=null;for(a=0;a<L.length;a++){var c=L[a];b.on.idle.unlisten(c,ka);fa.offadd(c,ka);ja.offadd(c,ka)}L=[];for(a=0;a<ea.length;a++)ea[a].aborted=!0;ea=[];for(a=0;a<na.length;a++)na[a].aborted=!0;na=[];B&&(B.destroy(),B=null);I&&(I.destroy(),I=null);u.drawing&&(u.drawing.destroy(),u.drawing=void 0);m&&(m.destroy(),m=void 0);l&&(l.destroy(),l=void 0);oa.isLoadingSkeletonShown()||((a=u.viewNode)&&a.html(""),oa.showLoadingSkeleton());u.URL=Y.URL;fa.onadd(Ca);
u.documentUnloading=!1;J.resumeUpdate()};b.initializeDocument=function(){u.viewNode&&(u.drawing=new dd(u.viewNode),l=new vb("screen"),0<z.count()&&b.updateViewSize())};b.screenCSS=function(a,b){if(l)if(null===b)l.deleteRule(a);else if("string"==typeof b)l.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var c=a+"{",d;for(d in b)c+=d+":"+b[d]+";";l.setRule(c+"}",a)}};b.printCSS=function(a,b){m||(m=new vb("print"));if(null===b)m.deleteRule(a);else if("string"==typeof b)m.setRule(a+"{"+b+"}",a);else if("object"==
typeof b){var c=a+"{",d;for(d in b)c+=d+":"+b[d]+";";m.setRule(c+"}",a)}};var Ga=function(){var a=ja.findNext(this.finder);if(a||!fa.isPending()&&!ja.isPending()){if(a){var b=ja.getRawText(a.range.acc,a.range.accend);this.callbackFn.call(null,a.range,b)}else this.callbackFn.call(null);fa.offadd(Ga);ja.offadd(Ga)}else fa.onadd(this,Ga),ja.onadd(this,Ga)},ka=function(){var a=!0,c=!1,d=L.indexOf(this);-1!=d&&L.splice(d,1);if(!this.aborted){this.curACC||(this.curACC=0);this.startIterationFn&&(d=100*this.curACC/
ja.lastACC(),this.startIterationFn(d));var e;O.performance&&(e=O.performance.now());for(d=0;;d++){var n=ja.findNext(this.finder);if(n){if(this.curACC=n.range.acc,!1===this.callbackFn.call(null,n)){a=!1;c=!0;break}}else{fa.isPending()||ja.isPending()||(this.callbackFn.call(null),c=!0);a=!1;break}if(20<=d)if(void 0!==e){if(0===d%20&&50<O.performance.now()-e)break}else if(100<=d)break}if(a)b.on.idle.listenOnce(this,ka),L.push(this);else if(c)fa.offadd(this,ka),ja.offadd(this,ka),this.aborted=!0;else if(fa.isPending()||
ja.isPending())fa.onadd(this,ka),ja.onadd(this,ka),L.push(this);this.endIterationFn&&this.endIterationFn()}},pa=function(){for(var a=!0,b=!1,c=0;10>c;c++){var d=ja.getRawTextBlock(this.textBlockIndex);if(d)if(d.text){var e=d.text,n=d.range.acc;if(void 0!==this.acc){var f=this.acc-d.range.acc;0<f&&(e=e.substring(f),n+=f)}this.acc=d.range.accend;if(!1===this.callbackFn.call(null,e,n)){a=!1;b=!0;break}this.textBlockIndex++}else{a=!1;break}else{fa.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}a?
da(pa,50,this):b?(fa.offadd(pa),ja.offadd(pa)):(fa.onadd(this,pa),ja.onadd(this,pa))};b.removeExtraEmailHeaders=function(){w.removeExtraEmailHeaders=!0};b.externalLinks=function(){return G};var ya=function(a,c){V=!0;b.setOptions({showHiddenSheets:c,showHiddenColumns:c,showHiddenRows:c,showAnnotations:c,showSlideNotes:c,presentationMode:c?"normal":"slideshow"});V=!1;z.updateShowSlideNotes();b.dispatchPageEvents(!0);D();B.collapse();return!1};b.supressHiddenContentUpdate=function(){return V};var D=
function(){var a,b;if("none"===w.showHiddenContentNotification)B&&B.css("display","none");else if(!u.staging&&B&&!V){var c=[],d=!1,e=!1;for(b=0;b<f.length;b++)a=f[b],a.supported&&h[a.name]&&(c.push("<li>",S[a.message],"</li>"),w[a.option]!==a.optionValue?d=!0:e=!0);var n=[];0<c.length&&(n.push(S.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(n,c),n.push("</ul>"),d?n.push(S.HIDDEN_CONTENT_INVISIBLE,'</div><div><a class="oit-showhiddenlink">',S.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):
n.push(S.HIDDEN_CONTENT_ALREADY_VISIBLE,'</div><div><a class="oit-hidehiddenlink">',S.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var c=[],x=!1;for(b=0;b<f.length;b++)a=f[b],!a.supported&&h[a.name]&&(c.push("<li>",S[a.message],"</li>"),x=!0);0<c.length&&(0<n.length&&n.push("<div>&nbsp;</div>"),n.push(S.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(n,c),n.push("</ul></div>"));n=n.join("");B.message(n);B.css("display",null);d||x?e?B.title(S.HIDDEN_CONTENT_PARTIAL):B.title(S.HIDDEN_CONTENT_HIDDEN):
B.title(S.HIDDEN_CONTENT_VISIBLE);"expanded"===w.showHiddenContentNotification?B.expand(!1):B.collapse(!1);if(d){if(a=B.byClass("oit-showhiddenlink"))a[0].onclick(null,ya,!0),a[0].ontap(null,ya,!0)}else if(a=B.byClass("oit-hidehiddenlink"))a[0].onclick(null,ya,!1),a[0].ontap(null,ya,!1)}w.showAnnotations?u.viewNode.addClass("oit-showannotations"):u.viewNode.removeClass("oit-showannotations")};b.hiddenContent=function(a){h[a]||(h[a]=!0,B||(B=new Ob({title:S.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),
B.onexpand(function(){w.showHiddenContentNotification="expanded"}),B.oncollapse(function(){w.showHiddenContentNotification="collapsed"})),D(),b.on.hiddencontent.dispatch(h,f))};b.documentException=function(a){};b.showNotifications=function(){D()};var Ha=function(a,b,c){C[c]=a;M||(M=da(Lb,50))},Lb=function(){if(M){var a=C;C={};ra(M);M=void 0;b.on.optionschanged.dispatch(a)}};b.print=function(){O.print()};fa.onadd(Ca);fa.ondata(function(a,c,d){var e;if(a.properties)for(e in a.properties)K[e]=a.properties[e];
if(a.external)for(e in a.external)F[e]=a.external[e];if(a.options){for(var n in a.options)if(c=a.options[n],d=n.indexOf("."),0<d){var f=n.substring(0,d);n=n.substring(d+1);if("glob"==f||"opt"==f)d="glob"==f?u:w,d.hasOwnProperty(n)&&(d[n]=c)}u.hasHiddenText&&b.hiddenContent("hidden-text-unsupported");u.hasWorksheetRevisions&&b.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(e in a.info.status)a.info.status[e]&&b.documentException(e);a.xlinks&&(G=G.concat(a.xlinks));a.revisions&&
(A=A?A.concat(a.revisions):a.revisions.slice(0))});fa.onlast(function(){if(A){for(var a=!1,c=!1,d=!1,e=!1,n=0;n<A.length;n++){var f=A[n],x=!0;c&&e||"add"!==f.type&&"delete"!==f.type&&"move"!==f.type?a&&d||"hidden"!=f.type||(x=!1):x=!1;if(!x){var g;f.range&&(g=z.forRange(f.range),g||(x=z.lastPage(),f.range.acc>x.accend&&(g=x)));g&&"page"===g.type?"add"===f.type||"delete"===f.type||"move"===f.type?c=!0:"hidden"===f.type&&(a=!0):"add"===f.type||"delete"===f.type||"move"===f.type?e=!0:"hidden"===f.type&&
(d=!0)}}a&&b.hiddenContent("hidden-text");c&&b.hiddenContent("tracked-changes");d&&b.hiddenContent("hidden-text-unsupported");e&&b.hiddenContent("tracked-changes-unsupported")}u.documentComplete=!0;u.documentLoaded&&b.on.done.dispatch()});la.onresize(function(){u.editingComment?P.alignComment():b.dispatchPageEvents(!0)});z.onchange(function(){1!=z.activeOverlay().length&&"vertical"==w.scrollMode||b.dispatchPageEvents(!0)});w.oncenterPages(ba);w.onrotation(ba);w.onshowHiddenSheets(D);w.onshowHiddenColumns(D);
w.onshowHiddenRows(D);w.onshowAnnotations(D);w.onshowSlideNotes(D);w.onpresentationMode(D);w.onshowHiddenContentNotification(D);var ba=w.items(),U;for(U in ba)if(w.isPublic(U))w["on"+U](Ha)}}),z=za.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges isDocumentText".split(" "),events:{change:{pub:!0,detail:function(b){return z.info(b.index)}},add:{pub:!0,detail:function(b){return{startPage:b}}},pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},install:function(b){var e=
[],d=[],c=null,a=null,f=null,g=0,k=1,t,v,q,p=0,m=0,l=0,K,F,N,H={},R={},C,M;b.firstPage=function(){var a,b;for(b in d){a=d[b];break}return a};b.lastPage=function(){var a,b;for(b in d)a=d[b];return a};b.current=function(){return a?a.index:0};b.pageName=function(a){void 0===a&&(a=b.current());if(a=d[a])return a.name};b.count=function(){return d.length};b.each=function(a,b){mb(d,arguments)};b.eachOverlay=function(a,b){mb(e,arguments)};b.moveto=function(a,c){var d;Fa(c)&&(d={callbackFn:c});return b.movetoEx(a,
d)};var G=function(c){b.updateActivePage(c.pageIndex);c.callbackFn&&c.callbackFn.call(null,a.index)};b.movetoEx=function(c,d){d=d||{};u.viewNode.cancelKinetic();if("number"===typeof c)return d.pageIndex=c,B(d);if("object"===typeof c){if(y.isElement(c)||y.isText(c)){d.gotoNode=c;var e=d,n=b.forNode(e.gotoNode);n?(e.pageIndex=r(n.index),e.pageIndex!=n.index&&(e.gotoNode=null),B(e)):(b.logError("moveto","The specified node was not found on any page in the document."),G(e));return a.index}if(e=wa(c))return d.range=
ha(e),V(d);if("number"===typeof c.left&&"number"===typeof c.top&&"number"===typeof c.right&&"number"===typeof c.bottom)return d.rect=c,I(d)}b.logError("moveto","Invalid destination: "+Ib(c));return a.index};var h=function(a,d){var e=a.overlay,n=e!==c;if(!d&&!n)return!1;if(n){P.deactivate();T.select(null);J.unloadDisplay();var f=c,x=u.viewNode;f&&(f.saveScroll=x.scroll(),f.undisplay());e.display()}a.load(!1,function(){c=e;b.updateActivePage(a.index);n&&J.loadDisplay(a)});e.show();e.hasClass("oit-pagestream")?
u.viewNode.addClass("oit-pagestream"):u.viewNode.removeClass("oit-pagestream");e.hasClass("oit-emailfill")?u.viewNode.addClass("oit-emailfill"):u.viewNode.removeClass("oit-emailfill");f=a.css("background")||null;u.viewNode.css("background",f);e.saveScroll?(x.scroll(e.saveScroll),delete e.saveScroll):n&&x.scroll(0,0);e.display();b.updateActivePage();return!0},B=function(e){var n=e.pageIndex;if(d[n])if(e.force||e.gotoNode||!a||n!=a.index){var f=d[n];f.overlay.isHidden()&&(fx.opt.showHidden(!0),fx.isOITLoaded()&&
OIT.document.setOptions({showHiddenSheets:!0,showHiddenColumns:!0,showHiddenRows:!0,showAnnotations:!0,showSlideNotes:!0,presentationMode:"normal"}));b.touchPage(n);if(f.isLoaded()){n=h(f,e.force);"sn"==f.type&&(w.showSlideNotes=!0);if("vertical"!=w.scrollMode||n)e.animate=!1;b.updateActivePage(f.index);"email"!==f.type&&J.moveto(a.index,G,e)||G(e)}else f.load(!0,function(){e.force=!0;B(e)}),"email"!==f.type&&f.overlay===c?J.moveto(f.index,null,{animate:!1}):c||h(f)}else e.pageIndex=a.index,G(e);
else 0<=n&&fa.isPending()?fa.on.add.listenOnce(function(){B(e)}):(b.logError("moveto","Invalid page index: "+n),void 0!==u.singlePageIndex&&(e.pageIndex=u.singlePageIndex),G(e));if(a)return a.index},V=function(c){if(u.documentLoading)da(V,0,null,c);else{var d=b.nearestForRange(c.range);if(d)if(d.isPending())h(d),d.load(!0,function(){V(c)});else if(!a||d.overlay!==a.overlay||"vertical"!=w.scrollMode&&d!==a)B({pageIndex:d.index,callbackFn:function(){V(c)}});else{if("sn"==d.type){w.showSlideNotes=!0;
var e=b.page(d.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(w.presentationMode="normal")}else"slide"==d.type&&d.hiddenFromSlideshow&&(w.presentationMode="normal");J.loadRange(c.range,function(){if(!J.moveto(c.range,G,c))if(b.inAnnotation(c.range)){var a=d.annotationPane();a&&a.activate(c.range,!0,!1,c.callbackFn)}else(a=J.rangeRect(c.range,"view"))?(c.rect=a,I(c)):(c.pageIndex=d.index,B(c))})}else fa.isPending()?fa.on.add.listenOnce(function(){V(c)}):(b.logError("moveto","The specified range was not found in the document: "+
Ib(c.range)),G(c))}return a.index},I=function(b){var c=b.rect,d=u.viewNode,e=d.scroll(),n=J.scrollPadding(),f=c.left+e.left,g=c.right+e.left,h=c.top+e.top,r=c.bottom+e.top,l=e.left,m=e.left+d.clientWidth,k=e.top,p=e.top+d.clientHeight;n&&(n.left&&(l+=n.left),n.right&&(m-=n.right),n.top&&(k+=n.top),n.bottom&&(p-=n.bottom));var c=e.left,F=e.top;!0===b.moveToTop?F=h:h<k?(r-=d.clientHeight,0>r&&(r=0),k=20,n&&n.top&&(k+=n.top),F=h-k,F<r&&(F=r)):r>p&&(k=20,n&&n.bottom&&(k+=n.bottom),F=r+k-d.clientHeight,
F>h&&(F=h));f<l?(g=f-d.clientWidth,0>g&&(g=0),k=20,n&&n.left&&(k+=n.left),c=f-k,c<g&&(c=g)):g>m&&(k=20,n&&n.right&&(k+=n.right),c=g+k-d.clientWidth,c>f&&(c=f));c!=e.left||F!=e.top?(D.on.scrollupdate.disable(),e=u.deType,e=!b.moveToTop&&"worksheet"!=e&&"database"!=e,b.animate||(e=!1),e=e?150:0,d.abortAnimation(),d.animate({scrollLeft:c,scrollTop:F,time:e,endFn:function(){D.on.scrollupdate.enable();D.on.scrollupdate.dispatch();G(b)}})):G(b);return a.index};b.movetoPrev=function(c){var d=b.prev();d?
b.moveto(d.index,c):c&&c.call(null,a.index);return a.index};b.movetoNext=function(c){var d=b.next();d?b.moveto(d.index,c):c&&c.call(null,a.index);return a.index};b.info=function(a){void 0===a&&(a=b.current());if(d[a])return d[a].info()};b.next=function(b,c){var e;void 0===b&&(b=a.index);var n=b+1;!1!==c&&d[n]&&"email"==d[b].type&&"rt"==d[n].type&&n++;if(d[n])for(;n<d.length;n++){var f=d[n];if(f&&f.isEnabled()&&!f.overlay.isHidden()&&("sn"!=f.type||w.showSlideNotes)){e=f;break}}return e};b.prev=function(b,
c){var e;void 0===b&&(b=a.index);var n=b-1;!1!==c&&d[n]&&d[n-1]&&"email"==d[n-1].type&&"rt"==d[n].type&&n--;if(d[n])for(;0<=n;n--){var f=d[n];if(f&&f.isEnabled()&&!f.overlay.isHidden()&&("sn"!=f.type||w.showSlideNotes)){e=f;break}}return e};var r=function(a){var b,c;for(c=a;c<d.length;c++)if((b=d[c])&&b.isEnabled()&&!b.overlay.isHidden())return c;for(c=a;0<c;c--)if((b=d[c])&&b.isEnabled()&&!b.overlay.isHidden())return c;return 0};b.loadNextPageFromServer=function(){var a,b;b=J.visiblePages();if(0===
b.length)return!1;var e=b[0].index,f=b[b.length-1].index;0>k?(e-=3,f+=1):f+=3;0>e&&(e=0);f>=d.length&&(f=d.length-1);if(0>k){if(void 0===t||t>f)t=f;for(;t>=e;t--)(b=d[t])&&b.overlay===c&&b.isPending()&&(b.load(!1),a=!0)}else{if(void 0===t||t<e)t=e;for(;t<=f;t++)(b=d[t])&&b.overlay===c&&b.isPending()&&(b.load(!1),a=!0)}return a};b.updateActivePage=function(d){if(c){var e=a,f=u.viewNode.scroll().top;void 0!==d?e=b.page(d)||a:1==c.length?e=c.firstPage:"vertical"==w.scrollMode&&void 0===u.singlePageIndex&&
f!=g&&(d=b.mapToPage(10,20,void 0,!0))&&(e=d.page);f!=g&&(k=f<g?-1:1,g=f);if(e!=a){a=e;c=a.overlay;e=J.visiblePages();for(f=0;f<e.length;f++)b.touchPage(e[f].index);b.dispatchChange(a)}}};b.page=function(a){return d[a]};b.byName=function(a){var b,c;for(c in d)if(d[c].name===a){b=d[c];break}return b};b.forNode=function(a){return y.wrap(a).ancestorData("page")};b.nearestForRange=function(a){var c,e,f,n=b.pagesForRange(a);if(!n&&"text"===a.type)for(e=0;e<d.length;e++)if((f=d[e])&&"drawing"===f.type&&
a.accend>=f.acc&&a.acc<=f.accend){n=[f];break}if(n)if(1==n.length)c=n[0];else if((e=J.visiblePages())&&0<e.length){var g=e[0].index,h=e[e.length-1].index,r;for(e=0;e<n.length;e++)if(f=n[e],f.isEnabled()){var l=f.index,m=0;l<g?m=g-l:l>h&&(m=l-h);!c||m<r?(c=f,r=m):0===m&&(l=J.rangeRect(a,"view"))&&0>l.bottom&&(c=f,r=m)}}return c};b.forRange=function(a,b,c){var e;if(a)switch(b=b||0,!0!==c&&(c=!1),a.type){case "text":for(;b<d.length;b++){var f=d[b];if(f&&a.accend>=f.acc&&a.acc<=f.accend&&(!0!==c||"worksheet"!==
f.type&&"database"!==f.type&&"email"!==f.type||f.isLoaded()||f.load(),f.containsRange(a))){e=f;break}}break;case "cell":case "rect":a.page>=b&&a.page<d.length&&(e=d[a.page])}return e};b.inAnnotation=function(a){var b=!1;if("text"==a.type)for(var c=0;c<d.length;c++){var e=d[c];if(e&&a.accend>=e.acc&&a.acc<=e.accend&&e.inAnnotation(a)){b=!0;break}}return b};b.pagesForRange=function(a,c){for(var e,f=0;f<d.length;){f=b.forRange(a,f,c);if(!f)break;e||(e=[]);e.push(f);f=f.index+1}return e};b.top=function(){var a=
J.visiblePages();if(a&&0<a.length)return a[0].index};b.bottom=function(){var a=J.visiblePages();if(a&&0<a.length)return a[a.length-1].index};b.mapToPage=function(e,f,g,h,r,l){var n;if(g)n=g.pageRect("view");else if(a){g=a;if(g.isHidden()||"sn"===g.type&&!w.showSlideNotes)(g=b.next(a.index))||(g=b.prev(a.index));var x=!0;!0!==h&&"email"==g.type&&(x=!1,0===g.index&&(g=2<=d.length?d[1]:null));g&&(n=g.pageRect("view"));if("vertical"==w.scrollMode&&void 0===u.singlePageIndex&&1<c.length)for(;n;)if(f<n.top){h=
b.prev(g.index,!1)||g;if(h===g||0===g.index||!x&&0===h.index)break;if(h.overlay!=g.overlay)break;var m=h.pageRect("view");if(f>m.bottom){n.top-f>f-m.bottom&&(g=h,n=m);break}g=h;n=m}else if(f>n.bottom){if(g.index==d.length-1)break;h=b.next(g.index,!1)||g;if(h===g||h.overlay!=g.overlay)break;m=h.pageRect("view");if(f<m.top){m.top-f<f-n.bottom&&(g=h,n=m);break}g=h;n=m}else break}x=!1;if(g){if(r&&(e>n.right||e>u.viewNode.clientWidth)&&g.annotationPane()){r=u.viewNode;m=r.pos(y.body);h=e+m.left;var m=
f+m.top,k=g.annotationPane().contentRect(y.body);k&&(h=h+r.scrollLeft-k.left,m=m+r.scrollTop-k.top,l||0<=h&&0<=m&&h<=k.width&&m<=k.height)&&(e=h,f=m,x=!0)}if(!x&&(n&&(e-=n.left,f-=n.top),J.features().zoom&&(n=w.zoom,1!=n&&(e=Q(e/n),f=Q(f/n))),J.features().rotate&&(l=w.rotation,0!==l)))switch(n=g.pageRect(),r=e,h=f,l){case 90:e=n.width-h;f=r;break;case 180:e=n.width-r;f=n.height-h;break;case 270:e=h,f=n.height-r}return{page:g,x:e,y:f,inAnnotation:x}}};b.elementRect=function(a,b){var c;c=new ia(a.rect(u.viewNode),
"view");c.origin=b;return c};b.findTextRange=function(b){if("text"===b.type){var e;if("vertical"!=w.scrollMode||void 0!==u.singlePageIndex)void 0!==a.acc&&b.acc<=a.accend&&b.accend>=a.acc&&(e=a.findTextRange(b));else for(var f in d){var n=d[f];if(n.overlay===c&&n.isLoaded()&&n.isEnabled()&&void 0!==n.acc&&b.acc<=n.accend&&b.accend>=n.acc&&(n=n.findTextRange(b)))if(e)for(var g=0;g<n.length;g++)e.push(n[g]);else e=n}return e}};var A=function(a,b,c){var d=!1;if(c)if(Array.isArray(c))for(var e=0;e<c.length&&
!(d=A(a,b,c[e]));e++);else c.range&&"text"===c.range.type&&a<=c.range.accend&&b>=c.range.acc&&(d=!0);return d};b.isAnnotationText=function(a,c,d){var e=!1;if(d)for(var f=0;!e&&f<d.length;f++)e=d[f],e=A(a,c,e.text)||A(a,c,e.oldtext)||A(a,c,e.author)||A(a,c,e.author_short)||A(a,c,e.last_save_date)||A(a,c,e.create_date)||A(a,c,e.date);else(d=D.revisions())&&(e=b.isAnnotationText(a,c,d)),!e&&M&&(e=b.isAnnotationText(a,c,M.revisions));return e};b.isDocumentText=function(a,c){return b.forRange(sa(a,c),
0,!0)?!0:b.isAnnotationText(a,c)};b.maxWidth=function(){if(c)return"vertical"!=w.scrollMode||void 0!==u.singlePageIndex?a.width:c.maxWidth};b.maxHeight=function(){if(c)return"vertical"!=w.scrollMode||void 0!==u.singlePageIndex?a.height:c.maxHeight};b.decomposeRange=function(a,b){var c;if(void 0!==a.page){var e=d[a.page];if(e){if("rect"===a.type)c=e.mapRectRangeToText(a);else if("cell"===a.type){var f=e.spreadsheetModel();f&&(c=f.decomposeRange(a,b))}(e=e.mapRangeToEmbeds(a))&&(c=c?c.concat(e):e)}}return c};
b.ranges=function(a){var c={};void 0===a&&(a=b.current());d[a]&&(a=d[a].textRanges())&&0<a.length&&(c.text=a);return c};var ea=function(){if(u.dynamicContent){switch(w.memoryModel){case "none":l=m=0;break;case "large":m=3145728;l=100;break;case "small":m=1048576;l=20;break;case "micro":m=524288;l=10;break;default:u.isMobile?(m=1048576,l=20):(m=3145728,l=100)}b.applyMemoryLimit()}else l=m=0};b.applyMemoryLimit=function(a){var c,d=0;if(K)for(c=K;c;)0<c.loadedSize&&d++,c=c.nextNewer;void 0!==a&&(p+=
a,b.logMemory&&b.logMemory(p,m,d,l));if(0<m&&p>m||0<l&&d>l){if(K){c=K;var e=a=-1,f=J.visiblePages();0<f.length&&(a=f[0].index,e=f[f.length-1].index);for(;c;){f=c.nextNewer;if(0<c.loadedSize&&!c.locked&&(c.index<a||c.index>e)&&(p-=c.loadedSize,c.unload(),d--,p<=m&&d<l))break;c=f}}b.logMemory&&b.logMemory(p,m,d,l)}};b.touchPage=function(a){(a=d[a])&&a!=F&&(void 0===F?K=a:(a==K&&(K=a.nextNewer),a.nextNewer&&(a.nextNewer.nextOlder=a.nextOlder),a.nextOlder&&(a.nextOlder.nextNewer=a.nextNewer),F.nextNewer=
a,a.nextOlder=F,a.nextNewer=void 0),F=a)};var na=function(){var a,d;d=(d=b.firstPage())&&d.isSpreadsheet();if(void 0===u.singlePageIndex&&(d||1<e.length)){v||(v=new ed,v.addPrevNext(function(){b.movetoPrev()},function(){b.movetoNext()}));for(d=v.length();d<e.length;d++){a=e[d];var f=a.firstPage;if(!f)break;v.addTab(a.name,a.hidden,b.moveto,f.index);a.isHidden()&&v.hideTab(a.index)}v.show();c&&v.setActiveTab(c.index);if(M){f=[];if(w.showAnnotations)for(d=0;d<M.revisions.length;d++)a=M.revisions[d],
!a.page&&a.ref&&void 0!==a.ref.sheet&&(a.page=b.page(a.ref.sheet)),a.page&&("add_sheet"==a.type?f[a.page.overlay.index]="oit-anno-add":f[a.page.overlay.index]||(f[a.page.overlay.index]="oit-anno-change"));for(d=0;d<e.length;d++){var g=f[d];g||(a=e[d],1==a.length&&a.firstPage.comments()&&(g="oit-anno-change"));v.tabClass(d,g)}}}else v&&(v.destroy(),v=null)};b.dispatchChange=function(c,d){c||(c=a);if(c==f&&!d)return!0;f=c;v&&v.setActiveTab(c.overlay.index);c.annotationPane()&&c.supportsAnnotationBar()&&
b.createAnnotationBar();return b.on.change.dispatch(c)};b.overlayById=function(a){return gb(e,"id",a)};b.pageById=function(a){return gb(d,"id",a)};b.createAnnotationBar=function(){q||(q=new fd)};b.activeOverlay=function(){return c};b.activePage=function(){return a};b.ssRevisions=function(){return M};var L=function(){na();g=void 0};b.updateShowSlideNotes=function(){if(!D.supressHiddenContentUpdate()){var c=J.saveScrollPos();w.showSlideNotes?D.screenCSS(".oit-sn","display:block;"):(D.screenCSS(".oit-sn",
null),a&&"sn"==a.type&&(P.deactivate(),T.select(null)));b.updateActivePage();J.layoutChanged();J.restoreScrollPos(c)}};b.overlayTabRect=function(a){if(v)return v.tabRect(a.index)};b.activeAnnotationPane=function(a){if(void 0!==a&&a!==C){var b=C;C=null;b&&b.deactivate();C=a}return C};b.deactivateAnnotation=function(){b.activeAnnotationPane(null)};b.scrollToAnnotationPane=function(a){if(w.showAnnotations&&b.activePage()&&b.activePage().supportsAnnotationPane()){var c=u.viewNode;c.animate({scrollLeft:c.scrollWidth-
c.clientWidth,endFn:a})}else a&&a()};b.annotationPaneWidth=function(){return w.showAnnotations&&c&&c.hasAnnotations()&&c.firstPage.supportsAnnotationPane()?338:0};var X=function(){!0===w.showHiddenSheets?b.eachOverlay(function(a){a.firstPage&&"worksheet"==a.firstPage.type&&a.show()}):!1===w.showHiddenSheets&&b.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};w.onmemoryModel(ea);w.onnochrome(L);w.onshowSlideNotes(b.updateShowSlideNotes);w.onscrollMode(function(){g=
void 0});w.onshowHiddenSheets(X);w.onshowSlideNotes(function(){!1===w.showSlideNotes&&"vertical"!==w.scrollMode&&"sn"===b.activePage().type&&b.movetoPrev()});w.onshowAnnotations(na);w.onannotationSort(function(){c&&c.each(function(a){(a=a.annotationPane())&&a.applySort()})});D.onreset(function(){for(var b in d){var h=d[b],r=h;p-=r.loadedSize;r.unload();h.destroy()}d=[];ga(e,"destroy");e=[];f=a=c=null;g=0;k=1;v&&(v.destroy(),v=null);q&&(q.destroy(),q=null);N&&(N.destroy(),N=void 0,H={},R={});m=p=0;
M=F=K=t=void 0});fa.ondata(function(a,c,f){var n;if(f=a.style){N||(N=new vb);var g=[],h=[];for(c=0;c<f.length;c++){var r=f[c];if("string"===typeof r)h.push(r);else if(r.s&&r.p){var l=r.s,r=r.p;"@font-face"===l?H.hasOwnProperty(r)||(H[r]=!0,g.push(l,"{",r,"}")):R.hasOwnProperty(l)||(R[l]=!0,h.push(l,"{",r,"}"))}}0<g.length&&N.addCSSText(g.join(""));0<h.length&&N.addCSSText(h.join(""))}if(a.overlays)for(c=0;c<a.overlays.length;c++)f=a.overlays[c],b.overlayById(f.oid)||e.push(new Lc(e.length,f));if(a.pages){n=
d.length;for(c=0;c<a.pages.length;c++){f=a.pages[c];g=null;"email"===f.type&&(u.singlePageIndex=void 0);if(void 0!==f.index){if(h=parseInt(f.index,10),void 0===u.singlePageIndex||u.singlePageIndex===h)d[h]||(d[h]=new ob(h,f.type,f.id)),g=d[h]}else g=new ob(d.length,f.type,f.id),d.push(g);g&&g.processData(f)}b.applyMemoryLimit()}a.attachments&&(c=b.page(0))&&(c._attachments=a.attachments.slice(0));if(a.ssrevisions&&a.ssrevisions.revisions){M=a.ssrevisions;M.revisions.sort(function(a,b){return a.seq-
b.seq});f=null;for(c=0;c<M.revisions.length;c++)if(g=M.revisions[c],void 0!==Rb[g.type]&&D.hiddenContent("tracked-changes"),g.cells)for(h=0;h<g.cells.length;h++)if(l=g.cells[h],l.text)for(r=0;r<l.text.length;r++)f=ub(f,l.text[r].range);f?ja.loadRawText(f.acc,f.accend,function(){b.each("processSSRevisions");na()}):(b.each("processSSRevisions"),na())}a.revisions&&b.each("processRevisions");X();na();void 0!==n&&d.length>n&&b.on.add.dispatch(n)});fa.onadd(function(){b.updateActivePage()});D.onscrollupdate(b.updateActivePage);
D.onload(function(){ea();L();b.updateShowSlideNotes()});ab.onendscroll(b.updateActivePage);T.onselectionchanged(function(a,c){if(w.showAnnotations){var d=b.activeAnnotationPane();if(a){var e=b.nearestForRange(a);e&&e.annotationPane()&&(d=e.annotationPane())}d&&c&&d.activate(a,!1,!1)}});b.onoverlayshow(function(a){v&&v.showTab(a.index)});b.onoverlayhide(function(c){v&&v.hideTab(c.index);!a||a.isEnabled()&&!a.overlay.isHidden()||(c=r(a.index),b.moveto(c))})}}),P=za.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last logVisibleHighlights moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),
events:{activate:{pub:!0,detail:function(b,e,d){return{highlightid:b?b.id:void 0,before:e,after:d}}},add:{pub:!0,detail:function(b){return{highlightid:b.id}}},remove:{pub:!0,detail:function(b){return{highlightid:b.id}}},move:{pub:!0,detail:function(b){return{highlightid:b.id}}},comment:{pub:!0,detail:function(b){return{highlightid:b.id}}},mode:{pub:!0,detail:function(b){return{autohighlight:b,autooptions:P.autoHighlightOptions(),selectionmode:D.selectionMode()}}}},userEventDef:{pub:!0,detail:function(b,
e,d){return{highlightid:d.id,srcEvent:e}}},install:function(b){var e={},d=function(a){var b=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};d("Top");d("Right");d("Bottom");d("Left");var c=0,a=[],f=0,g=0,k,t,v,q=[],p=!0,m,l=-1,K=-1,F,N,H=!1,R=!1,C,M=!1,G=!1,h,B={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},
V=!0,I=[],r=!1,A={x:0,y:0};b.add=function(){var a=arguments,b=1,c={};ta(0,a,c,"add");c.invalid||(b=ra(b,a,c,"add"));c.invalid||(Array.isArray(c.range)?c.type="hl-"+c.range[0].type:Ja(c.range)||Aa(c.range)?c.type="hl-text":c.type="hl-"+c.range.type,za(0,a,c,"add"));c.invalid||(b=xa(b,a,c,"properties","add"),b=ua(b,a,c,"comment","add"));c.invalid||va(b,a,c,"add");if(!c.invalid)return ya(c)};b.addMultiple=function(a,c,d,e){var f=arguments,n=1,g={},h,r;ta(0,f,g,"addMultiple");if(!g.invalid){if(Array.isArray(c)){for(r=
0;r<c.length;r++){if(!wa(c[r])){g.invalid=!0;break}if(h&&h!=c[r].type){g.invalid=!0;break}h=c[r].type}n++}else g.invalid=!0;h||(g.invalid=!0);g.invalid&&b.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}g.invalid||(g.type="hl-"+h.type,za(0,f,g,"addMultiple"));g.invalid||xa(n,f,g,"properties","addMultiple");if(!g.invalid){f=[];b.beginBatch();for(r=0;r<c.length;r++)g.range=wa(c[r]),n=ya(g),f.push(n),e&&b.setOptions(n,e);b.endBatch();return f}};b.addNote=function(){var a=arguments,
c=1,d={type:"note"};ta(0,a,d,"addNote");d.invalid||(c=ra(c,a,d,"addNote"));d.invalid||("cell"!==d.range.type&&"rect"!==d.range.type&&(b.invalidArg("addNote","range",d.range,"Anchored notes may only be added to rect or cell ranges"),d.invalid=!0),za(0,a,d,"addNote"));d.invalid||(c=xa(c,a,d,"properties","addNote"),c=ua(c,a,d,"comment","addNote"));d.invalid||va(c,a,d,"addNote");if(!d.invalid)return ya(d)};b.redact=function(){var b,c=arguments,d={type:"redaction"};b=ra(0,c,d,"redact");d.invalid||(b=xa(b,
c,d,"properties","redact"),b=ua(b,c,d,"label","redact"));d.invalid||va(b,c,d,"redact");if(!d.invalid){if("compound"===w.redactionMode||"hybrid"===w.redactionMode&&"cell"===d.range.type)d.compound=!0;a:{b=d;c=!1;b.range.embedId?c=!1:"hybrid"===w.redactionMode?c="rect"===b.range.type:"simple"===w.redactionMode&&(c="rect"===b.range.type||"cell"===b.range.type);if(c){var e=z.decomposeRange(b.range);if(e){var d=[],f=b.range,n=z.page(f.page),g=J.rangeRect(f,n),h=b.activate;b.activate=!1;for(c=0;c<e.length;c++){b.range=
e[c];var r=Sa(b);-1==d.indexOf(r)&&d.push(r)}if("drawing"===n.type||"slide"===n.type||"chart"===n.type){e=0===d.length;if(!e)for(c=0;c<d.length;c++)if(r=a[d[c]].range,"rect"!==r.type){e=!0;break}else if(r=J.rangeRect(r,n),!r||!r.equals(g)){e=!0;break}e&&(b.range=f,d.unshift(Sa(b)))}if(0<d.length){h&&da(d[0]);1==d.length&&(d=d[0]);b=d;break a}}}b=ya(b)}return b}};b.apply=function(a,c){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(gd){b.invalidArg("apply","highlights",a,"Error parsing JSON string: "+
gd.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(u.documentLoaded){c=Fa(c)?c:null;for(var d=0;d<a.length;d++){var e=a[d];if("sdef"==e.type)b.defineStamp(e.stamp,e.url);else{var f=oa();if(!c||c(f,e.properties))if(wa(e.range))if(f=[],"stamp"==e.type){var n={name:e.stamp};e.opacity&&(n.opacity=e.opacity);e.sizing&&(n.sizing=e.sizing);f.push(n);f.push(e.range);e.hasOwnProperty("properties")&&f.push(e.properties);e.hasOwnProperty("comment")&&f.push(e.comment);b.addStamp.apply(void 0,
f)}else ya(e);else b.invalidArg("apply","highlight["+d+"]",e)}}}else k=k?a.concat(k):a};b.remove=function(a,c){if(Array.isArray(a)){b.beginBatch();for(var d=0;d<a.length;d++)b.remove(a[d]);b.endBatch()}else(d=ca(a,F,"remove"))&&ea(d,c)};var ea=function(c,d){var e=c.id;void 0===d&&(d=!0);b.on.remove.dispatch(c);var n,h=!1,r=!1;e==F?(aa(d),F=void 0,void 0!=c.prevId?(n=c.prevId,r=!0):void 0!=c.nextId&&(n=c.nextId,h=!0)):d=!1;b.hideComment(e);a[e].prevId&&(a[a[e].prevId].nextId=a[e].nextId);a[e].nextId&&
(a[a[e].nextId].prevId=a[e].prevId);c.destroy();a[e]=null;f--;0>=f&&(A={x:0,y:0});e<g&&(g=e);void 0!==n&&da(n,h,r,d,!1,!1)};b.removeFromRange=function(a){Array.isArray(a)?ga(a,b.removeFromRange):"text"===a.type&&b.each(na,null,a)};var na=function(a,c){var d=a.range;"text"===d.type&&d.accend>=c.acc&&d.acc<=c.accend&&b.remove(a.id,!1)};b.count=function(){return f};b.clear=function(c){c=Fa(c)?c:null;aa();b.beginBatch();b.each(ea,c,!1);b.endBatch();c||(F=void 0,a=[],g=f=0)};d=function(){var a=w.highlightLabelFontFamily,
c=w.highlightLabelFontSize,d="";a&&(d+="font-family:"+a+";");c&&(d+="font-size:"+c+";");D.screenCSS(".oit-highlight-label",d);b.each("showLabel",null,w.showHighlightLabels)};b.setOptions=function(a,c){c&&ja(a,F,"setOptions",null,[c])};b.getOption=function(a,c){return ja(a,F,"getOption",null,[c])};b.style=function(a,c){var d,e=ca(a,F,"style");if(e)if(c){var f=Ga(c,"hl-text"!=e.type);f?d=e.style(f):b.invalidArg("style","style",c)}else d=e.style();return d};b.comment=function(a,c,d){if(a=ca(a,F,"comment")){var e=
a.comment();void 0!==c&&c!==e&&(d||a.id!==b.active()||a.isNote()?e=a.comment(c):(b.hideComment(),e=a.comment(c),b.showComment()),b.on.comment.dispatch(a));return e}};var L=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},X=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},n=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},x=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&
(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img}};b.stamp=function(a){if(m)return m[a]};b.label=function(a,c){return ja(a,F,"label",null,[c])};b.defineStamp=function(a,c,b){m||(m={});c?(b=b||{},c={url:c},b.sizing&&(c.sizing=L(b.sizing)),b.opacity&&(c.opacity=X(b.opacity)),b.defaultSize&&(c.defaultSize=n(b.defaultSize)),m[a]=c,x(m[a])):delete m[a]};var W=function(a){var c;if(a){var b;if(a instanceof String||"string"==typeof a)b={name:a};else{b={};for(var d in a)b[d]=
a[d]}b.name&&m&&m[b.name]&&(b.type="stamp",b.stamp=m[b.name],c=b)}return c};b.addStamp=function(){var a,c=arguments,d=W(c[0]);if(d){d.sizing=L(d.sizing)||d.stamp.sizing||"scale";d.opacity=X(d.opacity)||d.stamp.opacity||1;d.defaultSize=n(d.defaultSize)||d.stamp.defaultSize;var e;e=ra(1,c,d,"addStamp");var f=d.range;f&&"rect"!=f.type&&"cell"!=f.type?(b.invalidArg("addStamp","range",f),d.invalid=!0):"rect"===f.type&&Qb(f)?d.range=ma(f.left,f.top,"rect",d):"cell"===f.type&&f.c1==f.c2&&f.r1==f.r2&&(d.range=
ma(f.c1,f.r1,"cell",d));d.invalid||(e=xa(e,c,d,"properties","addStamp"),e=ua(e,c,d,"comment","addStamp"));va(e,c,d,"addStamp");d.invalid||(a=ya(d))}else b.invalidArg("addStamp","stamp",c[0],"Must be the name of a defined stamp");return a};b.getJSON=function(a){if(a=ca(a,F,"getJSON"))return JSON.stringify(a.serialize())};b.serialize=function(a){var c=[],d,e;Fa(a)?d=a:Array.isArray(a)?e=a:"number"===typeof a&&(e=[a]);b.each(E,d,c,{},e);return JSON.stringify(c,null,!1)};var E=function(a,c,b,d){d&&-1==
d.indexOf(a.id)||(a=a.serialize(),a.stamp&&!b[a.stamp]&&(c.push({type:"sdef",stamp:a.stamp,url:m[a.stamp].url}),b[a.stamp]=!0),c.push(a))};b.properties=function(a,c){return ja(a,F,"properties",null,[c])};b.property=function(a,c,b){return ja(a,F,"property",null,[c,b])};b.current=function(){return F};b.active=function(){if(!H&&!R)return F};b.moveto=function(a){(a=ca(a,F,"moveto"))&&da(a.id,!1,!1,!0,!0,!0);return F};b.movetoNext=function(c){ia();if(void 0===F)void 0!==t&&b.moveto(t);else{var d=F;if(H&&
a[d].filter(c)&&qa(d))return b.moveto(d);for(;;){d=a[d].nextId;if(void 0===d)break;var e=a[d];if(e.filter(c)&&(e=z.nearestForRange(e.range))){if(e.isLoaded())da(d);else{var f=F;z.moveto(e.index,function(){F=f;b.movetoNext(c)})}return d}}}return F};b.movetoPrev=function(c){ia();if(void 0===F)void 0!==v&&b.moveto(v);else{var d=F;if(R&&a[d].filter(c)&&qa(d))return b.moveto(d);for(;;){d=a[d].prevId;if(void 0===d)break;var e=a[d];if(e.filter(c)&&(e=z.nearestForRange(e.range))){if(e.isLoaded())da(d);else{var f=
F;z.moveto(e.index,function(){F=f;b.movetoPrev(c)})}return d}}}return F};b.type=function(a){if(a=ca(a,F,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;default:return"highlight"}};b.range=function(a){if(a=ca(a,F,"range"))return a.range};b.show=function(a){if(void 0===a||Fa(a))b.beginBatch(),b.each(function(a){S(a)},a),b.endBatch();else if(Array.isArray(a)){b.beginBatch();for(var c=0;c<a.length;c++){var d=ca(a[c]);d&&S(d)}b.endBatch()}else ja(a,F,"show")};b.hide=function(a){if(void 0===
a||Fa(a))b.beginBatch(),b.each(function(a){U(a)},a),b.endBatch();else if(Array.isArray(a)){b.beginBatch();for(var c=0;c<a.length;c++){var d=ca(a[c]);d&&U(d)}b.endBatch()}else ja(a,F,"hide");b.alignHighlight()};b.isHidden=function(a){return ja(a,F,"isHidden")};b.logVisibleHighlights=function(){var c=b.first();if(void 0===c)console.log("No visible highlights.");else for(;void 0!==c;){var d=a[c];console.log("["+d.id+"]: range="+JSON.stringify(d.range)+", key="+JSON.stringify(d.key));c=b.next(c)}};b.showComment=
function(c,d){Array.isArray(c)&&(c=c[0]);var e=ca(c,F,"showComment");if(e){d=d||{};d.mode||(d.mode="view");var f=b.active();if(void 0!==f&&(f=a[f],f.isNote()&&f.isEditing()))return;if(e.isNote())switch(d.mode){case "view":e.show();e.endEditText(!0);break;case "edit":e.beginEditText(!1);break;case "new":e.beginEditText(!0)}else e.dialog(d.mode)}};b.hideComment=function(a){(a=ca(a,F,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};b.first=function(){ia();return t};b.last=function(){ia();return v};
b.next=function(a){if(a=ca(a,F,"next"))return ia(),a.nextId};b.prev=function(a){if(a=ca(a,F,"prev"))return ia(),a.prevId};b.activate=function(a){(a=ca(a,F,"activate"))&&da(a.id)};b.deactivate=function(){aa(!0)};var ba=function(a){if(a)for(var c in B)void 0!==a[c]&&(B[c]=a[c]);T.enableCellOffsets("note"===M||"stamp"===M);Ca();b.on.mode.dispatch(M)};b.autoHighlightOptions=function(a){void 0!==a&&ba(a);a={};for(var c in B)a[c]=B[c];return a};b.autoHighlight=function(a,c){var d;if(!1===a){T.select(null);
if(h){d=J.features();switch(h){case "text":d.textselection||(h=null);break;case "rect":d.rectselection||(h=null);break;case "cell":d.cellselection||(h=null);break;default:h=null}h&&(D.selectionMode(h),h=null)}M=!1;ba()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){c=c||{};B.comment=null;B.sticky=!1;B.properties=null;T.select(null);if("stamp"===a){if(!W(c.stamp))return b.invalidArg("autoHighlight","options.stamp",c.stamp),M=!1}else if(("selection"===a||"note"===a)&&!Ga(c.style,
!0))return b.invalidArg("autoHighlight","options.style",c.style),M=!1;M=a;h||(h=D.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)d=J.features(),d.rectselection||"redaction"===a&&d.rectredaction?D.selectionMode("rect"):d.cellselection&&D.selectionMode("cell");ba(c)}return M};b.pauseAutoHighlight=function(a){G=!!a};b.beginBatch=function(){c++};b.endBatch=function(){0<c&&c--};b.batchMode=function(){return 0<c};var Ca=function(){if("selection"===M||"note"===M)T.style(B.style,!1);else if("redaction"===
M){var a;w.redactionFillColor&&"compound"===w.redactionMode&&"rect"===D.selectionMode()?a=w.redactionFillColor:(a=Da(w.redactionColor),.7<a.a&&(a.a=.7),a=La(a.r,a.g,a.b,a.a));T.style("background-color:"+a+";",!1)}else if("stamp"===M)if(m&&(a=m[B.stamp]),a){var c="background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&(c+=";opacity:"+a.opacity);"scale"==a.sizing?c+=";background-size:contain":"stretch"==a.sizing&&(c+=";background-size:100% 100%");T.style(c)}else T.style(null);
else T.style(null)},ma=function(a,c,b,d){var e,f;d&&(d.defaultSize&&(e=d.defaultSize.x,f=d.defaultSize.y),e||(e=d.width),f||(f=d.height));e||(e=200);f||(f=200);a=z.mapToPage(a,c);d&&(a.x-=Math.floor(e/2),a.y-=Math.floor(f/2));return J.rangeFromRect(a.page.index,a.x,a.y,a.x+e,a.y+f,a.page,"move")},qa=function(c){return"slideshow"!=w.presentationMode?!0:(c=wa(a[c].range))&&z.nearestForRange(c)?!0:!1};b.startSelection=function(){N=b.active();aa(!1)};b.endSelection=function(){N=void 0};D.onselect(function(c,
d,e,f,n){var g=!0;if(c&&M&&!G){var h=c,r="note"===M,l="stamp"===M;if(r&&!J.features().anchorednotes||(r||l)&&"text"===h.type&&!f)return!0;c=r||!0===B.comment;if(f)if((r||l)&&e&&void 0===N){var x;l&&((d=W(B.stamp))?x=d.stamp:h=null);h&&(d=J.features(),h=d.rectselection?ma(e.x,e.y,"rect",x):d.cellselection?ma(e.x,e.y,"cell",x):null);h||T.select(null)}else T.select(null),h=null;else r&&d&&e&&"rect"===h.type&&(x=h.bottom-h.top,100>h.right-h.left&&(d.x<e.x?h.right=h.left+100:h.left=h.right-100),80>x&&
(d.y<e.y?h.bottom=h.top+80:h.top=h.bottom-80));if(h&&void 0===n){var m;"text"===h.type&&(h=Y.getSelection());"redaction"===M?m=b.redact(h,B.properties,B.label):l?!W(B.stamp)||"rect"!==h.type&&"cell"!==h.type?T.select(null):m=b.addStamp(B.stamp,h,B.properties):r?"rect"===h.type||"cell"===h.type?m=b.addNote(B.style,h,B.properties):T.select(null):m=b.add(B.style,h,B.properties);if(void 0!==m){e=Array.isArray(m)?m:[m];n="string"===typeof B.comment?B.comment:void 0;for(g=0;g<e.length;g++)m=a[e[g]],m.setOptions(B),
n&&m.comment(n);T.select(null);b.activate(e[0]);c&&b.showComment(e,{mode:"new"});g=!1;B.sticky||b.autoHighlight(!1)}}}return g});b.alignComment=function(){b.each("alignDialog")};J.ondisplayload(function(a,c){l=a.index;K=c.index;b.eachOnPage("addToPage",z.page(l));K>l&&Q(l+1,K)});J.ondisplayunload(function(a,c){b.each("destroyDialog");K=l=-1});z.onpageload(function(c){-1!=K&&c.index>K&&(K=z.activeOverlay().lastPage.index);0<a.length&&c.index>=l&&c.index<=K&&b.queueAddAllToPage(c.index,!1,!0)});z.onpageunload(function(a){a.index>=
l&&a.index<=K&&(b.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});b.onEmailHeaderResize=function(a){b.each("addToPage",null,a);b.positionAll(z.activeOverlay())};b.alignHighlight=function(){void 0==F||H||R||da(F,!1,!1,!1,!1,!0)};b.move=function(a,c,b,d,e,f){var n;c=c||0;d=d||0;b=b||0;e=e||0;f=f||!1;if((a=ca(a))&&(c||d||b||e)&&a.getOption("enableUserMove")){var g=ha(a.range);if("rect"===g.type){f=f?1:10;var h=J.pageRange(g.page,g.type);g.left+=c*f;g.top+=b*f;g.right+=d*f;g.bottom+=e*
f;f=g.right-g.left;n=g.bottom-g.top;c&&(0>g.left?(g.left=0,d&&(g.right=f)):g.left>=g.right&&(g.left=g.right-1));d&&(g.right<=g.left?g.right=g.left+1:g.right>h.right&&(g.right=h.right,c&&(g.left=g.right-f,0>g.left&&(g.left=0))));b&&(0>g.top?(g.top=0,e&&(g.bottom=g.top+n)):g.top>=g.bottom&&(g.top=g.bottom-1));e&&(g.bottom<=g.top?g.bottom=g.top+1:g.bottom>h.bottom&&(g.bottom=h.bottom,b&&(g.top=g.bottom-n,0>g.top&&(g.top=0))))}else"cell"===g.type&&(h=J.pageRange(g.page,g.type),g.c1+=c,g.r1+=b,g.c2+=d,
g.r2+=e,f=g.c2-g.c1,n=g.r2-g.r1,c&&(g.c1<h.c1?(g.c1=h.c1,d&&(g.c2=g.c1+f)):g.c1>g.c2&&(g.c1=g.c2)),d&&(g.c2<g.c1?g.c2=g.c1:g.c2>h.c2&&(g.c2=h.c2,c&&(g.c1=g.c2-f,g.c1<h.c1&&(g.c1=h.c1)))),b&&(g.r1<h.r1?(g.r1=h.r1,e&&(g.r2=g.r1+n)):g.r1>g.r2&&(g.r1=g.r2)),e&&(g.r2<g.r1?g.r2=g.r1:g.r2>h.r2&&(g.r2=h.r2,b&&(g.r1=g.r2-n,g.r1<h.r1&&(g.r1=h.r1)))));a.setRange(g)}};var Ga=function(a,c){if(!V)return a;var b;if("string"==typeof a){b=[];var d=kb(a,"color");d&&b.push("color:",d,";");(d=kb(a,"background-color"))&&
b.push("background-color:",d,";");if(!c)(d=kb(a,"text-decoration"))&&b.push("text-decoration:",d,";");else if(c&&-1!=a.indexOf("border")){d=y.create("div");d.attr("style",a);d.css("display","none");y.body.append(d);var e=d.computedStyle(d),f=ka(e,"Top"),g=ka(e,"Left"),n=ka(e,"Bottom"),h=ka(e,"Right");f.w&&f.w==n.w&&f.w==g.w&&f.w==h.w&&f.c==n.c&&f.c==g.c&&f.c==h.c?b.push("border:",f.w," solid ",f.c,";"):(pa(e,f,b),pa(e,g,b),pa(e,n,b),pa(e,h,b));d.destroy()}b=0===b.length?void 0:b.join("")}return b},
ka=function(a,c){c=e[c];return{e:c,w:a[c.w],c:a[c.c]}},pa=function(a,c,b){c.w&&b.push(c.e.wp,",",c.w,";",c.e.sp,":solid;",c.e.cp,":",c.c,";")},ya=function(a){var c,b,d,e,f;if(Array.isArray(a.range)){f=a.range;a.compound=f;e=f[0].acc;b=f[0].accend;for(c=1;c<f.length;c++)d=f[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=sa(e,b)}else if(Ja(a.range)||Aa(a.range)){f=Fb(a.range);if(!f)return;if(!Array.isArray(f))return a.range=f,ya(a);a.compound=f;e=f[0].acc;b=f[0].accend;for(c=1;c<f.length;c++)d=
f[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=sa(e,b)}if("text"===a.range.type){if((f=z.pagesForRange(a.range))&&2<=f.length){d=a.range;e=[];var g,n;for(c=0;c<f.length;c++)b=f[c],b.overlay!=n?(g=sa(b.acc,b.accend),e.push(g),n=b.overlay):(b.acc<g.acc&&(g.acc=b.acc),b.accend>g.accend&&(g.accend=b.accend));if(1<e.length){g=[];for(c=0;c<e.length;c++)a.range=e[c],a.range.acc<d.acc&&(a.range.acc=d.acc),a.range.accend>d.accend&&(a.range.accend=d.accend),n=Sa(a),-1==g.indexOf(n)&&g.push(n);return 0===
g.length?void 0:1==g.length?g[0]:g}}}else if("rect"===a.range.type&&(b=z.page(a.range.page))&&b.isEmailHeader())return;return Sa(a)},Sa=function(c){"text"===T.selectionType()&&T.select(null);var d="rect"===c.range.type||"cell"===c.range.type,e=oa(),g;switch(c.type){case "redaction":g=new hd(e,c);break;case "note":d&&(g=new id(e,c));break;case "stamp":d&&(g=new jd(e,c));break;default:g=new $a(e,c)}if(g){a[e]=g;f++;d=!0;b.batchMode()&&(d=(d=z.forRange(g.range))&&d.spreadsheetModel()?d.spreadsheetModel().containsRange(g.range):
!1);if(d){if(d=g,d.addToDocument(),(e=la.infoRaw())&&1557===e.fi&&"text"==d.range.type)for(var e=z.count(),n=0;n<e;n++){var h=z.page(n);h&&!h.isLoaded()&&h.containsRange(d.range)&&(I.push({type:"addtopage",pageIndex:n,loadPage:!0,highlight:d}),Ha())}}else I.push({type:"add",highlight:g}),Ha();b.link(g);b.on.add.dispatch(g);!0===c.activate?da(g.id):A&&(b.activateNearest(A.x,A.y,null,!1),A=null);return g.id}},Ha=function(){r||(r=!0,D.onidle(Z))},Q=function(c,d){if(0!==a.length&&!b.batchMode())for(var e=
c;e<=d;e++){var f=z.page(e);f&&f.isLoaded()&&b.queueAddAllToPage(e)}},P=function(a,c){for(var b=I.length-1;0<=b;b--){var d=I[b];d.highlight!==a||c&&-1==c.indexOf(d.type)||I.splice(b,1)}};b.queueAddAllToPage=function(a,c,b,d){a={type:"addall",pageIndex:a,loadPage:!!c,force:!!d};b?I.unshift(a):I.push(a);Ha()};var S=function(a){P(a);I.push({type:"show",highlight:a});Ha()},U=function(a){P(a);I.push({type:"hide",highlight:a});Ha()},Z=function(){J.suspendUpdate();var c=[],d;O.performance&&(d=O.performance.now());
for(var e=0;0<I.length;e++){var f=I.shift(),g=!1;if(void 0!==f.pageIndex){var n=z.page(f.pageIndex);if(n.isLoaded())if(void 0===f.highlight){if(n&&n.isLoaded()){void 0===f.highlightIndex&&(f.highlightIndex=0);for(g=0;20>g&&!(f.highlightIndex>=a.length);g++){var h=a[f.highlightIndex++];h&&n.containsRange(h.range)&&h.addToPage(f.pageIndex,!!f.force)}f.highlightIndex<a.length&&I.unshift(f)}g=!0}else f.highlight.addToPage(f.pageIndex);else if(!0===f.loadPage){var l=f;n.load(!1,function(){I.unshift(l);
Ha()})}}else void 0!==f.highlight&&("show"===f.type&&f.highlight.isHidden()?f.highlight.show():"hide"===f.type?f.highlight.hide():(f.highlight.addToDocument(!1),c.push(f.highlight)));if(g||10<=e)if(void 0!==d){if(g||0==e%10)if(f=O.performance.now()-d,50<f)break}else if(20<=e)break}void 0!==d&&(f=O.performance.now()-d,console.log("Background apply highlights: Processed "+(e+1)+" tasks, "+I.length+" remaining, "+Math.ceil(f)+"ms elapsed."));for(d=0;d<c.length;d++)b.link(c[d]);0===I.length&&r&&(r=!1,
D.offidle(Z));J.resumeUpdate()};b.findNearest=function(c,b){ia();if(void 0!==t){var d=z.mapToPage(c,b,null,!0,!0);if(d){var e=d.page;c=d.x;b=d.y;for(var f,g,n,h=0;h<a.length;h++){var r=a[h];if(r&&!r.isHidden()&&r.isOnPage(e.index)){var l=r.distanceFromPoint(e.index,c,b,d.inAnnotation);void 0!==l&&(0===l.x&&0===l.y?(f||(f=[]),f.push(r),g=l):!f&&(void 0===g||l.ay<g.ay||l.ay==g.ay&&l.ax<g.ax)&&(g=l,n=r))}}if(f)return{highlights:f,distance:g};if(n)return{highlights:[n],distance:g}}}};b.activateNearest=
function(c,d,e,f){var g=F,n=R,h=H;!1!==f&&(f=!0);ia();if(void 0===t)A&&(A.x=c,A.y=d);else{var r=b.findNearest(c,d);if(r)if(g=void 0,h=n=!1,1<r.highlights.length){var l=b.active();if(void 0!==l)for(var x=0;x<r.highlights.length;x++)if(r.highlights[x].id==l){++x>=r.highlights.length&&(x=0);g=r.highlights[x].id;break}void 0===g&&(g=r.highlights[0].id)}else g=r.highlights[0].id,n=r.distance,h=0>n.y||0===n.y&&0>n.x,n=0<n.y||0===n.y&&0<n.x;else{if(r=z.mapToPage(c,d,null,!0,!0))for(x=r.page,g=t;void 0!==
g;g=a[g].nextId)if((r=z.forRange(a[g].range))&&r.index>=x.index){l=r;break}l||(g=v,l=z.forRange(a[g].range));l&&l.index<x.index?n=!0:h=!0}}if(g!=F||n!=R||h!=H)return!1!==f||h||n?e||h||n||(h=!0):h=!0,da(g,h,n,!0,!1),b.active()};var aa=function(a){da(void 0,!1,!1,a)},da=function(c,d,e,f,g,n){var h;if(!C&&(c=(h=ca(c))?h.id:void 0,!0!==d&&(d=!1),!0!==e&&(e=!1),!1!==g&&(g=!0),(h=c!=F||d!=H||e!=R)&&(n=!1),h||n)){void 0!==c&&b.isHidden(c)&&(c=void 0);if(!n){if(h=a[F])h.hideDialog(),h.deactivate();h=F;F=
c;void 0!==h&&a[h]&&a[h].isEmptyRedaction()&&b.remove(h,!0);H=d;R=e}if(void 0!==F&&!d&&!e&&a[F]){h=a[F];if(g){z.moveto(h.range,function(){da(c,d,e,f,!1,!0)});return}if(h.isNote())T.select(null);else{C=h;T.select(h.range,h.id);g=db(h.style());var r;g.color&&(r="color:"+g.color+";background-color: rgba(255,255,255,0);");T.hide(r);C=null}u.viewNode.focus();h.activate(n);h.comment()&&!h.isNote()&&b.showComment(h.id,{mode:"view"})}!1!==f&&(h=ca(F),b.on.activate.dispatch(h,H,R))}};b.highlight=function(c){return a[c]};
var ja=function(a,c,b,d,e){d=d||b;if(a=ca(a,c,b))return"string"==typeof d?a[d].apply(a,e):d.apply(null,e)},ca=function(c,d,e){var f;void 0===c&&(c=d);"number"===typeof c&&a[c]?f=a[c]:e&&b.invalidArg(e,"id",c);return f},ia=function(){if(p){for(q.sort(function(a,c){var b=void 0!==a?a.getKey():void 0,d=void 0!==c?c.getKey():void 0;if(void 0===b)return void 0===d?0:1;if(void 0===d)return-1;var e=b.page-d.page;e||(e=b.y-d.y)||(e=b.x-d.x);return e});0<q.length&&void 0===q[q.length-1];)q.pop();if(0===q.length)v=
t=void 0;else{t=q[0].id;v=q[q.length-1].id;var a,c,b;b=q[0];for(var d=0;d<q.length;d++){a=c;c=b;b=q[d+1];if(!c)break;a?(c.prevId=a.id,a.nextId=c.id):c.prevId=void 0;b?(c.nextId=b.id,b.prevId=c.id):c.nextId=void 0}}p=!1}};b.link=function(a){-1==q.indexOf(a)&&(q.push(a),p=!0)};b.unlink=function(a,c){var b=q.indexOf(a);-1!=b&&(q[b]=void 0,p=!0);!0!==c&&a.id==F&&(aa(),F=void 0)};b.positionAll=function(a){b.each("positionAll",a);b.alignHighlight()};b.validateStyles=function(a){void 0!==a&&(V=!1!==a);return V};
b.updateHighlights=function(){Q(l,K);b.positionAll(z.activeOverlay())};var oa=function(){for(;g<a.length&&a[g];)g++;g>=a.length&&(g=a.length,a.push(null));return g};b.each=function(c,b){mb(a,arguments)};b.eachOnPage=function(c,b){ga(a,c,function(c){return b.containsRange(a[c].range)},b.index)};var ra=function(a,c,d,e){if(a<c.length){c=c[a];if(Array.isArray(c)){d.range=c;for(var f=0;f<c.length;f++)wa(c[f])||(d.range=null)}else Ja(c)||Aa(c)?d.range=c:d.range=wa(c);d.range&&a++}d.range||("text"===D.selectionType()&&
(d.range=Y.getSelection(),d.range&&d.range.isCollapsed&&(d.range=void 0)),d.range||(d.range=D.selection()),d.range?d.activate=!0:(b.invalidArg(e,"range",null,"A range was not specified and nothing is currently selected"),d.invalid=!0));return a},ta=function(a,c,d,e){if(1>c.length||"string"!==typeof c[0])b.invalidArg(e,"style",null,"A highlight style must be specified"),d.invalid=!0},za=function(a,c,d,e){var f;a<c.length&&"string"===typeof c[a]&&(f=c[a]);d.style=Ga(f,"hl-text"!=d.type);d.style?a++:
(b.invalidArg(e,"style",f),d.invalid=!0);return a},xa=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof Object||"object"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},ua=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof String||"string"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},va=function(a,c,d,e){for(;a<c.length&&void 0===c[a];)a++;a<c.length&&(b.invalidArg(e,null,null,"Unexpected argument(s)"),d.invalid=!0);return a},Ba=function(){b.each("updateStyle","isRedaction");
Ca()};w.onredactionColor(Ba);w.onredactionFillColor(Ba);w.onnochrome(function(){b.positionAll(z.activeOverlay())});w.onshowSlideNotes(b.updateHighlights);w.onshowHighlightLabels(function(a){b.each("showLabel",null,a)});w.onhighlightLabelFontFamily(d);w.onhighlightLabelFontSize(d);w.onhighlightActivationBoxColor(function(a){if(null===a)D.screenCSS(".oit-highlight-active .oit-activation","display:none;"),D.screenCSS(".oit-highlight-embed","display:none;"),D.screenCSS(".oit-highlight-active .oit-resize div",
"display:none;"),D.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),D.screenCSS(".oit-text-handle div:first-child","display:none;"),D.screenCSS(".oit-text-handle",null);else if(a=Da(a)){var c="rgb("+a.r+","+a.g+","+a.b+")",b="border:2px solid "+c+";opacity:"+a.a+";";D.screenCSS(".oit-highlight-active .oit-activation",b);b="border:1px solid "+c+";opacity:"+a.a+";";D.screenCSS(".oit-highlight-embed",b);b="background-color:"+c+";";D.screenCSS(".oit-highlight-active .oit-resize div",b);
D.screenCSS(".oit-text-handle div:nth-child(2)",b);D.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+c+";");b="opacity:"+a.a+";";D.screenCSS(".oit-text-handle",b)}});d=function(a,c,d){if((a=z.activePage())&&a.isSpreadsheet()&&!d.inAnnotation())return!0;a="tap"===c.type?u.viewNode.touchPos(c):u.viewNode.mousePos(c);void 0===b.activateNearest(a.x,a.y,c,!0)&&d&&b.activate(d.id);return void 0!==b.active()?!1:!0};b.on.click.setDefaultListener(d);b.on.tap.setDefaultListener(d);
D.onscroll(function(){b.alignComment()});D.onreset(function(){b.on.removeAllElements();b.clear();c=0;a=[];g=f=0;v=t=k=void 0;q=[];p=!0;m=void 0;K=l=-1;N=F=void 0;R=H=!1;C=void 0;G=M=!1;h=void 0;B={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0};I=[];r&&(r=!1,D.offidle(Z));A={x:0,y:0}});D.onload(function(){if(k){var a=k;k=null;b.apply(a)}});D.onzoom(function(a,c,d){b.positionAll(z.activeOverlay())});
fa.ondata(function(a,c,d){a.highlights&&b.apply(a.highlights);if(a.stamps)for(var e in a.stamps)m[e]=a.stamps[e]})}}),Mc=za.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(b,e,d){b={srcEvent:e,url:d.url};d.range&&(b.range=ha(d.range));d.alt&&(b.alt=d.alt);b.external=0!==b.url.indexOf("#");return b}},install:function(b){var e,d,c={},a=0,f=!1,g=null,k=null,t,v=function(a,c,d){if(c){var e=d+10;e>c.length&&(e=c.length);for(;d<e;d++){var f=c[d],g=f.range;if(g)if("text"===g.type)K(a,f);else if("rect"==
g.type&&g.page===a.index){if(!a.linkMap){var l=a.childByClass("oit-svg"),h=l.byClass("oit-svg-text");if(h&&0<h.length){h=h[0];a.linkMap=y.create("div","oit-area-hyperlinks");a.linkMap.attr("style",h.attr("style"));if(h.classList)for(var m=0;m<h.classList.length;m++){var k=h.classList.item(m);"oit-svg-text"!==k&&a.linkMap.addClass(k)}l.append(a.linkMap)}}a.linkMap&&(g="left:"+g.left+"px;top:"+g.top+"px;width:"+(g.right-g.left)+"px;height:"+(g.bottom-g.top)+"px;",l=y.create("div"),l.attr("style",g),
a.linkMap.append(l),b.on.addElement(l,f),g={anchorNode:l,page:a},f.anchors||(f.anchors=[]),f.anchors.push(g))}}}return d},q=function(a,c,b){if(c){var d=b+10;d>c.length&&(d=c.length);for(;b<d;b++){var e=c[b],f=e.range;if(f&&"text"===f.type){var g=a.findRange(f.acc,f.accend);g&&ga(g,"addDataToRange",null,f,e)}}}return b},p=function(a,b,d){a=0;b&&(a=b.button||0);if(0!==a||!d.targetId)return!0;g=null;(b=c[d.targetId])?(d=y.byId(d.targetId)||b.range||b.page,void 0!==d&&z.movetoEx(d,{force:!0,moveToTop:!0}),
f&&(oa.hideMessage(),f=!1)):fa.isPending()?(g=d,fa.on.add.listenOnce(function(){g&&p(null,null,g)})):f&&(oa.hideMessage(),f=!1);return!1};b.on.click.setDefaultListener(p);b.on.tap.setDefaultListener(p);fa.ondata(function(b,f,g){var l;if(b.hyperlinks){e=e?e.concat(b.hyperlinks):b.hyperlinks;for(f=0;f<b.hyperlinks.length;f++)g=b.hyperlinks[f],g.type="hyperlink",g.id="oit-hl-"+ ++a,l=g.url,0===l.indexOf("#")&&(g.targetId=l.substring(1)+"."+y.expando,g.url="#"+g.targetId);g=z.count();for(l=0;l<g;l++)(f=
z.page(l))&&f.isLoaded()&&!f.isHidden()&&v(f,b.hyperlinks,0)}if(b.bookmarks){d=d?d.concat(b.bookmarks):b.bookmarks;for(f=0;f<b.bookmarks.length;f++)g=b.bookmarks[f],l=g.name,g.type="bookmark",g.id=l+"."+y.expando,c[g.id]||(c[g.id]=g);g=z.count();for(l=0;l<g;l++)(f=z.page(l))&&f.isLoaded()&&q(f,b.bookmarks,0)}});var m=function(){if(k){for(var a,c=0;c<k.length;c++){var b=k[c];if(b.page.isLoaded()){var f=!0;b.page.isHidden()?f=!1:(e&&(b.hindex=v(b.page,e,b.hindex),b.hindex<e.length&&(f=!1)),d&&(b.bindex=
q(b.page,d,b.bindex),b.bindex<d.length&&(f=!1)));f||(a||(a=[]),a.push(b))}}k=a}k||(t&&(Ta(t),t=void 0),D.offidle(m))},l=function(a,c,b){a.addDataToRange(c,b);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},K=function(a,c){var b=c.range,d=a.findRange(b.acc,b.accend);d&&ga(d,l,null,b,c)};z.onpageload(function(a,c){k||(k=[]);if(-1==k.indexOf(a)&&(k.push({page:a,hindex:0,bindex:0}),1==k.length))if("rt"!=a.type&&
"sn"!=a.type||t)t=tb(m,75);else D.onidle(m)});z.onpageunload(function(a){if(e)for(var c=0;c<e.length;c++){var d=e[c];if(d.anchors)for(var f=d.anchors.length-1;0<=f;f--){var g=d.anchors[f];if(g.page===a){b.on.removeElement(g.anchorNode);1==d.anchors.length?d.anchors=void 0:d.anchors.splice(f,1);break}}}delete a.linkMap});D.onreset(function(){b.on.removeAllElements();d=e=void 0;c={};a=0;k=g=null;t&&(Ta(t),t=void 0)});pb("ihs",function(a){if(e)for(var c=Fb(a.currentTarget),b,d=0;d<e.length;d++){var f=
e[d];cb(c,f.range)&&(b||(b=z.forNode(a.currentTarget)),b&&K(b,f))}})}}),wb=za.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(b,e,d){(b=wb.describe(d))?b.attachment=d:b={};b.srcEvent=e;return b},onListen:function(){wb.onListen()},onUnlisten:function(){wb.onUnlisten()},onAdd:function(){wb.onListen()},onRemove:function(){wb.onUnlisten()}},install:function(b){var e=[],d,c=0;b.item=function(a){return e[a]};b.describe=function(a){var c;0===arguments.length?
c=Wa(e):isNaN(a)||0<=a&&a<e.length&&(c=Wa(e[a]));return c};b.setOptions=function(a){a&&(d||(d=new vb),a.hasOwnProperty("cursor")&&d.setRule(".oit-attachedFile {cursor:"+a.cursor+"}","cursor"),a.hasOwnProperty("color")&&d.setRule(".oit-attachedFile {color:"+a.color+"}","color"))};b.onListen=function(){0===c&&u.viewNode&&u.viewNode.addClass("oit-attachevents");c++};b.onUnlisten=function(){0<c&&0===--c&&u.viewNode&&u.viewNode.removeClass("oit-attachevents")};D.onload(function(){0<c?u.viewNode.addClass("oit-attachevents"):
u.viewNode.removeClass("oit-attachevents")});D.onreset(function(){e=[];d&&(d.destroy(),d=void 0)});fa.ondata(function(a,c,b){if(a.attachments)for(b=0;b<a.attachments.length;b++)c=a.attachments[b],c.id=e.length,e.push(c);if(a.pages)for(var d=0;d<a.pages.length;d++){var f=a.pages[d].attachments;if(f)for(b=0;b<f.length;b++)c=f[b],c.id=e.length,e[c.id]=c}})}}),Nc=za.extend("archive",{userEventDef:{pub:!0,detail:function(b,e,d){return{nodeid:d,name:b.text(),srcEvent:e}}}}),Oa=za.extend("multimedia",{events:{loading:{pub:!0,
detail:function(b){return{elem:b}}},failedToPlay:{pub:!0,detail:function(b,e){return{elem:b,error:e}}},canPlay:{pub:!0,detail:function(b){return{elem:b}}},missingContent:{pub:!0,detail:function(b,e){return{elem:b,status:e}}},internalError:{pub:!0,detail:function(b,e,d){return{elem:b,err:e,details:d}}},loaded:{pub:!0,detail:function(b,e){return{elem:b,success:e}}}},exports:["setOptions","getOptions","MissingContentStatus"],install:function(b){var e={disableCaching:!1};b.MissingContentStatus={MISSING_AUDIO:"no audio",
MISSING_VIDEO:"no video"};var d={CORS_ERROR:"Unable to determine the type of multimedia error that occurred. Request blocked by CORS. Ensure the CORS preflight request and the actual request did not fail.",PLAYBACK_ERROR:"Unable to play multimedia file format. Codec is unsupported by browser.",TIMEOUT:"Unable to determine the type of multimedia error that occurred. Request timed out.",INTERNAL_ERROR:"Unable to determine the type of multimedia error that occurred. An internal error occurred."};b.getOptions=
function(){return Wa(e)};b.setOptions=function(c){c.hasOwnProperty("disableCaching")&&(e.disableCaching=c.disableCaching)};b.detectError=function(c,a){if(c)if("string"===typeof c&&(c={url:c}),"string"===typeof c.url&&0<c.url.trim().length){c.timeout=c.timeout||2E3;var e=!1,g=Ma({url:c.url,headers:{Range:"bytes=0-0"},loading:function(c,b,f,q){e||(e=!0,b=2===Math.round(q/100)?"PLAYBACK_ERROR":0===q?"CORS_ERROR":"INTERNAL_ERROR",a({url:c,error:b,message:d[b]||"Missing error message"}),lb(g))},success:function(c,
b,f,g){e||(e=!0,a({url:c,error:"PLAYBACK_ERROR",message:d.PLAYBACK_ERROR||"Missing error message"}))},error:function(c,b,f,g){e||(e=!0,a({url:c,error:"INTERNAL_ERROR",status:httpCode,message:d.INTERNAL_ERROR||"Missing error message"}))}})}else b.invalidArg("detectError","request.url",c.url,"expected non-empty string");else b.invalidArg("detectError","request",c,"expected either url as string or { url: string, timeout?: number }")};b.load=function(c){function a(a,c){k||(k=!0,b.detectError({url:a.dom.currentSrc,
timeout:2E3},function(d){console.log("mod.multimedia.detectError",d);switch(d.error){case "PLAYBACK_ERROR":b.on.failedToPlay.dispatch(a,c);break;default:b.on.internalError.dispatch(a,c,d)}}),b.on.loaded.dispatch(a,!1))}function d(a){if(!t){t=!0;var c=a.dom,d=function(a){return"undefined"!==typeof a};c instanceof HTMLVideoElement&&(d(c.webkitDecodedFrameCount)&&0==c.webkitDecodedFrameCount&&0==c.videoWidth&&0==c.videoHeight||d(c.mozDecodedFrames)&&0==c.mozDecodedFrames||d(c.videoTracks)&&0==c.videoTracks.length)&&
b.on.missingContent.dispatch(a,b.MissingContentStatus.MISSING_VIDEO);b.on.canPlay.dispatch(a);b.on.loaded.dispatch(a,!0)}}function e(a){if(!v){var c=a.dom;if(c instanceof HTMLVideoElement){var d=function(a){return"undefined"!==typeof a};0<c.currentTime&&((d(c.mozHasAudio)&&!c.mozHasAudio||d(c.webkitAudioDecodedByteCount)&&0==c.webkitAudioDecodedByteCount||d(c.audioTracks)&&0==c.audioTracks.length)&&b.on.missingContent.dispatch(a,b.MissingContentStatus.MISSING_AUDIO),v=!0)}else v=!0}}if(c){b.on.loading.dispatch(c);
var k=!1,t=!1,v=!1;c.dom.addEventListener("canplay",function(){d(c)});c.dom.addEventListener("error",function(b){a(c,b)});c.dom.addEventListener("timeupdate",function(){e(c)});for(var q=c.dom.getElementsByTagName("source"),p=0,m=0;m<q.length;m++)q[m].addEventListener("error",function(b){p++;p>=q.length&&!k&&a(c,b)});c.dom.load()}else b.invalidArg("load","media",c,"cannot be null or undefined")}}}),ua=za.extend("toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(b,
e){return{id:b,edge:e}}},remove:{pub:!0,detail:function(b,e){return{id:b,edge:e}}},show:{pub:!0,detail:function(b,e,d,c){return{id:b,edge:e,width:d,height:c}}},hide:{pub:!0,detail:function(b,e){return{id:b,edge:e}}},resize:{pub:!0,detail:function(b,e,d,c){return{id:b,edge:e,width:d,height:c}}},resizeinternal:{}},install:function(b){var e=["left","top","right","bottom"],d=[],c,a,f=function(){bb(d,"refresh");la.dispatchResize()};la.onresize(f);z.onchange(function(){var c=z.activeOverlay();c!=a&&(a=
c,f())});b.add=function(a,f,g){var k;if(-1===e.indexOf(a))b.invalidArg("add","edge",a,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(y.isElement(f)){var p,m=!1,l=!1,t=!1,F;g&&(g.size&&((p="auto"===g.size?g.size:zb(g.size))||b.invalidArg("add","options.size",g.size,"Must be a valid CSS length or 'auto'")),!0===g.visible&&(m=!0),!0===g.overlay&&(l=!0),!0===g.resizable&&(t=!0),g.border&&(F=g.border));var v;c?(v=d[c],k=++c):k=c=1;g=u.viewNode;var H=g.scroll();f=new Sb(k,a,y.wrap(f),F,v);l&&
f.overlay(!0);t&&f.resizable(!0);d[k]=f;p&&f.setSize(p);g.scroll(H);b.on.add.dispatch(k,a);m&&b.show(k)}else b.invalidArg("add","elem",f,"Must be a valid DOM Element");return k};b.addInternal=function(a,c){d[a]=c};b.removeInternal=function(a){var c=d[a];c&&(c.remove(),delete d[a])};b.internalParent=function(a){var c,b;for(b in d)b=Number(b),b>a&&(void 0===c||b<c)&&(c=b);if(void 0!==c)return d[c]};b.remove=function(a){bb(d,g,a);f()};var g=function(a){var b=a.id;a.remove();for(d[b]=void 0;!d[c];)if(0>=
--c){c=void 0;break}return!0};b.setSize=function(a,c){a=Number(a);var e=d[a];e&&!e.isInternal()||b.invalidArg("setSize","id",a,"Must be a valid toolbar id returned by OIT.toolbars.add");var g="auto"===c?c:zb(c);g?e&&(e.setSize(g),f()):b.invalidArg("setSize","size",c,"Must be a valid CSS length or 'auto'")};b.show=function(a,c){bb(d,"show",a,c||{});f()};b.hide=function(a){bb(d,"hide",a);f()}}}),Hb,Tb,Ub,Oc;(function(){var b=null,e={},d=0;Hb=function(c,a,b,d,e,t){if(b&&"text"===a.type&&a.accend>a.acc&&
(e=c.findRange(a.acc,a.accend,e))&&0<e.length)return d={type:"style",id:d,priority:t||0},"string"===typeof b?d.className=b:d.props=b,!b.color&&e[0].hasClass("oit-tt")&&(t=e[0].computedStyle().color,t=Da(t),t.a=1,b.color=La(t)),ga(e,"addDataToRange",null,a,d),c.pageLayoutChanged(),e};Ub=function(c,a,b,d){b&&c&&0<c.length&&(a={type:"style",id:a,priority:d||0},"string"===typeof b?a.className=b:a.props=b,!b.color&&c[0].hasClass("oit-tt")&&(d=c[0].computedStyle().color,d=Da(d),d.a=1,b.color=La(d)),ga(c,
"changeData",null,a))};Tb=function(c,a){ga(c,"removeData",null,"style",a)};Oc=function(c){c=dc(c,!0);var a=e[c];a||(a="oit-ss"+ ++d,e[c]=a,b||(b=new vb),b.addCSSText("."+a+" {"+c+"}"));return a};D.onreset(function(){b&&(b.destroy(),b=null);e={};d=0})})();va.extend(["page","drawing","slide","chart"],{de:"page",showhidden:!1,cellselection:!1});va.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});va.extend("html",{de:"page",rotate:!1,showhidden:!1,pages:!1,
fitpage:!1,cellselection:!1,elasticScroll:!1});va.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});va.extend("rt",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});va.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});sb.extend("page",{install:function(b){var e,
d=1,c=null,a,f,g,k,t,v=u.isMobileOrTablet?10:20,q=!1,p,m=0,l=0,K,F=0,N;b.load=function(g){e=g.overlay;d=1;c=null;a=g.type;f=void 0;if(!u.isMobile&&void 0===u.singlePageIndex)D.onidle(V);H(g);z.onadd(b,R);z.onchange(b,I);D.onscrollupdate(b,ba);T.onbeginselection(b,W);D.onscroll(b,E);if("email"===a)la.onresize(b,r);w.onremoveExtraEmailHeaders(b,L);w.onscrollMode(b,X);w.onpresentationMode(b,n);w.onnochrome(b,x);w.onshowEmailAddresses(b,Ca);w.onshowAnnotations(b,ma);x(w.nochrome);B(g.index);ma();I()};
b.unload=function(){D.screenCSS(".oit-annopane",null);z.offadd(R);z.offchange(I);D.offscrollupdate(ba);T.offbeginselection(W);D.offscroll(E);la.offresize(r);w.offremoveExtraEmailHeaders(L);w.offscrollMode(X);w.offpresentationMode(n);w.offnochrome(x);w.offshowEmailAddresses(Ca);w.offshowAnnotations(ma);u.isMobile||D.offidle(V);f&&(f.destroy(),f=void 0);c&&c.hideStickyHeader();e=null;d=1;c=null;g=f=t=k=a=void 0;v=u.isMobileOrTablet?10:20};b.visiblePages=function(){var c=[];if("email"===a)e.each(function(a){c.push(a)});
else if("vertical"==w.scrollMode&&void 0===u.singlePageIndex){var b=z.count(),d,f,g,n=z.current();for(d=n-1;0<=d;d--)if((f=z.page(d))&&f.isEnabled()){if(f.overlay!=e)break;g=f.pageRect("view");if(0>=g.bottom)break;n=d}c.push(z.page(n));var h=u.viewNode.clientHeight-10;for(d=n+1;d<b;d++)if((f=z.page(d))&&f.isEnabled()){if(f.overlay!=e)break;g=f.pageRect("view");if(g.top>h)break;10<g.bottom&&c.push(f)}}else c.push(z.activePage());return c};b.saveScrollPos=function(){var a=z.page(b.visiblePages()[0]);
if(a){var c=a.pageRect("view");return{page:a,offset:c.top/c.height}}};b.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var c=a.page.pageRect("view");(a=c.top-a.offset*c.height)&&u.viewNode.dscroll(void 0,a)}};b.scrollPadding=function(){if(c)return c.scrollPadding()};b.margin=function(){return{left:v,top:v,right:v,bottom:v}};var H=function(a){if(a._emailHeader){c=a._emailHeader;c.applyShowEmailAddresses();var b=a.overlay.firstPage,d=z.page(b.index+1);b&&b.load(!0,function(){d?d.load(!0,
function(){d.parent()!=b.parent()&&b.parent().append(d);r()}):r()})}};b.layoutChanged=function(a){if(e){var c=u.viewNode,b=w.zoom;a||(a={x:0,y:0});var f=c.scroll(),g=null,n=null,h;h=v/w.zoom;1!=b&&(g=["scale(",b,",",b,")"].join(""),n="left top");h=2*h+z.annotationPaneWidth();h="vertical"==w.scrollMode?h+e.maxWidth:h+z.activePage().width;e.css({transform:g,"transform-origin":n,"min-width":h+"px"});C();g=b/d;c.scroll((a.x+f.left)*g-a.x,(a.y+f.top)*g-a.y);d=b;I()}};var R=function(a){K||(K=da(function(){K=
void 0;C(!0);B()},500))},C=function(c){if(e){F=0;var b=w.rotation,d={yOffset:0,maxWidth:0,height:0},n=z.top(),h=[],r=w.centerPages,l=v/w.zoom;if("email"===a)r=!1,h.push(".oit-emailbk{"),h.push("margin:",l,"px"),h.push("}"),h.push(".oit-email-stickyheader{"),h.push("left:",l,"px"),h.push("}");else if("html"===a||"rt"===a)r=!1;if(r){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");h.push("margin:",l,"px 0 ",l/2,"px 0");h.push("}");h.push(".oit-sn{");h.push("margin:0 0 ",2*l,"px 0");
h.push("}");if(!w.nochrome&&0!==b){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");switch(b){case 90:h.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:h.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:h.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}h.push("}")}h.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",
l,"px;}")}"vertical"==w.scrollMode?e.each(M,null,h,b,r,l,d):M(z.activePage(),h,b,r,l,d);0===d.maxWidth?e.css("width",null):(d.maxWidth+=v+v,e.css("width",d.maxWidth+"px"));0===d.height?e.css("height",null):(d.height+=v,e.css("height",d.height+"px"));h=h.join("");f||(f=new vb);f.setCSSText(h);!n||g||c||"vertical"!=w.scrollMode||void 0!==u.singlePageIndex||(c=w.disableAnimation,w.disableAnimation=!0,z.moveto(n),w.disableAnimation=c);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});
P.positionAll(e);F=e.length}},M=function(c,b,d,e,f,g){var n=0,h=0,r,l=u.viewNode.clientWidth,x=z.annotationPaneWidth();c.resetCache();if("sn"==c.type)e&&(n=(l/w.zoom-(c.offsetWidth+x))/2,n<f&&(n=f)),h=g.yOffset;else{if("email"===a||"html"===a||"rt"===a)d=0;switch(d){case 0:e&&(n=(l/w.zoom-(c.offsetWidth+x))/2,n<f&&(n=f));break;case 90:e&&(h=(l/w.zoom-(c.offsetHeight+x))/2,h<f&&(h=f));n=-g.yOffset-c.offsetWidth;g.yOffset=g.yOffset-c.offsetHeight+c.offsetWidth;c.offsetHeight>g.maxWidth&&(g.maxWidth=
c.offsetHeight);g.height+=c.offsetWidth+v;r="rotate(270deg) ";break;case 180:e&&(n=-((l/w.zoom-(c.offsetWidth+x))/2),n>-f&&(n=-f));n-=c.offsetWidth;h=-c.offsetHeight;r="rotate(180deg) ";break;case 270:e&&(h=-((l/w.zoom-(c.offsetHeight+x))/2),h>-f&&(h=-f)),h-=c.offsetHeight,n=g.yOffset,g.yOffset=g.yOffset-c.offsetHeight+c.offsetWidth,c.offsetHeight>g.maxWidth&&(g.maxWidth=c.offsetHeight),g.height+=c.offsetWidth+v,r="rotate(90deg) "}}n=Q(n);h=Q(h);if(0!==n||0!==h||r){b.push("#",c.id.replace(/\./g,"\\."));
b.push(" {");if(0!==n||0!==h||r)b.push(ib.transform,":"),r&&b.push(r),0===n&&0===h||b.push("translate(",n,"px,",h,"px)"),b.push(";");b.push("}")}};b.moveto=function(b,d,e){var f=!1,n;e=e||{};if(kc(b))if(c)f=c.moveto(b,d,e);else{if("slide"==a&&(n=z.forRange(b))&&n.annotationPane()){var h=n.annotationPane().range();cb(h,b)&&n.annotationPane().activate(b,!0,!0,d,e)}}else"number"===typeof b&&(f=u.viewNode,n=z.page(b),B(n.index),(b=e.gotoNode)&&b!==n?b=z.elementRect(b,"overlay"):(b=n.pageRect("overlay").clone(),
b.top-=v),n=f.scroll().top,b=n+(b.top-n),0>b&&(b=0),b!=n?(D.on.scrollupdate.disable(),f.abortAnimation(),n=!1!==e.animate?150:0,g=!0,f.animate({scrollTop:b,time:n,endFn:G,args:[d,e]})):d&&d(e),f=!0);return f};var G=function(a,c,b){g=!1;D.on.scrollupdate.enable();D.on.scrollupdate.dispatch();c&&c(b)},h=function(a){"sn"!=a.type&&(t&&a.hiddenFromSlideshow?a.hide():a.show())},B=function(c){var b=!1;"vertical"===w.scrollMode&&void 0===u.singlePageIndex?u.viewNode.removeClass("oit-single"):u.viewNode.addClass("oit-single");
if("vertical"==w.scrollMode&&void 0===u.singlePageIndex||"email"===a||"html"===a||"rt"===a)void 0!==k&&(e.showPages(),k=void 0,b=!0,t=!1),c="slideshow"==w.presentationMode,c!=t&&(t=c,b=!0,e.each(h));else if(c=c||z.current(),c!=k){var d=z.page(c);if(d){var f;void 0===k?e.hidePages(d.index):(f=z.page(k),d.addClass("oit-noshadow"));d.show({insertLast:!0,animate:!0,endFn:function(){d.removeClass("oit-noshadow");f&&f.hide()}});k=c;b=!0;u.isMobileOrTablet&&e.css("min-height",d.height+v+v+"px")}}b&&(D.dispatchPageEvents(!0),
P.positionAll(e))};b.pageRange=function(a,c){if("rect"===c){var b=z.page(a);if(b)return b=b.pageRect(),Gb(a,0,0,b.width,b.height)}};b.rangeRect=function(a,c,b,d){var e;if("text"===a.type){var f=z.forRange(a);f&&(e=f.textBoundingRect(a,d))}else"rect"===a.type&&(e=new ia(a),void 0!==a.embedId&&((d=z.page(a.page))&&(f=d.embeddingRect(a.embedId)),f?e.offset(f.left,f.top):e=void 0));e&&(e.origin=c);return e};b.rangeFromRect=function(a,c,b,d,e,f,g,n){var h;if(a=z.page(a))c=new ia(c,b,d,e,f),c.origin=a,
b=void 0!==n?a.embeddingRect(n):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&("move"===g?c.constrain(b):"select"!==g&&c.intersect(b)),void 0!==n?(c.offset(-b.left,-b.top),h=c.toRange(a),h.embedId=n,xa(h,"pct")):h=c.toRange(a);return h};b.extendRange=function(a,c,d,e){var f=b.rangeRect(a,e);return b.rangeFromRect(a.page,f.left,f.top,c,d,e,"extend")};var V=function(a){if(!a)return z.loadNextPageFromServer()||D.offidle(V),!1},I=function(){if(!u.isMobile&&void 0===u.singlePageIndex)D.onidle(V);
void 0!==N&&ra(N);N=da(function(){N=void 0;u.viewNode.scroll();for(var a=J.visiblePages(),c=0;c<a.length;c++){var b=a[c];b&&b.isPending()&&b.load(!1)}},100)},r=function(){e.each(na);c&&c.applyViewSize()},A=function(){if("email"===a){var c=u.viewNode.clientWidth-146;30>c&&(c=30);return c}},ea=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=A();this.css("max-width",""+a+"px");this.addClass("oit-ximage");
this.removeClass("oit-cimage")}r();z.each("pageLayoutChanged")},na=function(a){if(a.hasClass("oit-rt")&&a.isLoaded()){var c=A();if(c!==a.pageContentMaxWidth){a.pageContentMaxWidth=c;for(var b,d,e=0;;e++){var f=a.embeddingByIndex(e);if(!f)break;var g=y.byId(f.id);if(g&&(c&&(f.w>c?(g.hasClass("oit-cimage")||(g.css("max-width",""+c+"px"),g.addClass("oit-ximage")),g.onclick(ea),g.ontap(ea)):(g.css("max-width",null),g.removeClass("oit-ximage"),g.removeClass("oit-cimage"),g.offclick(ea),g.offtap(ea))),
f=z.elementRect(g,a))){if(void 0===b||f.right>b)b=f.right;if(void 0===d||f.bottom>d)d=f.bottom}}void 0!==b&&a.css("min-width",b+10+"px");void 0!==d&&a.css("min-height",d+10+"px");if(c&&(b=a.childByTagName("div"))&&(b=b.childrenByTagName("TABLE")))for(d=0;d<b.length;d++)b[d].css("max-width",""+c+"px");a.pageLayoutChanged()}}},L=function(a){c&&a&&c.removeExtraEmailHeaders()},X=function(){e&&(B(),u.viewNode.scroll(0,0),z.updateActivePage())},n=function(){e&&B()},x=function(a){e&&(v=a?0:u.isMobileOrTablet?
10:20,B())},W=function(){c&&c.beginSelection()};b.startElasticScroll=function(){var a=w.scrollMode;"hswipe"!==a&&"vswipe"!==a||!J.features().elasticScroll||(u.viewNode.css("overflow","hidden"),q=!0,l=m=0)};b.elasticScroll=function(a,c){if(q){var b=w.scrollMode,d="hswipe"===b,b="vswipe"===b,f=0,g=0;void 0!==a&&d&&(m=f=-a,e.css("left",f+"px"));void 0!==c&&b&&(l=g=-c,e.css("top",g+"px"));if(f||g){u.viewNode.cancelKinetic();var b=z.activePage(),n=b.annotationPane();n&&n.hide();var h;if(0<f||0<g)h=z.prev(z.current());
else if(0>f||0>g)h=z.next(z.current());h&&h!==p&&(p&&(p.hide(),p.css({left:null,top:null,position:null}),p=void 0),h.overlay==b.overlay&&(g=f=0,h.index<b.index?d?f=b.pos(e).left/w.zoom-v-h.width:g=b.pos(e).top/w.zoom-v-h.height:d?f=b.rect(e).right/w.zoom+v:g=b.rect(e).bottom/w.zoom+v,h.css({left:f+"px",top:g+"px",position:"absolute",transform:"none"}),h.show({animate:!1}),(n=h.annotationPane())&&n.hide(),p=h))}hb()}};b.endElasticScroll=function(a,c){if(q){q=!1;u.viewNode.css("overflow",null);var b=
"hswipe"===w.scrollMode;u.viewNode.cancelKinetic();var d,f=z.activePage();b?(b=a/(f.width*w.zoom),d=a/u.viewNode.clientWidth):(b=c/(f.height*w.zoom),d=c/u.viewNode.clientHeight);d=Math.max(b,d);var g=b=0,n=f;-.25>d?n=z.prev(f.index)||f:.25<d&&(n=z.next(f.index)||f);n!==f&&(b=(u.viewNode.clientWidth-n.width*w.zoom)/2,b<v&&(b=v),d=v,g=n.pos(u.viewNode),b=m+b-g.left,g=l+d-g.top);e.animate({offsetLeft:b,offsetTop:g,time:100,transition:n!==f?"ease-in":"ease-out",endFn:function(){p&&(p!==n&&p.hide(),p.css({left:null,
top:null,transform:null}),p=void 0);e.css({left:null,top:null});n!==f&&(z.deactivateAnnotation(),u.viewNode.scroll(0,0),z.movetoEx(n.index,{animate:!1}),P.eachOnPage("addToPage",n));if(w.showAnnotations){var a=n.annotationPane();a&&a.show()}hb()}});hb()}};var E=function(){if(c)c.onScroll()},ba=function(){F!=e.length&&R(0)},Ca=function(){c&&c.applyShowEmailAddresses()},ma=function(){var a=w.showAnnotations;if(a){var c=z.activePage();c&&!c.supportsAnnotationBar()&&D.screenCSS(".oit-annopane","width:338px !important;");
z.scrollToAnnotationPane(P.updateHighlights)}else z.deactivateAnnotation(),D.screenCSS(".oit-annopane",null);e.each(function(c){(c=c.annotationPane())&&(a?c.show():c.hide())});D.dispatchPageEvents()}}});va.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});sb.extend("ss",{install:function(b){var e,d,c,a,f=!1;b.load=function(f){e=f;a=c=d=null;if(d=f.spreadsheetModel())c=new kd(d,e),(f=d.showHidden())?(f={columns:f.columns,rows:f.rows},b.showHidden(f)):
c.showHidden(w.showHiddenColumns,w.showHiddenRows),c.doUpdate();w.onshowHiddenRows(b,g);w.onshowHiddenColumns(b,k);w.onshowAnnotations(b,t);t()};b.unload=function(){w.offshowHiddenRows(g);w.offshowHiddenColumns(k);w.offshowAnnotations(t);a&&ra(a);c&&c.unload();a=c=d=null};b.maxPageWidth=function(){if(c)return c.maxPageWidth()};b.maxPageHeight=function(){if(c)return c.maxPageHeight()};b.padding=function(){if(c)return c.padding()};b.scrollOffset=function(){if(c)return c.scrollOffset()};b.getSelectedText=
function(){return d?d.getSelectedText():""};b.select=function(a){return d?d.select(a):!1};b.keydown=function(a){var b=!0;if(c)switch(a.keyCode){case 33:u.viewNode.dscroll(0,-(c.visibleHeight()+1));if(a=T.cellSelection())b=c.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1-=b,0>a.r1&&(a.r1=0),a.r2=a.r1,T.select(a);b=!1;break;case 34:u.viewNode.dscroll(0,c.visibleHeight()+1);if(a=T.cellSelection())b=c.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1+=b,b=d.rowCount()-1,a.r1>b&&(a.r1=b),a.r2=a.r1,T.select(a);
b=!1;break;case 35:f=!f;b=!1;break;case 36:c.scrollToRange(0,0,0,0);a=ta(e.index,0,0);T.select(a);b=f=!1;break;case 27:c.hidePopup(!0);b=f=!1;break;case 37:case 38:case 39:case 40:break;default:f=!1}return b};b.loadRange=function(a,c){d&&d.loadRange(a,c)};b.expandRange=function(a){d&&(a=d.expandRange(a));return a};b.moveto=function(a,b,d){return c?c.moveto(a,b,d):!1};b.showHidden=function(a){void 0===a&&(a="all");var b=d.showHidden(a);"string"===typeof a&&(a=b);c&&c.showHidden(a.columns,a.rows)};
var g=function(){c&&c.showHidden(void 0,w.showHiddenRows)},k=function(){c&&c.showHidden(w.showHiddenColumns,void 0)},t=function(){T.select(null);d&&d.showAnnotations(w.showAnnotations);c&&(c.showHidden(w.showHiddenColumns,w.showHiddenRows),c.update())};b.pageRange=function(a,c){if("cell"===c&&a==e.index)return ta(a,0,0,d.colCount()-1,d.rowCount()-1)};b.pageRect=function(a,b){if(c)return c.pageRect(a,b)};b.rangeRect=function(a,b,d){if(c)return c.rangeRect(a,b,d)};b.rangeFromRect=function(a,b,d,e,f,
g,k,q){if(c)return c.rangeFromRect(a,b,d,e,f,g,k,q)};b.extendRange=function(a,b,d,e){if(c)return c.extendRange(a,b,d,e)};var v=function(a,c){var b=ca(a+c,0,d.colCount()-1);if(0!==c&&d.colHidden(b)){var e=d.colCount()-1;do if(b+=c,0>b){for(b=0;b<=e&&d.colHidden(b);b++);break}else if(b>e){for(b=e;0<=b&&d.colHidden(b);b--);break}while(d.colHidden(b))}return b},q=function(a,c){var b=ca(a+c,0,d.rowCount()-1);if(0!==c&&d.rowHidden(b)){var e=d.rowCount()-1;do if(b+=c,0>b){for(b=0;b<=e&&d.rowHidden(b);b++);
break}else if(b>e){for(b=e;0<=b&&d.rowHidden(b);b--);break}while(d.rowHidden(b))}return b};b.moveAnchor=function(a,b,e,g){g=!1;f&&(0>b?b=-d.colCount():0<b&&(b=d.colCount()),0>e?e=-d.rowCount():0<e&&(e=d.rowCount()),f=!1);b=v(a.c1,b);e=q(a.r1,e);a.c1!=b&&(a.c1=b,g=!0);a.c2!=b&&(a.c2=b,g=!0);a.r1!=e&&(a.r1=e,g=!0);a.r2!=e&&(a.r2=e,g=!0);g&&c.scrollToRange(a.c1,a.r1,a.c1,a.r1);return g};b.incrementSelection=function(a,b,e,g,k){k=!1;f&&(0>e?e=-d.colCount():0<e&&(e=d.colCount()),0>g?g=-d.rowCount():0<
g&&(g=d.rowCount()),f=!1);b.c2==a.c1?(e=v(b.c1,e),e!=b.c1&&(e<=b.c2?b.c1=e:(b.c1=b.c2,b.c2=e),k=!0)):(e=v(b.c2,e),e!=b.c2&&(e>=b.c1?b.c2=e:(b.c2=b.c1,b.c1=e),k=!0));b.r2==a.r1?(g=q(b.r1,g),g!=b.r1&&(g<=b.r2?b.r1=g:(b.r1=b.r2,b.r2=g),k=!0)):(g=q(b.r2,g),g!=b.r2&&(g>=b.r1?b.r2=g:(b.r2=b.r1,b.r1=g),k=!0));k&&(g=b.c2==a.c1?b.c1:b.c2,a=b.r2==a.r1?b.r1:b.r2,c.scrollToRange(g,a,g,a));return k};b.layoutChanged=function(a){c&&c.layoutChanged(a)};b.update=function(a){c&&c.update(a)}}});va.extend(["archive",
"emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});sb.extend("arc",{install:function(b){var e,d,c,a,f=function(a){a.preventDefault();q(this.parentNode.parentNode.parentNode,this)},g=function(a){q(this.parentNode.parentNode.parentNode,this)},k=function(c){a=d.scroll()},t=function(c){d.autoscroll(a.left-c.delta.x,a.top-c.delta.y)},v=function(){var a=d.scroll().left;a!=c&&(c=a,0===c?e.css("margin-left",null):e.css("margin-left",-c+
"px"))};b.load=function(a){e=a.childByClass("oit-tree-head");d=a.childByClass("oit-tree-nodes");c=0;d.kinetic(!0);var b=y.byClass("oit-open-close");b&&(ga(b,"onclick",null,f),ga(b,"ontap",null,g));if(b=y.byClass("oit-tree-nname"))for(a=0;a<b.length;a++){var l=b[a],m=l.attr("data-nodeid");null!==m&&""!==m&&(m=Number(m),isNaN(m)||Nc.on.addElement(l,m))}if(b=e.byClass("oit-col-header"))for(a=0;a<b.length;a++)b[a].ctrl=new p(b[a],e),b[a].ctrl.colClass="f"+a;a=e;var q;a:{try{for(var F=Y.styleSheets,b=
0;b<F.length;b++){var K=F[b].cssRules||F[b].rules;if(0<K.length&&"div.f0"==K[0].selectorText){q=b;break a}}}catch(h){}q=null}a.ssIndex=q;d.onscroll(v);d.onpanstart(k);d.onpanmove(t)};b.unload=function(){Nc.on.removeAllElements()};var q=function(a,c){var b=a.nextElementSibling;"none"!=b.style.display?(b.style.display="none",c&&c.addClass("closed")):(b.style.display="block",c&&c.removeClass("closed"))},p=function(a,c){U.call(this,"div","oit-col-dragger");this.append(y.create("div"));this.headerbar=
c;var b=a.nextSiblingElem();b?e.insert(this,b):e.append(this);this.header=a;this.ondragstart(m);this.ondragmove(l);this.ondragend(K);this.ondragcancel(K)};Z(p,U);var m=function(a){this.orgwidth=this.header.clientWidth;this.overlay||(a=u.viewNode,this.overlay=y.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));
return!1},l=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9;return!1},K=function(a){this.overlay.destroy();delete this.overlay;this.header.css("width",null);var c=this.orgwidth+a.delta.x-3;1>c&&(c=1);c+="px";if(null!==this.headerbar.ssIndex){var b=Y.styleSheets[this.headerbar.ssIndex].cssRules,d="div."+this.colClass;for(a=0;a<b.length;a++)if(b[a].selectorText==d){b[a].style.width=c;break}}else for(b=this.headerbar.parent().byClass(this.colClass),
a=0;a<b.length;a++)b[a].css("width",c);return!1}}});va.extend("multimedia",{de:"mm",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,textselection:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});sb.extend("mm",{install:function(b){function e(){d.each(c)}var d=null;b.load=function(a){la.onresize(b,e);u.viewNode.css("display","flex");u.viewNode.css("overflow","hidden");d=a.overlay;d.css("display","flex");d.css("justify-content","center");d.css("align-items","center");e()};b.unload=function(){la.offresize(e);
d=null;u.viewNode.css("display",null);u.viewNode.css("align-items",null);u.viewNode.css("overflow",null)};var c=function(a){if(a.hasClass("oit-multimedia")&&a.isLoaded()&&(a=a.childByClass("oit-video"))){var c=a.dom.videoHeight,b=a.dom.mediaWidth,d=u.viewNode.clientHeight,e=u.viewNode.clientWidth;ic("ie11")&&(c>d||b>e)?(a.css("background-size","auto"),a.css("max-width",e+"px"),a.css("max-height",d+"px")):c>d?(a.css("background-size","contain"),a.css("max-width","100%"),a.css("max-height",d+"px")):
(b>e?(a.css("background-size","contain"),a.css("max-width",e+"px")):(a.css("background-size","auto"),a.css("resize",null),a.css("max-width","100%")),a.css("max-height","100%"))}}}});var ia=function(){var b=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=ha(a),xa(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=z.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var c=a[0];this.l=c.left;
this.t=c.top;this.r=c.right;this.b=c.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||this.o instanceof U);if(!(aa(this.l)&&aa(this.t)&&aa(this.r)&&aa(this.b)&&a))throw"Invalid Rectangle";this.l=Q(this.l,1E4);this.t=Q(this.t,1E4);this.r=Q(this.r,1E4);this.b=Q(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=Z(b);
Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=Q(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.verifyMutable();this.t=Q(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.verifyMutable();this.r=Q(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=
Q(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=Q(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){this.verifyMutable();0>a&&(a=0);this.h=Q(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();this.convert(a)}}});var d=function(a,c,b){return"number"===typeof b&&(b=Q(b,1E4),b!==a[c])?(a[c]=b,!0):
!1};e.move=function(a,c,b,e){this.verifyMutable();a=d(this,"l",a);a|=d(this,"t",c);a|=d(this,"r",b);if(a|=d(this,"b",e))this.w=this.r-this.l,this.h=this.b-this.t;return a};e.movesize=function(a,c,b,e){this.verifyMutable();a=d(this,"l",a);a|=d(this,"t",c);a|=d(this,"w",b);if(a|=d(this,"h",e))this.r=this.l+this.w,this.b=this.t+this.h;return a};e.offset=function(a,c){this.verifyMutable();void 0!==a&&(this.left+=a);void 0!==c&&(this.top+=c)};e.size=function(a,c){this.verifyMutable();void 0!==a&&(this.width=
a);void 0!==c&&(this.height=c)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var c=function(a,c){return a===c?!0:.999<(a>c?c/a:a/c)};e.equals=function(a){return c(this.l,a.left)&&c(this.t,a.top)&&c(this.r,a.right)&&c(this.b,a.bottom)};e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=
function(a,c){return a>=this.l&&a<=this.r&&c>=this.t&&c<=this.b};e.union=function(a,c,b,d){if(1==arguments.length){var e=arguments[0];this.union(e.left,e.top,e.right,e.bottom)}else this.verifyMutable(),a=Q(a,1E4),c=Q(c,1E4),b=Q(b,1E4),d=Q(d,1E4),a<this.l&&(this.l=a),c<this.t&&(this.t=c),b>this.r&&(this.r=b),d>this.b&&(this.b=d),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,c,b,d){if(1==arguments.length){var e=arguments[0];this.intersect(e.left,e.top,e.right,e.bottom)}else this.verifyMutable(),
a=Q(a,1E4),c=Q(c,1E4),b=Q(b,1E4),d=Q(d,1E4),this.l=ca(this.l,a,b),this.r=ca(this.r,a,b),this.t=ca(this.t,c,d),this.b=ca(this.b,c,d),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=function(a,c,b,d){if(1==arguments.length){var e=arguments[0];this.constrain(e.left,e.top,e.right,e.bottom)}else{this.verifyMutable();a=Q(a,1E4);c=Q(c,1E4);b=Q(b,1E4);d=Q(d,1E4);var e=b-a,f=d-c;this.width>=e?(this.l=a,this.r=b,this.w=e):this.left<a?this.left=a:this.right>b&&(this.right=b);this.height>=f?(this.t=c,
this.b=d,this.h=f):this.t<c?this.top=c:this.b>d&&(this.bottom=d)}};e.clone=function(){return new b(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var c=this;this.o!==a&&(c=this.clone(),c.origin=a);return Gb(a.index,c.left,c.top,c.right,c.bottom)};e.readonly=function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";};e.distanceFrom=function(a,c,b,d,e){a=Q(a,
1E4);c=Q(c,1E4);switch(b){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(d){case "top":c-=this.t;break;case "middle":c-=(this.t+this.b)/2;break;case "bottom":c-=this.b;break;case "none":c=0;break;default:c=c<this.t?c-this.t:c>this.b?c-this.b:0}if("xy"===e)e={x:a,y:c,ax:Math.abs(a),ay:Math.abs(c)};else if(0===a&&0===c)e=0;else if(e=Q(Math.sqrt(a*a+c*c),10),0>c||0===c&&0>a)e=
-e;return e};e.convert=function(a){var c=this.o;if(a!==c){var b,d=w.rotation,e=w.zoom;if(a instanceof ob)if("view"===c||"overlay"===c){if(b=a,(c=b.pagePos(c))&&this.offset(-c.left,-c.top),b.features().zoom&&1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/e),b.features().rotate&&0!==d)switch(d){case 90:this.move(b.width-this.b,this.l,b.width-this.t,this.r);break;case 180:this.move(b.width-this.r,b.height-this.b,b.width-this.l,b.height-this.t);break;case 270:this.move(this.t,b.height-this.r,this.b,
b.height-this.l)}}else if(c instanceof ob)c=c.pageRect(),b=a.pageRect(),this.offset(b.left-c.left,b.top-c.top);else throw"Unsupported Rectangle conversion";else if(c instanceof ob)if("view"===a||"overlay"===a){b=c;if(b.features().rotate&&0!==d)switch(d){case 90:this.move(this.t,b.width-this.r,this.b,b.width-this.l);break;case 180:this.move(b.width-this.r,b.height-this.b,b.width-this.l,b.height-this.t);break;case 270:this.move(b.height-this.b,this.l,b.height-this.t,this.r)}b.features().zoom&&"email"!==
b.type&&"rt"!==b.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(c=b.pagePos(a))&&this.offset(c.left,c.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof U)if("view"===c)c=J.padding(),b=J.scrollOffset(),this.left=this.left-c.left+b.left,this.top=this.top-c.top+b.top,a instanceof U&&(c=(b=a.ancestorByClass("oit-overlay"))?a.pos(b):a.pos(u.viewNode),this.left-=c.left,this.top-=c.top);else{if("overlay"===c||c instanceof U)c instanceof U&&(c=
(b=c.ancestorByClass("oit-overlay"))?c.pos(b):c.pos(u.viewNode),this.left+=c.left,this.top+=c.top),"view"===a&&(c=J.padding(),b=J.scrollOffset(),this.left=this.left+c.left-b.left,this.top=this.top+c.top-b.top)}else throw"Unsupported Rectangle conversion";this.o=a}return this};return b}(),nc=function(){var b=function(b){this._rects=[];this.add(b)},e=Z(b);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},
top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,get:function(){return this.boundingRectangle().width}},height:{enumerable:!0,get:function(){return this.boundingRectangle().height}}});e.item=function(b){return this._rects[b]};e.add=function(b){if(b){if(Array.isArray(b))for(var c=0;c<b.length;c++)this._rects.push(b[c]);
else this._rects.push(b);this._boundingRect=null}return this};e.convert=function(b){ga(this._rects,"convert",null,b);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var b=this._rects,c=b[0],a=c.left,e=c.top,g=c.right,k=c.bottom,t=1;t<b.length;t++)c=b[t],c.left<a&&(a=c.left),c.top<e&&(e=c.top),c.right>g&&(g=c.right),c.bottom>k&&(k=c.bottom);this._boundingRect=new ia(a,e,g,k,b[0].origin)}return this._boundingRect};e.interiorRect=function(b,c){for(var a=this._rects,
d=null,e=0,k=0;k<a.length;k++){var t=a[k];if(t.width>=b.width&&t.height>=b.height){d=t;break}else if(!d||t.width>d.width||t.height>d.height){var v=t.width/b.width,q=t.height/b.height,p=Math.min(v,q);c&&(v=t.height/b.width,q=t.width/b.height,p=Math.max(p,Math.min(v,q)));if(!d||p>e)d=t,e=p}}if(d)return d.clone()};return b}(),vb=function(){var b=function(b){U.call(this,"style");b&&this.attr("media",b);this.append(y.createText(""));y.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,
"sheet",{get:function(){return this.dom.sheet}})},e=Z(b,U);e.addCSSText=function(b){this.html(this.html()+b)};e.setCSSText=function(b){this.html(b)};e.setRule=function(b,c){if(c&&this.indexLookup.hasOwnProperty(c))return this.updateRuleByIndex(b,this.indexLookup[c]);try{return this.sheet.insertRule(b,this.rulecount),c&&(this.indexLookup[c]=this.rulecount),this.rulecount++}catch(a){this.logError("setRule","Error inserting style rule: "+a.message)}};e.updateRuleByIndex=function(b,c){if(!isNaN(c)){try{this.sheet.deleteRule(c),
this.sheet.insertRule(b,c)}catch(a){this.logError("updateRuleByIndex","Error updating style rule: "+a.message)}return c}};e.updateRule=function(b,c){this.indexLookup.hasOwnProperty(c)?this.updateRuleByIndex(b,this.indexLookup[c]):this.updateRuleByIndex(b,c)};e.removeFromNames=function(b){for(var c in this.indexLookup)this.indexLookup[c]==b?delete this.indexLookup[c]:this.indexLookup[c]>b&&--this.indexLookup[c]};e.deleteRule=function(b){b=this.indexLookup.hasOwnProperty(b)?this.indexLookup[b]:b;!isNaN(b)&&
b<this.rulecount&&(this.sheet.deleteRule(b),this.removeFromNames(b),this.rulecount--)};e.hasRule=function(b){return this.indexLookup.hasOwnProperty(b)};return b}(),Vc=function(){var b=function(a,c){a/=c/2;if(1>a)return.5*a*a;a--;return-.5*(a*(a-2)-1)},e={ease:b,"ease-in-out":b,"ease-in":function(a,c){a/=c;return a*a*a},"ease-out":function(a,c){a/=c;a--;return a*a*a+1},linear:function(a,c){return a/c}},d="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),c={scrollLeft:!1,
scrollTop:!1},a=[],f=function(c){xc(a,"step",null,c);0<a.length&&eb(f)},g=function(c){var b=c.elem;b&&b.dom&&(b.data("_animation")===c&&b.removeData("_animation"),b.removeClass("oit-animating"));Na(a,c)};D.onreset(function(){ga(a,"finish");a=[];for(var b in c)c.hasOwnProperty(b)&&(c[b]=!1)});var k=function(a,c,b){c=c[a];void 0!==c&&(b[a]=c)},t=function(a,c,b){c=c[a];Fa(c)&&(b[a]=c)},v=function(a,c){var b=a[c];b&&(a.args?b.apply(a.context,a.args):b.call(a.context,a.elem))},q=function(a,c){var b=a[c];
b&&a.elem&&a.elem.dom&&a.elem.css(b)},p=function(g,m){this.elem=g;this.time=void 0!==m.time?m.time:120;t("startFn",m,this);t("stepFn",m,this);t("endFn",m,this);k("context",m,this);m.args&&(this.args=Array.prototype.slice.call(m.args,0),this.args.unshift(g));k("startCSS",m,this);k("endCSS",m,this);this.transFn=e[m.transition]||b;for(var l=w.disableAnimation||0>=this.time,q=0;q<d.length;q++){var p=d[q],v=m[p];if(void 0!==v){var C=g[p];C!=v&&(this.props||(this.props={}),this.props[p]={start:C,end:v},
l|=c[p])}}l||!this.props?this.finish():(a.push(this),g.data("_animation",this),g.addClass("oit-animating"),eb(f))},m=Z(p);m.isEmpty=function(){return 0>=this.time||!this.props};m.step=function(a){var c=!1,b=this.elem;b&&b.dom&&void 0===this.startTime&&(q(this,"startCSS"),v(this,"startFn"),this.startTime=a,this.steps=0,b=this.elem);if(b&&b.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var c=this.props,d;for(d in c){var e=c[d];b[d]=e.start+(e.end-e.start)*a}v(this,
"stepFn");c=!0}c||this.finish();return c};m.finish=function(){var a=this.elem;if(a){var b=this.props,d;if(this.steps&&4>this.steps)for(d in b)c.hasOwnProperty(d)&&(c[d]=!0);g(this);void 0===this.startTime&&(q(this,"startCSS"),v(this,"startFn"));if(a.dom)for(d in b)a[d]=b[d].end;q(this,"endCSS");v(this,"endFn");this.deleteAll()}};m.abort=function(){this.elem&&(g(this),this.deleteAll())};return p}(),Pc=function(){var b=[],e=OIT.DialogBox=function(a){U.call(this,"div","oit-dialog");a=a||{};this._resizable=
this._moveable=this._modal=this._visible=!1;b.push(this);this.css("opacity",0);this._form=y.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);void 0!==a.resizable&&this.resizable(a.resizable);void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",
a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(g(this,S.CANCEL,this.cancel),this.onkeydown(k));a.ok&&g(this,S.OK,this.ok);a.no&&g(this,S.NO,this.no);a.yes&&g(this,S.YES,this.yes);u.rootNode.append(this)},d=Z(e,U),c=function(a){a=this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Yb);return!1},a=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Yb);return!1},f=function(a){this._header.css("cursor",
Xb);return!1},g=function(a,c,b){a._footer||(a._footer=y.create("footer",a),a._footerVisible=!0);c=new cc(c);a._footer.append(c);c.onclick(a,b);c.ontap(a,b)},k=function(a){return 27==a.keyCode?!1:!0},t=function(a){var c=0;a._header&&(a._header.css("cursor",a._moveable?Xb:null),c=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:c+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display",
"none");var b=null;0<c&&(b=a.clientHeight-c+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:b})}};d.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);Na(b,this);U.prototype.destroy.call(this)};d.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};d.moveable=function(a){if(!0===a||!1===a)this._moveable=a,t(this);return this._moveable};d.resizable=function(a,c,b){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=
a;var d,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==c&&(d=c+"px"),void 0!==b&&(e=b+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":d,"min-height":e})}return this._resizable};d.modal=function(a){!0!==a&&!1!==a||a===this._modal||(this._modal=a,oa.showModalOverlay(this._modal));return this._modal};d.title=function(b){if(b){var d;this._header||(this._header=y.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,c),this._header.ondragmove(this,
a),this._header.ondragend(this,f),this._header.ondragcancel(this,f));d=this._header;this._title||(this._title=y.create(),d.append(this._title));this._title.html(b);this._title.css("display",null);d.addClass("oit-dialog-header-shaded");t(this)}else null===b&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),t(this));return this._title?this._title.text():void 0};d.resetForm=function(){this._form.html("")};d.addLabel=function(a,c){var b=
y.create("label",this._form);b.html(a);c&&c.style&&b.css(c.style);return b};d.addTextArea=function(a,c){a&&(this.addLabel(a),y.create("br",this._form));var b=new rc;this._form.append(b);c&&(c.style&&b.css(c.style),c.placeholder&&b.attr("placeholder",c.placeholder));return b};d.show=function(a,c){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)c&&(c.startFn&&c.startFn.call(c.context,this),c.endFn&&c.endFn.call(c.context,this));else{c=c||{};var b=0;!1!==c.animate&&
(b=200);a?(this.startFn=c.startFn,this.startContext=c.context,this.animate({opacity:1,time:b,startCSS:{opacity:0,display:"block"},startFn:v,endFn:c.endFn,context:this}),this._visible=!0,this._modal&&oa.showModalOverlay(!0,b)):(this.animate({opacity:0,time:b,startFn:c.startFn,endCSS:{display:null},endFn:c.endFn,context:c.context}),this._visible=!1,this._modal&&oa.showModalOverlay(!1,b))}return this._visible};var v=function(){t(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;
delete this.startContext};d.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,t(this));return this._footerVisible};d.move=function(a,c,b,d,e){var f=u.viewNode,g=f.size(),f=f.pos();void 0===b&&(b=this.offsetWidth);var m=g.width-10-10;b>m&&(b=m);void 0===d&&(d=this.offsetHeight);m=g.height-10-10;d>m&&(d=m);void 0!==a&&(m=f.left+g.width-10-b,a>m&&(a=m),a=Q(a));void 0!==c&&(g=f.top+g.height-10-d,c>g&&(c=g),c=Q(c));this._visible&&a!==this.offsetLeft||c!==this.offsetTop||
b!==this.innerWidth||d!=this.innerHeight?(g=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:c,innerWidth:b,innerHeight:d,time:g,endCSS:{overflow:null},endFn:q,context:this})):e&&e.endFn&&e.endFn.call(e.context,this)};var q=function(){t(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};d.autoSize=function(a,c,b,d,e){(b=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var f=
["width","height","display","opacity"];d=this.css(f);this.removeCSS(f);this.css("display","block");this.css("opacity","1");var f=this.offsetWidth,g=this.offsetHeight;this.css(d);b&&this.addClass("oit-animating");this.move(a,c,f,g,e)};d.maxsize=function(a,c){var b={};void 0!=a&&(b["max-width"]=0===a?null:a+"px");void 0!=c&&(b["max-height"]=0===c?null:c+"px");this.css(b)};var p=function(a,c){a._visible||a.css("display","block");var b=a[c];a._visible||a.css("display",null);return b};d.width=function(){return p(this,
"offsetWidth")};d.height=function(){return p(this,"offsetHeight")};var m=function(a,c){void 0===a._result&&(a._result=c,a._resultFn&&a._resultFn(a,c))};d.cancel=function(){m(this,!1)};d.ok=function(){m(this,!0)};d.no=function(){m(this,0)};d.yes=function(){m(this,1)};d.result=function(){return this._result};D.onreset(function(){for(;0<b.length;)b.shift().destroy()});return e}();pb("TextRange",function(b,e){if(b>e){var d=b;b=e;e=d}this.type="text";this.acc=b;this.accend=e});pb("CellRange",function(b,
e,d,c,a,f,g,k,t){var v;e>c&&(v=e,e=c,c=v);d>a&&(v=d,d=a,a=v);this.type="cell";this.page=b;this.section=z.page(b).section;this.c1=e;this.r1=d;this.c2=c;this.r2=a;void 0!==f&&(this.offsets="number"===typeof f?{left:f,top:g,right:k,bottom:t}:{left:f.left,top:f.top,right:f.right,bottom:f.bottom})});pb("RectRange",function(b,e,d,c,a,f,g,k){var t;d>a&&(t=d,d=a,a=t);c>f&&(t=c,c=f,f=t);this.type="rect";void 0!==b&&(this.embedId=b);this.page=e;this.left=d;this.top=c;this.right=a;this.bottom=f;this.units=g;
if(void 0!==k)this.section=k;else if(b=z.page(e))this.section=b.section});var Vb=function(){var b=function(c,a,b){U.call(this,"div",a);this._layer=c;this._visible=!0;b?b.append(this):c.append(this);y.attach(this);"none"===this.computedStyleProp("display")&&(this._visible=!1);this.changed()},e=Z(b,U);e.createChild=function(c){return new Ba(this,c)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(c){this.hasClass(c)||(U.prototype.addClass.apply(this,
arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(c){this.hasClass(c)&&(U.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.defaultSize=function(){if(!this._defaultSize){var c=["transform","display","width","height"],a=this.css(c);this.removeCSS(c);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(a)}return this._defaultSize};e.setDefaultSize=function(c){this._defaultSize=c};e.resetDefaultSize=
function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(c){this.attr("title",c)};e.show=function(c){!1!==c&&(c=!0);c!==this._visible&&((this._visible=c)?(this.css("display","block"),this.changed()):this.css("display","none"));return this};e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var c=this.position();if(c){var a={};a.left=c.left;this._borderOffset&&(a.left-=
this._borderOffset.left);a.left+="px";a.top=c.top;this._borderOffset&&(a.top-=this._borderOffset.top);a.top+="px";a.width=c.width+"px";a.height=c.height+"px";this.css(a);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},this._borderOffset.left&&this.css("left",c.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",c.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):
this._layer.changed(this));return this};e.childChanged=function(c){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=function(c){this._dirty&&(c=!0,this._dirty=!1);c&&this.layoutObject();this.queryChildElements(d,c);return this};var d=function(c,a,b){c.update&&c.update(b)};return b}(),Ba=function(){var b=function(b,c){c=c||{};Vb.call(this,b.layer(),c.classList,b);this._parentObject=b;c.title&&this.setTitle(c.title);var a=c.margin||
0;this._margin={left:a,top:a,right:a,bottom:a};void 0!==c.hpos&&(this._hpos=c.hpos);void 0!==c.vpos&&(this._vpos=c.vpos);!0===c.inheritMoveable&&(this.inheritMoveable=!0)},e=Z(b,Vb);e.resize=function(b,c){void 0!==b||void 0!==c?this._size&&this._size.width===b&&this._size.height===c||(this._size={width:b,height:c},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(b,c,a,e){var d=!1;void 0!==b&&b!==this._margin.left&&(this._margin.left=b,d=!0);void 0!==
c&&c!==this._margin.top&&(this._margin.top=c,d=!0);void 0!==a&&a!==this._margin.right&&(this._margin.right=a,d=!0);void 0!==e&&e!==this._margin.bottom&&(this._margin.bottom=e,d=!0);d&&(this._pos&&(this._pos=void 0),this.changed());return this};e.position=function(){if(this._parentObject){var b=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&b.width!=this._parentWidth||b.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=b.width;this._parentHeight=
b.height;var c,a,e,g;if("fill"===this._hpos)c=this._margin.left,e=b.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(e=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,"number"===typeof this._hpos)c=0<=this._hpos?this._margin.left+this._hpos:b.width-this._margin.right-e+this._hpos;else switch(this._hpos){case "left":c=this._margin.left;break;case "center":c=(b.width-e)/2;break;case "right":c=b.width-this._margin.right-e}if("fill"===this._vpos)a=this._margin.top,
g=b.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(g=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)a=0<=this._vpos?this._margin.top+this._vpos:b.height-this._margin.bottom-g+this._vpos;else switch(this._vpos){case "top":a=this._margin.top;break;case "middle":a=(b.height-g)/2;break;case "bottom":a=b.height-this._margin.bottom-g}void 0!==c||void 0!==a||void 0!==e||void 0!==g?(void 0===c&&(c=0),void 0===a&&(a=0),void 0===
e&&(e=this.defaultSize().width),void 0===g&&(g=this.defaultSize().height),this._pos=new ia(c,a,c+e,a+g,"overlay")):this._pos=null}}return this._pos};return b}(),ld=function(){var b=function(b){Ba.call(this,b,{hpos:"center",vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=Z(b,Ba);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);Ba.prototype.destroy.call(this)};e.setText=function(b){this._labelText=b=b||"";this.html(b);this.setTitle(b);this.resetDefaultSize();
this.changed()};e.setColor=function(b,c){this.css("color",b)};e.setBoundingRect=function(b){b?this._parentRect=b.clone():delete this._parentRect;this.show()};e.position=function(){if(this._parentObject){var b=this._parentRect||this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var c="",a=this.defaultSize(),e=a.width+4,g=a.height+4,k=!1;if(e>b.width||g>b.height){if(e>g&&b.width<b.height||e<g&&b.width>b.height)a={width:a.height,height:a.width},
e=a.width+4,g=a.height+4,c="rotate(270deg)",k=!0;if(e>b.width||g>b.height){var t=Q(Math.min(b.width/e,b.height/g),1E3);.4>t?(c="",this.html(""),this.showLabelText=!1):(c+="scale("+t+","+t+")",e=a.width*t+4,g=a.height*t+4)}}this.css("transform",c);if(this.showLabelText)return c=b.left+(b.width-e)/2,b=b.top+(b.height-g)/2,k&&(b+=g),e=c+e,g=b+g,this.show(),new ia(c,b,e,g,"overlay");this.hide()}};return b}(),md=function(){var b=function(a){Ba.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",
inheritMoveable:!0})},e=Z(b,Ba);e.setResizable=function(a){if(a){this._resizable||(this.addClass("oit-resize"),d(this,"oit-resize-n",!1,!0,!1,!1),d(this,"oit-resize-s",!1,!1,!1,!0),d(this,"oit-resize-e",!1,!1,!0,!1),d(this,"oit-resize-w",!0,!1,!1,!1),d(this,"oit-resize-ne",!1,!0,!0,!1),d(this,"oit-resize-nw",!0,!0,!1,!1),d(this,"oit-resize-se",!1,!1,!0,!0),d(this,"oit-resize-sw",!0,!1,!1,!0));var b=a.margin||0;0>b&&this.setMargin(b,b,b,b);this._resizable=a}else this._resizable&&(this._resizeHandles&&
(ga(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var d=function(b,c,d,e,p,m){c=y.create("div",c);c.ondragstart(b,a,d,e,p,m);c.ondragmove(b,f);c.ondragend(b,g);c.ondragcancel(b,g);b.append(c);b._resizeHandles||(b._resizeHandles=[]);b._resizeHandles.push(c)},c=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized})},a=function(a,b,d,e,f){a=this._parentObject.position();this.resizeInfo=
b={left:b,top:d,right:e,bottom:f,startRect:a.clone(),curRect:a.clone(),resized:!1};c("resizestart",this,b);return!1},f=function(a){var b=this.resizeInfo;this.calculateResize(b,a);b.resized=!0;c("resizemove",this,b);if(!this._resizable.bindToObject){a=this._parentObject.position();var d=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(d+b.curRect.left-a.left,d+b.curRect.top-a.top,d+a.right-b.curRect.right,d+a.bottom-b.curRect.bottom)}return!1},g=function(a){a=this.resizeInfo;
if(!this._resizable.bindToObject){var b=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(b,b,b,b)}c("resizeend",this,a);delete this.resizeInfo;return!1};e.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,e=a.startRect.left,f=a.startRect.top,g=a.startRect.right,k=a.startRect.bottom;a.left?(e+=c,g-e<this._resizable.minWidth&&(e=g-this._resizable.minWidth)):a.right&&(g+=c,g-e<this._resizable.minWidth&&(g=e+this._resizable.minWidth));a.top?(f+=d,k-f<this._resizable.minHeight&&
(f=k-this._resizable.minHeight)):a.bottom&&(k+=d,k-f<this._resizable.minHeight&&(k=f+this._resizable.minHeight));return e!=a.curRect.left||f!=a.curRect.top||g!=a.curRect.right||k!=a.curRect.bottom?(a.curRect.move(e,f,g,k),!0):!1};return b}(),nd=function(){var b,e=function(b){Ba.call(this,b,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=ha(b._range);this._startHandle=c(this,a);this._endHandle=c(this,f)},d=Z(e,Ba),c=function(a,b){var c=new Ba(a,{hpos:0,vpos:0,classList:"oit-text-handle"});
c.append(y.create("div")).append(y.create("div")).ondragstart(a,b).ondragmove(a,k).ondragend(a,t).ondragcancel(a,t);return c};d.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",a)};var a=function(a){var b=this._range;return g(this,this._startHandle,a,b.accend,b.acc)},f=function(a){var b=this._range;return g(this,this._endHandle,a,b.acc,b.accend)},g=function(a,b,c,d,e){a._anchor=d;a._focus=e;b=b.pos(u.viewNode);c=c.center;a._adjust={x:16-
(c.x-b.left),y:-(c.y-b.top)};return!1},k=function(a){var b=a.center;if(b&&(a=this._parentObject,b=z.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,!0,!0))){if(void 0===this._textAnchorRoot){var c=b.page.findACC(a._range.acc);this._textAnchorRoot=c?Ua(c[0]):null}if(c=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))c=c.acc,c!=this._focus&&(this._focus=c,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),
this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},t=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;delete this._focus;delete this._adjust;return!1};d.layoutObject=function(){if(this.visible()){var a=this._parentObject;Ba.prototype.layoutObject.call(this);b||(b=this._startHandle.defaultSize());var c=this._parentObject.position();if(c){this.show();var d=v(this._startHandle,
c,a.startHandleRect()),c=v(this._endHandle,c,a.endHandleRect());d||c||(d=z.pagesForRange(a._range),this.show(d&&-1!=d.indexOf(a._page)))}else this.hide()}};var v=function(a,c,d){d?(a.setMargin(d.left-c.left-b.width/2,d.bottom-c.top-1),a.resize(b.width,b.height),a.show()):a.hide();return d};return e}(),Pa=function(){var b=function(a,b,c){Vb.call(this,b,c);this._pos=new ia(0,0,0,0,"overlay")},e=Z(b,Vb);e.setLabel=function(a,b,c){if(a){if(c=c||"#FFF",a!==this._labelText||b!=this._labelColor||c!=this._backgroundColor)if(this._labelText=
a,this._labelColor=b||"#000",this._labelBackground=c||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)b=this._labels[a],b.setText(this._labelText),b.setColor(this._labelColor,this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(ga(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<
a;){var b=new ld(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>a;)this._labels.pop().destroy();return this._labels};e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(a,b,e,k,t){this._pos.movesize(a,b,e,k)&&(this.changed(),this.finishAnimation(),t&&(a=this.position(),t.stepFn&&(this.stepMoveFn=t.stepFn),t.endFn&&
(this.endMoveFn=t.endFn),t={offsetLeft:a.left,offsetTop:a.top,innerWidth:a.width,innerHeight:a.height,transition:t.transition||"ease",time:t.timems,startFn:t.startFn,stepFn:d,endFn:c,context:this},this._animating=!0,this.animate(t)));return this};var d=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},c=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,b){return this.move(void 0,
void 0,a,b)};e.position=function(){return this._pos};return b}(),xb=function(){var b=function(b,c,a){Pa.call(this,b,c,a)},e=Z(b,Pa);e.customEvent("resizestart");e.customEvent("resizemove");e.customEvent("resizeend");e.activate=function(b,c){this._rectActivation||(this._rectActivation=new md(this),c&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),
delete this._rectActivation);return this};e.resizable=function(b,c){if(!0===b){c=c||{};var a=!0,d=c.minWidth||0,e=c.minHeight||0,k=c.margin||0;!1===c.bindToObject&&(a=!1);this._resizable&&this._resizable.bindToObject==a&&this._resizable.onResizeStart==c.onResizeStart&&this._resizable.onResize==c.onResize&&this._resizable.onResizeEnd==c.onResizeEnd&&this._resizable.onResizeCancel==c.onResizeCancel&&this._resizable.context===c.context&&this._resizable.minWidth==d&&this._resizable.minHeight==e&&this._resizable.margin==
k||(this._resizable={bindToObject:a,minWidth:d,minHeight:e,margin:k},c.onResizeStart&&(this._resizable.onResizeStart=c.onResizeStart),c.onResize&&(this._resizable.onResize=c.onResize),c.onResizeEnd&&(this._resizable.onResizeEnd=c.onResizeEnd),c.onResizeCancel&&(this._resizable.onResizeCancel=c.onResizeCancel),this._resizable.context=c.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===b&&(delete this._resizable,this._rectActivation&&
this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Pa.prototype.layoutObject.call(this),this._labelText)){var b=this.position().clone();b.left=0;b.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(b)}return this};return b}(),od=function(){var b=function(b,c,a){Pa.call(this,b,c,a);b=this.defaultSize();this.move(void 0,void 0,b.width,b.height)},e=Z(b,Pa);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};
e.deactivate=function(){this.removeClass("oit-active");return this};return b}(),pd=function(){var b=function(b,c,a,e){var d=["oit-badge"];a&&d.push(a);Pa.call(this,b,c,d);this.resize(20,20);this.text(e)},e=Z(b,Pa);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return b}(),qd=function(){var b=function(b,a,d){Pa.call(this,b,a,d);this._page=z.page(b)},e=Z(b,Pa);e.customEvent("textmove");e.customEvent("textmoveend");
e.activate=function(b){this._textActivation||(this._textActivation=new nd(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};e.deactivate=function(){this._textActivation&&(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(b){if(b&&"text"===b.type)if(!this._range)this._range=ha(b),this.changed();else if(this._range.acc!=b.acc||this._range.accend!==b.accend)this._range.acc=b.acc,this._range.accend=b.accend,this.changed();
return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var b=this._page.textBoundingRect(this._range);b&&(b.origin="overlay",this.move(b.left,b.top,b.width,b.height));Pa.prototype.layoutObject.call(this);if(this._labelText){var a=this._page.textRects(this._range,
"overlay"),b=this._page.textBoundingRect(this._range);if(a&&b&&(b.origin="overlay",this.allocateLabelChildren(a.length),0<this._labels.length))for(var d=this.getLabelChild(0).defaultSize(),e=0;e<this._labels.length;e++){var k=this.getLabelChild(e);k.setDefaultSize(d);this._moveable?k.addClass("oit-moveable"):k.removeClass("oit-moveable");var t=a[e].interiorRect(d,!0);t&&t.offset(-b.left,-b.top);k.setBoundingRect(t)}}}return this};var d=function(b,a,d){var c=b._page.accRect(a,"overlay");if(!c)for(var e=
0<d?1:-1,f=e;!(c=b._page.accRect(a+f,"overlay"))&&f!=d;f+=e);c&&(c.width=0);return c};e.startHandleRect=function(){if(this._range)return d(this,this._range.acc,1)};e.endHandleRect=function(){if(this._range)return d(this,this._range.accend,-2)};return b}(),rd=function(){var b=function(b,a,d){U.call(this,"div","oit-drawinglayer oit-drawinglayer-"+a,d);this._drawing=b;this._name=a;this._visible=!0;y.attach(this);b.append(this);this.show()},e=Z(b,U);e.drawing=function(){return this._drawing};e.show=function(b,
a){void 0===b&&(b=!0);b!==this._visible&&(!0===b?(this._visible=!0,this.css("display",null),!1!==a&&this.update(!0)):!1===b&&(this._visible=!1,this.css("display","none")))};e.hide=function(){this.show(!1)};e.visible=function(){return this._visible};e.update=function(b){this.queryChildElements(d,b)};var d=function(b,a,d){b.update&&b.update(d)};e.changed=function(){this._drawing.changed()};return b}(),dd=function(){var b=function(b){U.call(this,"div","oit-drawingpanel");y.attach(this);this._origin=
null;b.append(this);b.onscroll(this,this.updateScroll)},e=Z(b,U);e.destroy=function(){var b=this.parent();b&&b.offscroll(this.updateScroll);U.prototype.destroy.call(this)};e.update=function(b){!0!==b&&(b=!1);this._animationFrame&&(this._animationFrame=null);this.queryChildElements(d,b)};var d=function(b,a,d){b.update&&b.update(d)};e.changed=function(){this._animationFrame||(this._animationFrame=eb(this.update,this))};e.setOrigin=function(b,a){if(!this._origin)this._origin={x:b,y:a},this.updateScroll();
else if(this._origin.x!=b||this._origin.y!=a)this._origin.x=b,this._origin.y=a,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};e.updateScroll=function(){if(this._origin){var b=this.parent().scroll();this.css({left:this._origin.x+b.left+"px",top:this._origin.y+b.top+"px"})}};return b}(),yb=function(){var b=function(a,b,c){U.call(this,a);this.acc=b;this.accend=c;void 0===this.accend&&(a=y.data(this,"accend"))&&(this.accend=Number(a));void 0===
this.accend&&(this.accend=b+this.text().length)},e=Z(b,U);e.destroy=function(){this.unload();U.prototype.destroy.call(this)};e.unload=function(){c(this,null,null)};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var c=new b("span",this.acc,a);this.copyDataTo(c);var d=this.text(),e=a-this.acc;c.text(d.substring(0,e));this.text(d.substring(e));
this.acc=a;this._changed=!0;return c};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=function(a){var b=!1,c=this._data;a=a._data;if(!c)b=!a;else if(a&&c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var e=c[d],v=a[d];if(e.type!==v.type||e.id!==v.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=
function(a){if(this._data)for(var b=0;b<this._data.length;b++){var c=this._data[b];if(c.type===a.type&&c.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=function(a,b){if(this._data)for(var c=0;c<this._data.length;c++){var d=this._data[c];if(d.type===a&&d.id===b){this._data.splice(c,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=
function(a){this._data&&(d(this,null,null,null,null),a._data=a._data?a._data.concat(this._data):this._data,delete this._data,this._changed=!0,a._changed=!0)};e.updateData=function(){if(this._changed){var a=null,b=null,c=null,e=null,t=void 0;if(this._data)for(var v=0,q=0;q<this._data.length;q++){var p=this._data[q];if("style"===p.type){if(p.className&&(e||(e=[]),e.push(p.className)),p.props)for(var m in p.props)if(p.props.hasOwnProperty(m)){var l=p.props[m];if("background-color"==m){var u=p.priority||
0;void 0===t||u>t?(t=u,v=1,c||(c={}),c[m]=l):u==t&&(c[m]=ec(l,c[m],v,!0),v++)}else c||(c={}),c[m]=l}}else"hyperlink"===p.type?a=p:"bookmark"===p.type&&(b=p)}d(this,c,e,a,b);this._changed=!1}};var d=function(a,b,d,e,t){b?(b=Oc(b),b!=a._splitClass&&(a._splitClass&&a.removeClass(a._splitClass),a.addClass(b),a._splitClass=b)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);a._appliedClasses&&(a.removeClass(a._appliedClasses),delete a._appliedClasses);d&&(a.addClass(d),a._appliedClasses=
d);c(a,e,t)},c=function(a,b,c){var d=a._anchor;if(b){var e=b&&0===b.url.indexOf("#");d||(d=e?a._anchor=y.create("span"):a._anchor=y.create("a"),d.text(a.text()),a.html(""),a.append(d));b&&(a.addClass("oit-hyperlink"),e||d.attr("href",b.url),Mc.on.addElement(d,b));c&&d.attr("id",c.id)}else c?a.attr("id",c.id):d&&(Mc.on.removeElement(d),b=d.text(),d.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(b))};return b}(),sd=function(){var b=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),
e=function(a,b,c){yb.call(this,a,b);this._origin=c},d=Z(e,yb);d.unload=function(){this.discardLayout();ga(this._splits,"unload");yb.prototype.unload.call(this)};d.discardLayout=function(){delete this._charRects;delete this._spanRect};d.distanceFromPoint=function(a,b){var c=this.findClosestChar(a,b);if(c)return c.distance};d.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return sa(this.acc,this.accend);if(b=f(this)){for(var c,d,e=0;e<b.length;e++)a.overlaps(b[e])&&
(d=this.acc+e,void 0===c&&(c=d),d+=1);if(void 0!==c)return sa(c,d)}}};d.spanRect=function(){var a=this._spanRect;a||(a=z.elementRect(this,this._origin),0<a.width&&0<a.height&&(this._spanRect=a));return a};d.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};d.rtl=function(){void 0===this._rtl&&(this._rtl=!!b.test(this.text()));return this._rtl};d.findClosestChar=function(a,b){var c=
f(this),d,e,g;for(d=0;d<c.length;d++){var m=Math.abs(c[d].distanceFrom(a,b,"left","middle"));if(void 0===e||m<g)e=d,g=m,d==c.length-1&&(m=c[d].distanceFrom(a,b,"center","none"),0<m&&e++)}var l,k;if(this._splits){c=this._splits;for(d=m=0;d<c.length;d++){var F=c[d].textNode(),N=m+F.textContent.length;if(e>=m&&e<N){l=F;k=e-m;break}m=N}l||(l=c[c.length-1].textNode(),k=l.textContent.length)}else l=this.textNode(),k=e;return{node:l,offset:k,acc:this.acc+e,distance:g}};d.textRect=function(a){var b=this.spanRect();
if(this.hasClass("oit-hiddentext"))return new ia(b);if(0===b.width||0===b.height)return null;if(!a||a.acc<=this.acc&&a.accend>=this.accend)return new ia(b);if(a.acc<this.accend&&a.accend>this.acc){var c=this.text(),b=a.acc-this.acc;0>b&&(b=0);a=a.accend-this.acc;a>c.length&&(a=c.length);if((c=f(this,b,a))&&0<c.length){var d;d=new ia(c[b],this._origin);a==b&&(d.width=0);for(b+=1;b<a;b++)d.union(c[b]);return d}}};d.findTextRange=function(a,b){var c,d,e,f,g=this._splits;if(g){if(a.acc<=this.acc&&(c=
g[0].textNode(),d=0),a.accend>=this.accend&&(e=g[g.length-1].textNode(),f=e.textContent.length),!c||!e)for(var l=0;l<g.length;l++){var k=g[l];if(a.accend<k.acc)break;if(!c&&a.acc<k.accend&&(c=k.textNode(),d=a.acc-k.acc,0>d&&(d=0),e))break;if(c&&!e&&a.accend<=k.accend){e=k.textNode();f=a.accend-k.acc;0>f&&(f=0);break}}}else c=e=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),f=this.text().length,a.accend<this.accend&&(f-=this.accend-a.accend);g=Y.createRange();g.setStart(c,d);g.setEnd(e,f);
b.push(g)};var c=function(a,b,c,d){c._charRects.push(new ia(a.rect(d),d))},a=function(b,c,d,e,f,p,m,l,u){var g;b=y.unwrap(b);if(3==b.nodeType){if(g=b.textContent.length,c<=u&&c+g>=l)for(l-=c,0>l&&(l=0),u-=c,u>g&&(u=g),g=l;g<u;g++)m[g+c]||(p.setStart(b,g),p.setEnd(b,g+1),l=p.getBoundingClientRect(),l=new ia(l.left-f.left,l.top-f.top,l.right-f.left,l.bottom-f.top,e),l.origin=d._origin,m[g+c]=l)}else for(g=0;g<b.childNodes.length&&c<=u;g++){var k=b.childNodes[g],q=c+k.textContent.length;l<=q&&c<=u&&
a(k,c,d,e,f,p,m,l,u);c=q}},f=function(b,d,e){d||(d=0);e||(e=b.text().length);var f=Y.createRange?Y.createRange():null;if(f&&f.getBoundingClientRect)try{var g,k;b._origin instanceof U&&!(b._origin instanceof ob)?(g=b._origin,k=g.rect()):(g="view",k=u.viewNode.rect());var m=b._charRects||[];a(b,0,b,g,k,f,m,d,e);b._charRects=m}catch(l){}else if(!b._charRects){f=b.text();e=new U;e.transferFrom(b);g=[];for(d=0;d<f.length;d++)g.push("<span>"),g.push(f[d]),d+1<f.length&&(k=f.charCodeAt(d),m=f.charCodeAt(d+
1),1536<=k&&1791>=k&&1536<=m&&1791>=m&&g.push("&zwj;")),g.push("</span>");b.html(g.join(""));b._charRects=[];b.forChildElements(c,b,b._origin);d=new ia(b.rect(b._origin),b._origin);b.html("");b.transferFrom(e);f=b.spanRect();if(f.width!=d.width&&(e=f.width/d.width,!fc(e,1)))for(f=f.left,d=0;d<b._charRects.length;d++)g=b._charRects[d],k=(g.left-f)*e+f,g.move(k,void 0,k+g.width*e,void 0)}return b._charRects};d.createSplit=function(){var a=new yb("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);
return a};d.updateData=function(){var a=this._splits;a?ga(a,"updateData"):yb.prototype.updateData.call(this)};d.split=function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&a.accend>=this.accend||this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,c=[],d=0;d<b.length;d++){var e=b[d],f;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(f=e.createSplit(a.acc),b.splice(d++,0,f),this.insert(f,e));
a.accend<e.accend&&(f=e.createSplit(a.accend),b.splice(d++,0,f),this.insert(f,e),e=f);c.push(e)}}return c};d.join=function(){var a=this._splits;if(a){for(var b,c=a[a.length-1],d=a.length-2;0<=d;d--)b=a[d],b.dataEquals(c)&&(b.mergeSplit(c),a.splice(d+1,1)),c=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};d.addDataToRange=function(a,b){var c=this.split(a);c&&(ga(c,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&f(this))};d.changeData=
function(a){yb.prototype.changeData.call(this,a);ga(this._splits,"changeData",null,a);this.updateData()};d.removeData=function(a,b){yb.prototype.removeData.call(this,a,b);ga(this._splits,"removeData",null,a,b);this.join();this.updateData()};return e}(),Qc=function(){var b=function(b,c){var a,d,e;this._page=b;this._contentRoot=c||b;this._spans=[];if(1024<this._contentRoot.text().length)for(a=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),d=a.firstACCNode();d;){e=a.currentNode;var k=!0;
for(d=e.firstChild;d;d=d.nextSibling)if(3!==d.nodeType){k=!1;break}if(k&&1024<e.textContent.length){(d=a.skipNode())&&(d=a.firstACCNode());for(var k=e.textContent,t=[],v=0;v<k.length;v+=1024){var q=k.substring(v,v+1024),q=Bb(q);t.push("<span>",q,"</span>")}e.innerHTML=t.join("");e.textContent.length!=k.length&&(e.textContent=k)}else d=a.nextACCNode()}var p;a=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(d=a.firstACCNode();d;){e=a.currentNode;(d=y.data(e,"acc"))&&(p=Number(d));k=
!0;for(d=e.firstChild;d;d=d.nextSibling)if(3==d.nodeType){k=!1;break}k||void 0===p?d=a.nextACCNode():(e=new sd(e,p,this._contentRoot),this._spans.push(e),p=e.accend,(d=a.skipNode())&&(d=a.firstACCNode()))}this._layoutSettings={};if(!b.checkedACCRange){if(a=this.getTextRange())a.acc<b.acc&&(b.acc=a.acc),a.accend>b.accend&&(b.accend=a.accend);b.checkedACCRange=!0}},e=Z(b);e.destroy=function(){ga(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){ga(this._spans,"discardLayout")};e.getTextRange=
function(){for(var b,c=0;c<this._spans.length;c++){var a=this._spans[c];b?(a.acc<b.acc&&(b.acc=a.acc),a.accend>b.accend&&(b.accend=a.accend)):b=sa(a.acc,a.accend)}return b};e.textRanges=function(){for(var b=[],c,a=this._page.isEmailHeader(),e=0;e<this._spans.length;e++){var g=this._spans[e];!a&&c&&c.accend+1>=g.acc?g.accend>c.accend&&(c.accend=g.accend):(c=sa(g.acc,g.accend),b.push(c))}return b};e.mapPointToSpan=function(b,c,a){if(0<this._spans.length){var d,e,k,t;this._page.pushShow();var v=[],q;
for(t=0;t<this._spans.length;t++)if(k=this._spans[t],!k.hasClass("oit-hiddentext")&&(!a||k.equals(a)||k.isDescendantOf(a))&&(e=k.spanRect())&&0<e.width&&0<e.height){e=c<e.top?e.top-c:c>e.bottom?c-e.bottom:0;if(void 0===q||e<q)v.length=0,q=e;e==q&&v.push(k)}q=void 0;if(1==v.length)d=v[0];else for(t=0;t<v.length;t++)if(k=v[t],e=Math.abs(k.distanceFromPoint(b,c)),void 0===q||e<q)d=k,q=e;this._page.popShow();return d}};e.findOverlappingText=function(b){if(0<this._spans.length){var c=[];this._page.pushShow();
for(var a=0;a<this._spans.length;a++){var d=this._spans[a].overlapRange(b);d&&c.push(d)}this._page.popShow();if(0<c.length)return c}};e.findRange=function(b,c){for(var a=[],d=0;d<this._spans.length;d++){var e=this._spans[d];e.acc<=c&&e.accend>b&&a.push(e)}if(0<a.length)return a};e.findACC=function(b){for(var c=[],a=0;a<this._spans.length;a++){var d=this._spans[a];b>=d.acc&&b<d.accend&&c.push(d)}if(0<c.length)return c};return b}(),ob=function(){function b(a){a._loadingSkeleton||(a._loadingSkeleton=
y.create("div","skeleton-overlay generic"),a.append(a._loadingSkeleton))}function e(a){a._loadingSkeleton&&(a._loadingSkeleton.destroy(),delete a._loadingSkeleton)}var d=/\S/,c=function(a,c,d){var e=Y.getElementById(d);e?U.call(this,e):U.call(this,"div","oit-section oit-"+c+" oit-pending",d);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem();this._revisions=[];b(this)},a=Z(c,U);a.processData=function(a){var b=this.isEmailHeader(),c={},d=!1,
e=!1,h;for(h in a){var n=a[h],g=null,r=!1;switch(h){case "embeds":case "frames":case "fields":case "attachments":case "comments":g="_"+h;break;case "data":case "src":case "href":g="_"+h+"URL";break;case "section":case "name":case "type":case "media":case "media_subtype":case "dpi":case "autodpi":case "hiddenFromSlideshow":g=h;break;case "acc":case "accend":g=h;r=!0;break;case "w":b||this.css("width",n);g="width";n=parseInt(n,10);r=!0;break;case "h":b||this.css("height",n);g="height";n=parseInt(n,
10);r=!0;break;case "oid":(n=z.overlayById(a.oid))&&n!==this.overlay&&(g="overlay",e=!0);break;case "background":this.css("background",n)}g&&!this.hasOwnProperty(g)&&(c[g]={value:n,writable:r,enumerable:!1},d=!0)}"sn"!==this.type||this.width||(b=z.page(this.index-1))&&b.width&&(c.width={value:b.width,writable:!1,enumerable:!1},d=!0,this.css("width",b.css("width")),J.layoutChanged());d&&Object.defineProperties(this,c);e&&this.overlay.add(this);a.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=
a.content:f(this,a.content));!this._ssmodel&&a.ssdata&&(this._ssmodel=new td(a.ssdata,this._embeds,this));if(a.comments){if(this.supportsAnnotations()){d=c=!1;la.infoRaw();for(e=0;e<a.comments.length;e++)b=a.comments[e],b.range&&b.text?c=!0:d=!0;c&&D.hiddenContent("comments");d&&D.hiddenContent("comments-unsupported")}else D.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===a.type&&D.hiddenContent("speaker-notes");a.hiddenFromSlideshow&&D.hiddenContent("hidden-slides");
a.hidden_columns&&D.hiddenContent("hidden-columns");a.hidden_rows&&D.hiddenContent("hidden-rows");this._staticContent&&(m(this,!1),R(this))};a.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};a.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};a.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};
var f=function(a,b){var c=y.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var f=0;f<e.length;f++){var n=e[f],h=z.pageById(n.id);h&&!h.firstChildElem()&&(u.baseURL&&l(n),h.transferFrom(n),h.addClass(n.attr("class")))}}else u.baseURL&&l(c),a.transferFrom(c),a._needArrange=!0};a.destroy=function(){this.unload();U.prototype.destroy.call(this)};a.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=
!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&z.on.pageunload.dispatch(this)};a.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();
a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=z.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&a.endFn&&a.endFn();"vertical"===w.scrollMode&&(b=z.page(this.index+1))&&"sn"===b.type&&w.showSlideNotes&&b.show()}else a&&a.endFn&&
a.endFn();return this};a.hide=function(){var a=y.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===w.scrollMode&&(a=z.page(this.index+1))&&"sn"===a.type&&a.hide());return this};a.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=
!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};a.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&
(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};a.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};a.filter=function(a){return a!==this.index};a.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:va.features(this.type),comments:!!this._annotationPane};if("slide"==a.type){var b=z.page(this.index+1);b&&"sn"===b.type?a.notes=!0:y.byId(this.id+".note")?a.notes=
!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==z.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);return a};a.features=function(){return va.features(this.type)};a.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||
"emailheader"===this.id||"emailheader.1"===this.id};a.isPending=function(){return this.hasClass("oit-pending")};a.isLoading=function(){return this.hasClass("oit-loading")};a.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};a.isEnabled=function(){return"slideshow"!=w.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};a.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,
b,c));if(e){var f=e.textAngle();c=e.spanRect();d=c.left;var n=c.top,h=c.right,g=c.bottom;if(0!==f){c=[{x:d,y:n},{x:h,y:n},{x:h,y:g},{x:d,y:g}];d=Math.cos(f);n=Math.sin(f);for(h=0;h<c.length;h++)g=c[h].x-a,f=c[h].y-b,c[h].x=a+g*d+f*n,c[h].y=b+-g*n+f*d;d=h=c[0].x;n=g=c[0].y;for(f=1;4>f;f++){var r=c[f];r.x<d?d=r.x:r.x>h&&(h=r.x);r.y<n?n=r.y:r.y>g&&(g=r.y)}}e=e.findClosestChar(a,b);e.overlaps=a>=d-2&&a<=h+2&&b>=n-2&&b<=g+2;return e}};a.findTextBoundary=function(a,b,c){a=Pb(a);if(ja&&void 0!==a&&(a+=b,
b=ja.findBoundaryStart(a,c),c=ja.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=sa(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var f=this._frames[b];a>=f.acc&&a<f.accend&&(void 0===d?(d=f.acc,e=f.accend):(f.acc<d&&(d=f.acc),f.accend>e&&(e=f.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return lc(d)}};a.resetCache=function(){delete this._cachedRects;if(this._annotationPane)this._annotationPane.onResize(!0)};var g=function(a){var b=a._cachedRects;
b||(b=a._cachedRects={});var c=u.viewNode,d=c.clientWidth,e=c.clientHeight,f=c.scroll(),c=f.left,f=f.top,n=a.offsetLeft;a=a.offsetTop;var h=w.zoom,g=w.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=f||b.offsetLeft!=n||b.offsetTop!=a||b.zoom!=h||b.rotation!=g)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=f,b.offsetLeft=n,b.offsetTop=a,b.zoom=h,b.rotation=g;return b};a.pageRect=function(a){var b=g(this);if("view"===a||"overlay"===
a){var c=b[a];c||((c=J.pageRect(this.index,a))&&c.readonly(!0),b[a]=c);return c}b.page||(b.page=J.pageRect(this.index,this));return b.page};a.pagePos=function(a){if("overlay"===a)return a=g(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var b=J.padding();b&&(a.left+=b.left,a.top+=b.top);if(b=J.scrollOffset())a.left-=b.left,a.top-=b.top;return a}};a.inAnnotation=function(a){var b=!1;if("text"===a.type&&!this.findRange(a.acc,a.accend,
"page")){var c;this._annotationPane&&(c=this._annotationPane.findRange(a.acc,a.accend));if(c)b=!0;else if(this._comments)for(c=0;c<this._comments.length;c++){var d=this._comments[c];if(d.text){for(var e=0;e<d.text.length;e++){var f=d.text[e].range;if(f&&cb(a,f)){b=!0;break}}if(b)break}}}return b};a.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&
!b.hasPendingContent()?(b=b.containsRange(a),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&(b=z.isAnnotationText(a.acc,
a.accend,this._comments))}return b};var k=function(a,b){return a.acc-b.acc},t=function(a,b){if(b&&0<b.length){b.sort(k);for(var c=[],d,e=a.isEmailHeader(),f=0;f<b.length;f++){var n=b[f];void 0!==n.acc&&(!e&&d&&d.accend+1>=n.acc?n.accend>d.accend&&(d.accend=n.accend):(d=sa(n.acc,n.accend),c.push(d)))}return c}};a.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();if(b)return a=new ia(a,this),t(this,b.findOverlappingText(a))}};a.textRanges=function(){var a=this.getSpanMap();
if(a)return t(this,a.textRanges())};a.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=J.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var f=e.left,n=e.top;e.intersect(a);e.offset(-f,-n);b||(b=[]);d=Gb(d.uid,this.index,e.left,e.top,e.right,e.bottom);xa(d,"pct");b.push(d)}}return b};a.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&(b=this._embeds[a]);
return b};a.embeddingByUID=function(a){var b;this._embeds&&(b=gb(this._embeds,"uid",a));return b};a.embeddingRect=function(a){if(this._embeds&&(a=gb(this._embeds,"uid",a))){var b;if(a.position)b=a.position,b=new ia(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=y.byId(a.id);e&&(e=z.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&void 0!=d&&(b=new ia(c,d,c+a.w,d+a.h,this))}return b}};a.textBoundingRect=function(a,b){if(this.isLoaded()&&
"text"===a.type){var c;if(this.isSpreadsheet())z.activeOverlay()==this.overlay&&(c=J.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=Ua(d[0]),f=0;f<d.length;f++){var n=d[f].textRect(a);if(n){var h=Ua(d[f]);y.unwrap(h)===y.unwrap(e)&&(c?c.union(n):c=n)}}c||1!=d.length||(c=d[0],e=ha(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};a.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&"text"===a.type)for(var c=
0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=y.byId(d.id);break}}return b};a.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&(c=c.slice());else{if(this.isSpreadsheet()&&z.activeOverlay()==this.overlay){var d=J.rangeRect(a,b);d&&(e=[new nc(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});for(var f,n=[],d=0;d<
c.length;d++){var h=c[d].textRect(a);h&&(f&&fc(h.top,f.top)&&fc(h.bottom,f.bottom)&&h.left<=f.right+1?f.union(h):(f=h,n.push(f)))}this.popShow();if(0<n.length)for(e||(e=[]),a=new nc(n[0]),e.push(a),d=1;d<n.length;d++)if(c=n[d],8>c.width||8>c.height)a.add(c);else{for(var h=c.left-5,g=c.right+5,r=c.top-2,m=c.bottom+2,B=a.length-1;0<=B;B--)if(f=a.item(B),g>=f.left&&h<=f.right&&m>=f.top&&r<=f.bottom){a.add(c);c=null;break}c&&(a=new nc(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||ga(e,"convert",null,b));
return e}};a.accRect=function(a,b){var c,d=sa(a,a+1);if(this.isSpreadsheet())c=J.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var f=Ua(e[0]),h=0;h<e.length;h++){var g=e[h].textRect(d);if(g){var r=Ua(e[h]);y.unwrap(r)===y.unwrap(f)&&(c?c.union(g):c=g)}}c&&(c.origin=b);this.popShow()}}return c};a.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(this._frames&&"email"!==this.type)for(var d=0;d<this._frames.length;d++){var e=
this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=Y.getElementById(e.id))&&0===e.childNodes.length){var f=Y.createRange();f.setStart(e,0);f.setEnd(e,0);b.push(f)}else c=!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&ga(c,"findTextRange",null,a,b);if(0<b.length)return b}};a.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};a.hasSelectionRect=function(){return!!this._selRect};a.selectionRect=function(){if(!this._selRect){var a=
this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new xb(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};a.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};a.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,b))&&(d=d?d.concat(a):a);return d};a.findACC=function(a){var b,c=this.getSpanMap();
c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};a.pageContentChanged=function(){delete this._cachedRects;this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};a.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};a.isSpreadsheet=function(){return this._ssmodel||this._dataURL};a.spreadsheetModel=function(){return this._ssmodel};
a.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Qc(this));return this._spanMap};var v=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=oa.createProgressDialog(S.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},q=function(a){if(void 0===a.srcRequest&&void 0===
a.dataRequest&&a.isLoading()){D.resumeIdleTimer("pageload");a.logLoad&&a.logLoad();a.removeClass("oit-loading");e(a);a.pageContentChanged();z.touchPage(a.index);a.loadedSize=0;a.dataSize&&(a.loadedSize+=a.dataSize);a.srcSize&&(a.loadedSize+=a.srcSize);z.applyMemoryLimit(a.loadedSize);a.deferredContent&&(f(a,a.deferredContent),delete a.deferredContent,delete a.deferContent);m(a,!0);a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog);delete a.showProgressDialog;if(a.completionFuncs){for(var b=
0;b<a.completionFuncs.length;b++)a.completionFuncs[b](a);delete a.completionFuncs}delete a.locked;R(a)}},p=function(a){if(a&&"multimedia"==a.type){var b=a._hrefURL;u.baseURL&&"/"!=b.charAt(0)&&(b=Ra(u.baseUrl,b));"string"!==typeof a.media&&a.logError("OIPage","page of type 'multimedia' is missing 'media' property. using default of 'video'.");var c;switch(a.media){case "audio":c=ud;break;case "video":c=Rc;break;default:c=Rc,a.logError("OIPage","'media' property is invalid. got '"+a.media+"' but expected either 'audio' or 'video'. defaulting to 'video'")}return new c(b,
a)}a.logError("OIPage","cannot create a media player unless the 'page.type' is 'media'")},m=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new vd(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=y.create("div","oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+
S.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=y.create("div","oit-hiddenpage"),c.attr("title",S.HIDDEN_SLIDE),a.append(c));"multimedia"===a.type&&(a._player?a.append(a._player):this.logError("OIPage","missing 'page._player'. expected to be set after page loaded."));V(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();z.on.pageload.dispatch(a,!!b)},l=function(a){a=y.wrap(a);if(u.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);
for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Ra(u.baseURL,c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Ra(u.baseURL,c)),b.setAttribute("xlink:href",c))}};a.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(lb(this.srcRequest),delete this.srcRequest),this.dataRequest&&(lb(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"),
b(this))};a.load=function(a,b){var c=this,d=c.isPending(),f=c.isLoading();if((d||f)&&(c._srcURL||c._dataURL||c.media))if(f)b&&c.completionFuncs.push(b);else{c.dataSize=0;c.dataLoaded=0;c.srcSize=0;c.srcLoaded=0;c.completionFuncs=[];b&&c.completionFuncs.push(b);c.removeClass("oit-pending");c.addClass("oit-loading");c.locked=!0;!0===a&&(c.showProgressDialog=!0);d=u.baseURL;c._dataURL&&(f=c._dataURL,d&&"/"!=f.charAt(0)&&(f=Ra(d,f)),c.dataRequest=Ma({url:f,context:c,loading:K,complete:F}));c._srcURL&&
(f=c._srcURL,d&&"/"!=f.charAt(0)&&(f=Ra(d,f)),c.srcRequest=Ma({url:f,context:c,loading:N,complete:H}));if(c.media){N.call(c,0,"");var h=p(c);c._player=h;var n=function(a,b){a==h&&(Oa.on.loaded.unlisten(n),q(c))};Oa.on.loaded.listen(n);h.load()}(c.dataRequest||c.srcRequest)&&D.pauseIdleTimer("pageload")}else d&&(c.removeClass("oit-pending"),m(c,!1)),e(c),b&&b(c)};var K=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);v(this)},F=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=c.length,
v(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(X){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",a,d,c);delete this.dataRequest;q(this)},N=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);v(this)},H=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=c.length,v(this));200===d?(this.deferContent=!0,fa.isICD(c)?fa.processICD(c,
a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;q(this)},R=function(a){var b=la.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():null,d=c?c.nextSiblingElem():null,e=d?d.nextSiblingElem():null,f=e?e.nextSiblingElem():null,h=c?c.firstChildElem():null,g=h?h.firstChildElem():null,m=d?d.firstChildElem():null,r=e?e.firstChildElem():null,B=r?r.firstChildElem():null,
l=B?B.firstChildElem():null,V=l?l.firstChildElem():null;if(g&&!g.nextSiblingElem()&&m&&!m.nextSiblingElem()&&V&&!V.nextSiblingElem()){var k=r.size(),p=V.size(),q=!0;k&&p&&0<k.width&&0<k.height&&0<p.width&&0<p.height&&(q=p.height/k.height,q=.9<=p.width/k.width&&.9<=q);"DIV"==b.tagName&&b.hasClass("oit-svg")&&"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&"svg"==h.tagName&&"rect"==g.tagName&&"DIV"==m.tagName&&
m.hasClass("oit-svg-text")&&"svg"==r.tagName&&"g"==B.tagName&&B.hasClass("oit-pagescale")&&"g"==l.tagName&&l.hasClass("oit-framescale")&&"image"==V.tagName&&!f&&q&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",D.screenCSS(a+" div","color:rgba(0,0,0,0);"),D.screenCSS(a+" span","color:rgba(0,0,0,0);"),b.append(d))}}};a.comments=function(){return this._comments};var C=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)C(a[c],b);else if(a.range&&"text"===a.range.type){if(void 0===b.acc||
a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},M=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)M(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ja.getRawText(a.range.acc,a.range.accend))},G=function(a){var b="";if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)b+=G(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},h=function(a,b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;
else{b.supportsAnnotationBar()&&z.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));w.showAnnotations&&a.layout()}},B=function(a,b){a._annotationPane||(a._annotationPane=new wd(a),w.showAnnotations?a._annotationPane.show():a._annotationPane.hide(),T.addAutoscrollRoot(a._annotationPane.scrollPane()));a._annotationPane.processAnnotations(b,h,a)},V=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d={},e=0;e<b.length;e++){var f=b[e];C(f.text,
d);C(f.author,d);C(f.author_short,d);C(f.last_save_date,d);C(f.create_date,d);C(f.date,d)}void 0!==d.acc?ja.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];M(e.text);M(e.author);M(e.author_short);M(e.last_save_date);M(e.create_date);M(e.date)}c&&(b=c(a,b));B(a,b)}):(c&&(b=c(a,b)),B(a,b))}},I=function(a,b){var c=!1;-1!=a._revisions.indexOf(b)&&(c=!0);return c};a.processRevisions=function(){if(this.isLoaded()&&this.supportsAnnotations()){var a=D.revisions();if(a){for(var b=
[],c=0;c<a.length;c++){var e=a[c];e.range&&this.findRange(e.range.acc,e.range.accend,"page")&&!I(this,e)&&(b.push(e),this._revisions.push(e))}b.length&&V(this,b,function(a,b){for(var c=0;c<b.length;c++){var e=b[c],f=b[c-1];if(f&&e.range&&f.range&&("add"===e.type&&"delete"===f.type||"delete"===e.type&&"add"===f.type)){var h=G(e.author),g=G(f.author),m=G(e.last_save_date||e.create_date),B=G(f.last_save_date||f.create_date);h===g&&m===B&&(f.range.acc==e.range.acc&&f.range.accend==e.range.accend?"add"===
f.type?b.splice(c-1,1):b.splice(c,1):(h=G(e.text),g=G(f.text),f.range.accend===e.range.acc&&d.test(h)&&d.test(g)&&(h=b[c-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(h.range=e.range,h.text=e.text,h.oldtext=f.text):(h.range=f.range,h.text=f.text,h.oldtext=e.text),b.splice(c,1))))}}return b})}}};a.processSSRevisions=function(){var a=z.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=!0,this._ssmodel.processRevisions(a,
function(){V(this,this._ssmodel.revisions())},this))};a.positionAnnotations=function(){this._annotationPane&&w.showAnnotations&&this._annotationPane.layout()};a.annotationPane=function(){return this._annotationPane};return c}(),Lc=function(){function b(a){return"string"===typeof a&&0<a.length&&"none"!==a}var e,d=function(a,b){var c={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0}}};b.name&&(c.name={value:b.name});b.hidden&&(c.hidden={value:!0},
D.hiddenContent("hidden-pages"));Object.defineProperties(this,c);(c=Y.getElementById(b.oid))?U.call(this,c):(c="oit-overlay",b.cls&&(c=-1==b.cls.indexOf(c)?c+(" "+b.cls):b.cls),U.call(this,"article",c,b.oid));u.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},c=Z(d,U);c.updateCSS=function(){"text"!==w.selectionMode||oa.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");"rect"===w.selectionMode?this.css("cursor","crosshair"):this.css("cursor",
null)};c.item=function(a){if(this.firstPage)return z.page(this.firstPage.index+a)};c.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};c.containsPage=function(a){return z.page(a).overlay==this};c.display=function(){if(this.layers){var a=J.activeOverlay()===this;bb(this.layers,"show",null,a)}a=this.css("display");
e=b(a)&&e!==a?a:"block";this.css("display",e);this.updateCSS()};c.undisplay=function(){this.layers&&bb(this.layers,"hide");this.css("display",null)};c.isDisplayed=function(){var a=this.css("display");return b(a)};c.show=function(){!1!==this._isHidden&&(this._isHidden=!1,z.on.overlayshow.dispatch(this))};c.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),z.on.overlayhide.dispatch(this))};c.isHidden=function(){return void 0!==this._isHidden?this._isHidden:this.hidden};c.showPages=
function(a){this.each("show",a);this._pagesHidden=!1};c.hidePages=function(a){this.each("hide",a);this._pagesHidden=!0};c.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||!!D.revisions()};c.each=function(a,b){mb(this,arguments)};c.layer=function(a){var b;this.layers&&(b=this.layers[a]);b||(b=new rd(u.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=b);return b};return d}(),$a=function(){var b=function(a,b){this.id=a;this.range=ha(b.range);
this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=ha(b.compound[c]);"rect"===d.type&&xa(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&(void 0!==this.range.embedId?xa(this.range,
"pct"):xa(this.range,"px"));this.range=wa(this.range,!0)},e=Z(b);e.isNote=function(){return!1};e.isRedaction=function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};e.setRange=function(a){return void 0!==a&&0!==Xa(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){G(b,z.page(a.index))},null,this),this.range=ha(a),delete this._cRanges,"text"==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),P.alignHighlight(),P.on.move.dispatch(this),
!0):!1};e.updateStyle=function(){this._hidden||this.eachPage(d,null,this)};var d=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===typeof a)return this[a]();if(a instanceof ob)return this.isOnPage(a.index);if(a instanceof Lc)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};e.property=function(a,b){void 0!==b&&(this._properties||(this._properties=
{}),this._properties[a]=b);if(this._properties)return this._properties[a]};e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=this.style();this._active||"opacity"!==w.highlightActivationStyle||(a=this.highlightStyleProps(),a=dc(a));return a};e.highlightStyleProps=function(){var a=db(this.style());if(!this._active&&a&&"opacity"===w.highlightActivationStyle){var b=a["background-color"];b&&(b=Da(b))&&(b.a*=.4,a["background-color"]=La(b))}return a};
e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];a&&(a=Da(a));if(a)return a.a*=.25,a=La(a),{"background-color":a}};e.fillStyle=function(){if("text"!==this.range.type)return this._style};e.css=function(a){return kb(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Xa(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var c=function(a,b){b&&b.autodpi?xa(a,"pct"):b&&"bitmap"===b.type?xa(a,"px"):xa(a,"tw")};e.serialize=
function(){var a={type:this.type},b,d;a.range=ha(this.range);"rect"===a.range.type&&(void 0!==a.range.embedId?xa(a.range,"pct"):(b=z.page(a.range.page),c(a.range,b)));if(this.ttrects){var e=[],f;for(f in this.ttrects){var h=this.ttrects[f];if(h){b=z.page(f);for(var g=0;g<h.length;g++)d=h[g].toRange(b),c(d,b),e.push(d)}}a.ttrects=[].concat.apply([],e)}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);"string"===typeof this._comment&&(a.comment=this._comment);this._label&&
(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges)for(a.compound=[],b=0;b<this._cRanges.length;b++)d=ha(this._cRanges[b]),"rect"===d.type&&(void 0!==d.embedId?xa(d,"pct"):xa(d,"tw")),a.compound.push(d);return a};e.destroy=function(){this.destroyDialog();this.eachPage(a,null,this);P.unlink(this);this.deleteAll()};var a=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(z.page(Number(b)).isSpreadsheet())return!1;
break}}return(b=this._options)&&void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(h(this,"enableUserDelete",a,!0),h(this,"enableUserComment",a,!0),h(this,"enableUserResize",a,!0),"text"!==this.range.type&&h(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=
function(a){var b=this._dialog;b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new xd(this);b.loadComment();b.setMode(a);b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==
a&&(this._label=null===a||""===a?void 0:String(a),this.eachPage(f,null,this));return this._label};var f=function(a,b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(f,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=b;a++)if(this.isOnPage(a))return!0;return!1};var g=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});
return c};e.eachPage=function(a,b){yc(this._pageInfo,arguments)};e.activate=function(a){this.inAnnotation()&&(w.showAnnotations=!0);this.addToDocument();this._hidden&&(this.show(),this._autohide=!0,J.update());this._active=!0;this.eachPage(t,null,this);this.positionAll()};var k=function(a,b){if("text"===b.range.type&&"opacity"===w.highlightActivationStyle){var c=z.page(a.index).spreadsheetModel();if(c&&!b.inAnnotation())c.updateHighlight(b);else{var d=1,c=-2;b._active&&(d=2,c=-1);var e=b.highlightStyleProps();
a.spanList&&Ub(a.spanList,b.id,e,d);a.compoundSpanList&&ga(a.compoundSpanList,function(a,b){Ub(a.spans,b,e,d)},null,b.id);if(a.intervalSpanList){var f=b.intervalStyleProps();f&&ga(a.intervalSpanList,Ub,null,b.id|1E9,f,c)}}}},t=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===w.highlightActivationStyle?k(a,b):c&&(c.addClass("oit-highlight-active"),c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,v).ontextmoveend(b,p).showTextHandles():c.offtextmove(v).offtextmoveend(p).hideTextHandles(),
c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,r,c).ondragmove(this,A,c).ondragend(this,ea,c).ondragcancel(this,D,c);else b.removeClass("oit-moveable").offdragstart(r).offdragmove(A).offdragend(ea).offdragcancel(D)};
e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,L).onresizeend(this,X);else c.resizable(!1).offresizemove(L).offresizeend(X)};var v=function(a){var b=a.range;a=a.page;var c=z.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(q,null,c,this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);M(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},q=function(a,
b,c){a.spanList&&(a=a.index,gb(b,"index",a)||G(c,z.page(a)))},p=function(a){this.setRange(a.range)};e.deactivate=function(){this._active&&(delete this._active,this.eachPage(m,null,this),this._autohide&&(this.hide(),delete this._autohide,J.update()))};var m=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();"text"===b.range.type?"opacity"===w.highlightActivationStyle&&k(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=
function(){if(void 0!==this._hidden){var a=this._hidden;delete this._hidden;if(0<a.length){for(var b=0;b<a.length;b++)this.addToPage(a[b]);P.link(this)}else this.addToDocument()}delete this._autohide};e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(l,null,this),P.unlink(this))};var l=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};e.collapse=function(){};e.isHidden=function(){return!(!this._hidden&&!this._autohide)};var u=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||
d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var f=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(f,d.compoundSpanList[c].spans);for(c=0;c<a._cRanges.length;c++){var h=b.textRects(a._cRanges[c],b,f);e?Array.prototype.push.apply(e,h):e=h}}if(e)for(c=0;c<e.length;c++)for(f=e[c],h=0;h<f.length;h++){var g=f.item(h).clone();g.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(g.clone())}}else if(b.isSpreadsheet()||"text"!==
a.range.type)"text"===a.range.type&&(c=b.textBoundingRect(a.range)),c||(c=J.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},F=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=u(a,b);if(e){d=e[0].clone();for(var f=1;f<e.length;f++)d.union(e[f]);d.origin=c}}d||(d=J.rangeRect(a.range,c||b))}return d};e.boundingRectList=function(a){var b=[];this.eachPage(N,null,a,b,this);if(0<b.length)return b};var N=function(a,b,c,d){(a=F(d,z.page(a.index),
b))&&c.push(a)};e.addToDocument=function(a){if(!this._hidden){var b=z.pagesForRange(this.range);if(b){for(var c=0;c<b.length;c++)this.addToPage(b[c].index,!1,a);!1!==a&&P.link(this)}}};var H=function(a){a.highlightLayer||(R(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},R=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};e.addToPage=function(a,b,c){var d=z.page(a),e=this._pageInfo[a];e&&b&&(this.removeFromPage(e),
e=null);if(!this._hidden&&(!e||e.needRect||e.needApply)&&d&&d.isLoaded()&&!d.isHidden()&&(b||d.containsRange(this.range))){var f;delete this._inComment;d.pushShow();e&&e.needApply||(e=M(this,d,this.highlightStyle(),this.range));e&&delete e.boundingRects;if(P.batchMode())e&&(e.needApply=!0);else{b="text"!==this.range.type||"opacity"!==w.highlightActivationStyle;var h=!1;b&&(f=F(this,d,"overlay"),f||(e&&(e.needRect=!0),h=!0));if(!h){e?(delete e.needRect,delete e.needApply):e=g(this,a);void 0===this.range.embedId||
e.embedRect||(e.embedRect=new xb(a,H(d)),e.embedRect.addClass("oit-highlight-embed"),e.embedRect.hide());if(b&&!e.drawingRect&&(e.drawingRect=this.createDrawingRect(d.index,H(d)),e.drawingRect&&(P.on.addElement(e.drawingRect,this),d.inAnnotation(this.range))))e.drawingRect.onwheel(this,function(a){var b=d.annotationPane();if(b)return b.scrollPane().redirectEvent(a)});(b=this.fillStyle())?(e.styleDiv||(e.styleDiv=y.create("div","oit-highlight-style"),e.drawingRect&&e.drawingRect.append(e.styleDiv)),
e.styleDiv.attr("style",b)):e.styleDiv&&(e.styleDiv.destroy(),delete e.styleDiv);this._label&&this.applyLabel(e);C(this._pageInfo[a],this,f);this.updateComment(e,this._comment)}}!1!==c&&P.link(this);J.update(!1,!0);d.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;G(this,z.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(P.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();
this._pageInfo[b]=null;J.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;"text"===this.range.type?"opacity"!==w.highlightActivationStyle&&(c=new qd(a,b),c.setRange(this.range)):c=new xb(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=z.page(a);if(a=u(this,a))for(var f=0;f<a.length;f++){var h=a[f];if(!(h.origin instanceof ob)==d&&(h=h.distanceFrom(b,c,"nearest","nearest","xy"),void 0===e||h.ay<e.ay||h.ay==e.ay&&h.ax<e.ax)&&(e=h,0===e.x&&0===e.y))break}return e};var C=function(a,
b,c){var d;if(a){d=a.index;var e=z.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=F(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,c.top,c.width,c.height);a.embedRect&&(c=z.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,
c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(c=J.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(C,null,this)};e.getKey=function(){void 0===this.key&&this.generateKey();return this.key};e.generateKey=function(){var a,b=z.pagesForRange(this.range);if(b&&void 0===this.prevId&&void 0===this.nextId)for(var c=0;c<b.length;c++){var d=b[c];this.key&&this.key.page!=
d.index&&delete this.key;this.key||(this.key={page:d.index,x:0,y:0});if(this.inAnnotation())this.key.x=this.range.acc,this.key.y=9999999;else if(d.isEmailHeader()&&"text"===this.range.type)this.key.x=this.range.acc,this.key.y=0;else if(d.spreadsheetModel()){var e;"cell"===this.range.type?(e=this.range,this.key.x=0,this.key.y=e.r1*d.spreadsheetModel().colCount()+e.c1):"text"===this.range.type?(this.key.x=this.range.acc,this.key.y=-1):delete this.key}else if(d.isLoaded()){e=void 0;if(d&&(d=u(this,d))){e=
d[0].left;for(var f=d[0].top,h=1;h<d.length;h++){var g=d[h];if(g.top<f||g.top==f&&g.left<e)e=g.left,f=g.top}e={left:e,top:f}}(d=e)?(this.key.x=d.left,this.key.y=d.top):delete this.key}else this.key.x=this.range.acc,this.key.y=-1;if(this.key){a=this.key;break}}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&(this._inComment=z.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&!1!==this._labelVisible){var b=
this.css("background-color"),c;a:{if(b&&(c=Da(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=La(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var M=function(a,b,c,d){var e=null,f=0,h,n,m,B,l,r;a._active?f=2:"opacity"===w.highlightActivationStyle&&(f=1);var x=T.saveSelection();x&&x.range&&"text"===x.range.type&&b.isSpreadsheet()&&(T.select(null),x=null);G(a,b);if(a._compound){if(a._cRanges||(a._cRanges=z.decomposeRange(d,!0)),a._cRanges){(B=
b.spreadsheetModel())&&B.addHighlight(a)&&(e||(e=g(a,b.index)));var V="rect"===d.type,k;for(B=0;B<a._cRanges.length;B++){l=a._cRanges[B];if("text"===l.type){if(m||(m=db(c)),m&&(n=Hb(b,l,m,a.id,void 0,f))){e||(e=g(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var p=0;p<n.length;p++)if(h=n[p].split(l))for(r=0;r<h.length;r++)P.on.addElement(h[r],a);e.compoundSpanList.push({spans:n,range:l})}}else if(n=J.rangeRect(l,"overlay"))h=new xb(b.index,R(b)),c&&(r=y.create("div","oit-highlight-style"),
r.attr("style",c),h.append(r)),h.move(n.left,n.top,n.width,n.height),e||(e=g(a,b.index)),e.cRects||(e.cRects=[]),e.cRects.push({range:l,rect:h});V&&(l="text"===d.type?b.textBoundingRect(l):J.rangeRect(l,b))&&(k?k.union(l):k=l)}if(w.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(f=-2,a._active&&(f=-1),d=a.intervalStyleProps())){c=[];n=a.acc;for(B=0;B<a._cRanges.length;B++)l=a._cRanges[B],l.acc>n&&c.push(sa(n,l.acc)),n=l.accend;for(B=0;B<c.length;B++)if(l=c[B],n=Hb(b,l,d,a.id|
1E9,void 0,f))e||(e=g(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(n)}k&&(b=J.rangeFromRect(b.index,k.left,k.top,k.right,k.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((B=b.spreadsheetModel())&&B.addHighlight(a)&&(e=g(a,b.index)),m=db(c))&&(n=Hb(b,d,m,a.id))){e||(e=g(a,b.index));e.spanList=n;for(B=0;B<n.length;B++)if(h=n[B].split(d))for(r=0;r<h.length;r++)P.on.addElement(h[r],a);if((B=la.infoRaw())&&1557===B.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=
[],B=0;B<n.length;B++)n[B].hasClass("oit-tt")&&(b=n[B].textRect(d))&&a.push(b)}x&&T.restoreSelection(x);return e},G=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=T.saveSelection();e&&e.range&&"text"===e.range.type&&b.isSpreadsheet()&&(T.select(null),e=null);var f=b.spreadsheetModel();f&&("text"===a.range.type||a._compound)&&f.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(f=d.spanList[c].split(a.range))for(var h=0;h<f.length;h++)P.on.removeElement(f[h],a);Tb(d.spanList,
a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(ga(d.compoundSpanList,function(b,d){var e=b.range,f=b.spans;for(c=0;c<f.length;c++){var h=f[c].split(e);if(h)for(var g=0;g<h.length;g++)P.on.removeElement(h[g],a)}Tb(f,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(ga(d.intervalSpanList,Tb,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());if(d.cRects){for(c=0;c<d.cRects.length;c++)if(f=d.cRects[c].rect)P.on.removeElement(f,a),f.destroy();
delete d.cRects}e&&T.restoreSelection(e)}},h=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===P.active()&&this.activate(!0)}};var B=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,
V).onmouseleave(this,I),a.commentFlag||(a.commentFlag=new Ba(a.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(B,null,b,this)};var V=function(a){this.id!=P.active()&&P.showComment(this.id)},I=function(a){this.id!=P.active()&&P.hideComment(this.id)},r=function(a,b){if(this.getOption("enableUserMove")){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};
return!1}return!0},A=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;d=this._moveable.curRect;var f=a.delta;d.left=e.left+f.x;d.top=e.top+f.y;"cell"!==c.type||c.offsets?d=J.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=J.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=J.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-
c.c1,f=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<f&&(d.r2=d.r1+f),delete d.offsets);0!==Xa(d,c)&&(d=J.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},ea=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=J.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=
c.r2-c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},D=function(a,b){if(this._moveable){var c=a.center;P.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},L=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=J.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;if(d=wa(d,!0))b=J.rangeRect(d,"overlay"),"rect"===d.type&&(a=
b),c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},X=function(a){var b=this.range;a=a.newRect;a=J.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=wa(a,!0);this.setRange(a)};return b}(),hd=function(){var b=function(b,c){$a.call(this,b,c)},e=Z(b,$a);e.isRedaction=function(){return!0};e.isCompoundRedaction=function(){return!0===this._compound};e.isEmptyRedaction=
function(){return!0===this._compound&&!this._cRanges};e.style=function(b){b=w.redactionColor;return"color:"+b+";background-color:"+b+";"};e.fillStyle=function(){if("text"!==this.range.type){var b;if(b=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?w.redactionColor:w.redactionFillColor)return"background-color:"+b+";"}};e.css=function(b){if("color"===b||"background-color"===b)return w.redactionColor};return b}(),id=function(){var b=function(a,b){$a.call(this,a,b);this._newNote=
!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=Z(b,$a);e.isNote=function(){return!0};e.isEditing=function(){return this._editing};e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);$a.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=!1,this.updateState())};e.show=function(){this._hidden&&
(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};e.unpin=function(){this._pinned&&(this.endEditText(!0),P.active()==this.id&&P.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,u.editingComment++,this.updateState())};e.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=
P.comment(this.id)),this._editing=!1,u.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:P.remove(this.id)))};e.ok=function(){this.endEditText(!0);return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var d=function(){this.addClass("oit-note-expanding")},c=function(){this.removeClass("oit-note-expanding")},a=function(){this.addClass("oit-note-collapsing")},f=function(){this.removeClass("oit-note-collapsing")};
e.updateState=function(b){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var g=this.noteRect;if(g){if(e!=this._state||b){var m=this._state;this._state=e;g.removeClass(m).addClass(e);switch(m){case "oit-note-editing":P.comment(this.id,this.buttons.textArea.value);oa.showModalOverlay(!1);this.buttons.iconBar.focus();g.layer().removeClass("oit-note-layer-edit");
g.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":g.show();break;case "oit-note-iconic":"oit-note-hidden"!==e&&(b=this.originalRect,g.move(b.left,b.top,b.width,b.height,{timems:200,startFn:d,endFn:c}));break;case "oit-note-active":g.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==e&&(this.updateMoveable(!1,this.buttons.iconBar,g),this.updateResizable(!1,g))}this.positionAll();switch(e){case "oit-note-hidden":g.hide();
break;case "oit-note-iconic":this.originalRect=g.position().clone();b=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===m?g.move(b.left,b.top,b.width,b.height):g.move(b.left,b.top,b.width,b.height,{timems:200,startFn:a,endFn:f});break;case "oit-note-editing":g.layer().addClass("oit-note-layer-edit");g.addClass("oit-highlight-active").activate(!1,!0);P.activate(this.id);oa.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();
this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":g.addClass("oit-highlight-active").activate(!1,!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,g),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},g)}}g.update()}};e.createDrawingRect=function(a,b){var c=new xb(a,b),d={};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new Ba(c,{classList:"oit-note-icons",inheritMoveable:!0});
d.iconBar.attr("tabindex","-1");d.cancel=new Ba(d.iconBar,{classList:"oit-note-cancel",title:S.DISCARD_CHANGES});d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new Ba(d.iconBar,{classList:"oit-note-ok",title:S.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new Ba(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,g).onmouseleave(this,k).onclick(this,t).ontap(this,t);d.textArea=new rc;d.textArea.onfocus(this,q).ontap(this,v);d.textForm=y.create("form");d.textForm.append(d.textArea);
c.append(d.textForm);this.updateState(!0);return c};var g=function(a){this._hover=!0;this.updateState()},k=function(a){this._hover=!1;this.updateState()},t=function(a){this._pinned?this.unpin():this.pin();return!1},v=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},q=function(a){this.getOption("enableUserComment")?this.beginEditText():this.buttons.textArea.blur()},p=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||
(this.buttons.textArea.value=b||""):this.eachPage(p,null,b,this)};return b}(),jd=function(){var b=function(b,d){$a.call(this,b,d);d.name&&(this._name=d.name);d.sizing&&(this._sizing=d.sizing);d.opacity&&(this._opacity=d.opacity);if(!this._style){var c="background:url("+P.stamp(this._name).url+") no-repeat";1!=this._opacity&&(c+=";opacity:"+this._opacity);"scale"===this._sizing?c+=";background-size:contain":"stretch"===this._sizing&&(c+=";background-size:100% 100%");this._style=c}};Z(b,$a).serialize=
function(){var b=$a.prototype.serialize.call(this);b.stamp=this._name;b.opacity=this._opacity;b.sizing=this._sizing;delete b.style;return b};return b}(),xd=function(){var b=200,e=150,d=function(b){var c="#000",d=b.css("background-color");d&&(d=ec(d,"#FFFFFF"));if(d){var e=Da(d);128>e.r&&128>e.g&&128>e.b&&(c="#FFF")}Pc.call(this,{ok:!0,cancel:!0,className:"oit-dialog-comment",resultFn:a,destroyFn:f,textColor:c,backgroundColor:d});this._highlight=b},c=Z(d,Pc),a=function(a,c){"view"!==a._mode&&(b=a.width(),
e=a.height(),"new"!==a._mode||c&&a._textarea.value?(c&&a.saveComment(),P.active()===a._highlight.id?a.setMode("view"):a._highlight.exitDialog()):(P.remove(a._highlight.id),T.select(null)))},f=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};c.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)u.editingComment--,this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),
this._label||(this._label=this.addLabel(null),this._label.onclick(this,g).ontap(this,g).onmouseenter(this,k).onmouseleave(this,t)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(b,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":u.editingComment++,this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:v,context:this})}}};var g=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},
k=function(){P.showComment(this._highlight.id)},t=function(){var a=this._highlight.id,b=P.active();a!=b&&(P.hideComment(a),void 0!==b&&P.showComment(b))},v=function(){this.show(!0,{endFn:q,context:this})},q=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,p));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},
p=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};c.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&this._label.text(a)};c.saveComment=function(){this._textarea&&P.comment(this._highlight.id,this._textarea.value,!0)};c.align=function(a){var c;a:{var d=a?a.rect:null;if(this){var f=
this._highlight,g=f.isNote(),m,k,p;if(d)"view"!==d.origin&&(d=d.clone(),d.origin="view"),g?(c=d.left,m=d.top,k=d.right-d.left,p=d.bottom-d.top):(c=d.right+10,m=d.top);else if(d=f.boundingRectList("view"))for(f=0;f<d.length;f++){var q=d[f];g?(c=q.left,m=q.top,k=q.right-q.left,p=q.bottom-q.top):(c=q.right+10,m=q.top);0>m&&0<=q.bottom&&(m=0);if(0<=c&&0<=m)break}if(void 0!=c){10>c&&(c=10);10>m&&(m=10);g=u.viewNode.pos();c+=g.left;m+=g.top;if(k&&p){c={left:c,top:m,width:k,height:p};break a}c={left:c,top:m};
break a}}c=void 0}c&&(m=c.width||b,k=c.height||e,"view"===this._mode?this.autoSize(c.left,c.top,m,k,a):this.move(c.left,c.top,m,k,a))};return d}(),Sb=function(){var b=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=
-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=y.create("div","oit-toolframe");this._toolbar=y.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=y.create("div","oit-toolbar-tool");this._toolsElem=c;this._content=y.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,
this._content);d&&(y.unwrap(this._toolbar).style[this._border]=d);a=e?e._content:u.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=Z(b);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var d=function(a){this._startSize=this.size();return!1},c=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);
return!1},a=function(a){delete this._startSize;return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=function(b,e,k,t){"boolean"===typeof b&&((this._resizable=b)?("number"==typeof e&&"number"==typeof k&&"string"==typeof t&&(this._collapseSize=e,this._minSize=k,this._collapseHeader=y.create("div","oit-toolcollapse"),
this._collapseHeader.html(t),this._toolbar.append(this._collapseHeader)),this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=y.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,d),this._resizeHandle.ondragmove(this,c),this._resizeHandle.ondragend(this,a),this._resizeHandle.ondragcancel(this,a),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),
delete this._collapseSize,delete this._minSize,delete this._collapseHeader,this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||ua.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=
this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,y.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],10))}this.applySize(a.size,!0);this.isInternal()||ua.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",
null),this.applySize(),this.isInternal()||ua.on.hide.dispatch(this.id,this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);
break;case "left":case "right":this._resizeHandle&&(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,f=this._toolsElem,g=this._frame;if(this._visible){this._autoSize&&d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=f.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));
break;case "left":case "right":this._autoSize?this._size=f.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=
!1));void 0!==this._borderSize&&(a+=this._borderSize);var f=g.clientWidth,g=g.clientHeight,m=u.rootNode.clientWidth-10,l=u.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>l&&(a=l));d.css("bottom",g-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>l&&(a=l));d.css("top",g-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&
(a+=this._resizeHandle.offsetWidth,a>m&&(a=m));d.css("right",f-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>m&&(a=m)),d.css("left",f-a+"px"),this._overlay||e.css("right",a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&
(this._collapsed?(b=this._collapseHeader.clientWidth,c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,la.dispatchResize(),this.isInternal()?ua.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):ua.on.resize.dispatch(this.id,this._edge,b,c)};return b}(),ed=function(){return function(){var b,e,d,c,a,f=[],g,k,t,v;this.show=function(){b&&b.show()};this.hide=function(){b&&
b.hide()};this.length=function(){return f.length};this.addPrevNext=function(b,f){if(!c){c=new cc("\u25c4",S.PAGE_UP);b&&(c.onclick(b),c.ontap(b));a=new cc("\u25ba",S.PAGE_DOWN);f&&(a.onclick(f),a.ontap(f));var g=y.create("div","oit-tab-nextprev");g.append(c,a);e.append(g);(g=g.size())&&g.width&&d.css("right",g.width+"px")}};this.addTab=function(a,b,c,e){var g=y.create("div","oit-tab");g.html("<div>"+a+"</div>");b&&g.addClass("oit-hidden");d.append(g);f.push(g);if(c instanceof Function)g.on("click",
null,q,c,e).on("tap",null,q,c,e);return f.length-1};var q=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<f.length&&(f[a].css("display",null),p())};this.hideTab=function(a){0<=a&&a<f.length&&(f[a].css("display","none"),p())};this.tabClass=function(a,b){if(0<=a&&a<f.length){if(f[a].customClass){if(f[a].customClass===b)return;f[a].removeClass(f[a].customClass);delete f[a].customClass}b&&(f[a].addClass(b),f[a].customClass=b)}};this.setActiveTab=function(a){if(0<=a&&a<f.length&&a!=g&&(void 0!=
g&&f[g].removeClass("oit-tab-selected"),g=a,f[g].addClass("oit-tab-selected"),p(),void 0!==g)){a=f[g].rect(e);var b=d.rect(e),c=b.left;a.right>b.right?c-=a.right-b.right:0>a.left&&(c-=a.left);0<=c?d.css("left",null):d.css("left",c+"px")}};this.tabRect=function(a){if(0<=a&&a<f.length){a=f[g].rect(u.rootNode);a=new ia(a,"view");var b=u.viewNode.rect(u.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){b&&ua.removeInternal(-2);e&&e.destroy();f=a=c=d=e=b=null};var p=function(){if(c){for(var b,
d,e=0;e<f.length;e++)"none"!==f[e].css("display")&&(d=e,void 0===b&&(b=e));c.disabled=g<=b;a.disabled=g>=d}};e=y.create("div","oit-tab-bar");d=y.create("div","oit-tab-list");e.append(d);d.kinetic(!0);d.ondragstart(function(a){a=d.rect(e);k=a.left;t=a.right;v=f[f.length-1].rect(e).right;return!1});d.ondragmove(function(a){var b=a.delta.x;a=k+b;0>a&&(b=v+b,b<t&&(a+=t-b));0<a&&(a=0);d.css("left",a+"px");return!1});b=new Sb(-2,"bottom",e,null,ua.internalParent(-2));ua.addInternal(-2,b);b.show()}}(),yd=
function(){return function(){var b,e,d;this.show=function(){b&&b.show()};this.hide=function(){b&&b.hide()};this.enable=function(){d.attr("disabled",null)};this.disable=function(){d.attr("disabled","disabled")};this.setText=function(a){a?d.attr("value",a):d.attr("value","")};this.destroy=function(){b&&ua.removeInternal(-4);e&&e.destroy();d=e=b=null};e=y.create("div","oit-formula-bar");var c=y.create("div","oit-formula-padding");d=y.create("input","oit-formula-text");d.attr("type","text");d.attr("readonly",
"readonly");c.append(d);e.append(c);b=new Sb(-4,"top",e,null,ua.internalParent(-4));ua.addInternal(-4,b);b.show()}}(),Ea=function(){var b=function(b,a,d){this._size=a;this._hidden=!1;b?(this._hidden=!0===b.hidden,void 0!==b.h?this._size=b.h:void 0!==b.w&&(this._size=b.w),this._title=void 0!==b.t?b.t:d,void 0!==b.st&&(this._styleIndex=b.st),this._acc=b.acc,this._accend=b.accend):this._title=d;this._originalHidden=this._hidden;this._originalSize=this._size},e=Z(b);e.acc=function(){return this._acc};
e.accend=function(){return this._accend};e.clone=function(){var c=new b(null,this._size,this._title);c._size=this._size;c._originalSize=this._originalSize;c._hidden=this._hidden;c._originalHidden=this._originalHidden;c._title=this._title;void 0!==this._styleIndex&&(c._styleIndex=this._styleIndex);void 0!==this._acc&&(c._acc=this._acc);void 0!==this._accend&&(c._accend=this._accend);void 0!==this._revisions&&(c._revisions=this._revisions);void 0!==this._deleted&&(c._deleted=this._deleted);this._data&&
(c._data=this._data.slice(0));c.clonedFrom=this;return c};e.title=function(){return this._title};e.style=function(){return this._styleIndex};e.revision=function(b){void 0!==b&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),this._revisions.push(b),"delete_col"===b.type||"delete_row"===b.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(b){var a,c;this._data=b;if(void 0===this._acc){for(b=0;b<this._data.length;b++)if(a=this._data[b],
c=a.t||a.v,a&&c&&void 0!==a.a){this._acc=a.a;break}if(void 0!=this._acc)for(b=this._data.length-1;0<=b;b--)if(a=this._data[b],c=a.t||a.v,a&&c&&void 0!==a.a){this._accend=a.a+c.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};e.deleted=function(){return!!this._deleted};e.show=function(b){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=b),!0):!1};e.reset=function(){var b=!1;void 0!=this._originalSize&&(this._size=
this._originalSize,b=!0);!this._hidden&&this._originalHidden&&(b=this._hidden=!0);return b};e.size=function(){return this._hidden?0:this._size};e.setSize=function(b){if("number"!==typeof b)throw"Invalid argument to setSize";this._size=b;this._hidden=0===b};e.getCellsForRange=function(b,a){if(this._data&&void 0!==this._acc&&b<=this._accend&&a>=this._acc){for(var c,d=0;d<this._data.length;d++){var e=this._data[d];if(e){var t=e.t||e.v;e&&t&&void 0!==e.a&&b<=e.a+t.length&&a>=e.a&&(c||(c=[]),c.push(e))}}return c}};
e.getIndexForCell=function(b){if(this._data){for(var a=0,c=0;c<this._data.length;c++){var d=this._data[c];if(d&&d==b)break;d&&d.e?a+=d.e:a++}return a}};var d=function(b,a){if(b._data){if(void 0===b._getCellIndex||a<b._getCellIndex)if(b._cellDataIndex=0,b._getCellIndex=0,b._getCellEmpty=0,0<b._data.length){var c=b._data[0];c?c.e&&(b._getCellEmpty=c.e):b._getCellEmpty=1}for(;b._getCellIndex<a;){0<b._getCellEmpty&&b._getCellEmpty--;if(0===b._getCellEmpty){b._cellDataIndex++;if(b._cellDataIndex>=b._data.length){b._getCellIndex=
a;return}c=b._data[b._cellDataIndex];b._getCellEmpty=c?c.e||0:1}b._getCellIndex++}if(b._cellDataIndex<b._data.length)return b._cellDataIndex}};e.getCell=function(b){b=d(this,b);if(void 0!==b)return this._data[b]};e.insertCell=function(b){this._data&&void 0!==d(this,b)&&this._data.splice(this._cellDataIndex,0,null)};return b}(),td=function(){var b={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},d={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},
c=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||
80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var f=e.e||e.s,h=e.s;h<=f;h++)c=Va(h),this._cols[h]=new Ea(e,this._defColWidth,c);else c=Va(d),this._cols[d]=new Ea(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(f=e.e||e.s,h=e.s;h<=f;h++)c=
Za(h),this._rows[h]=new Ea(e,this._defRowHeight,c);else c=Za(d),this._rows[d]=new Ea(e,this._defRowHeight,c);var B;a.cells&&(B=g(this,a.cells));if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;this._embeds=b;t(this,B)},a=Z(c);a.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==
this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&this._cols!==this._annoCols&&(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=
this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a,delete this._accmap)}return this._showAnnotations};a.cellGridChanged=function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};a.getCellText=function(a,b){var c=this.getCell(a,b);return c?c.t||c.v||"":""};a.getCellComments=function(a,b,c){var d,e=this._page.comments();if(e)for(var f=0;f<e.length;f++){var h=e[f];if("cell"===h.type&&h.range&&"cell"===h.range.type){var g=h.range;this._showAnnotations&&
h.annoRange&&(g=h.annoRange);a>=g.c1&&a<=g.c2&&b>=g.r1&&b<=g.r2&&(!c||g.c2==a&&g.r1==b)&&(d||(d=[]),d.push(h))}}return d};a.updateDimensions=function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=
d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var f=this.colWidth(c.c1),g=this.rowHeight(c.r1),m=c.x1,l=c.y1;m>f&&(m=f);l>g&&(l=g);d=this.colLeft(c.c1)+m;e=this.rowTop(c.r1)+l;c.position={left:d,top:e};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=e+c.h):(f=this.colWidth(c.c2),g=this.rowHeight(c.r2),m=c.x2,l=c.y2,m>f&&(m=f),l>g&&(l=g),f=this.colLeft(c.c2)+m,l=this.rowTop(c.r2)+l,f<d&&(f=d),l<e&&(l=e),c.position.right=f,c.position.bottom=
l);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};a.unload=function(){ga(this._data,function(a){a.ajax&&lb(a.ajax)});this._data=null;this._deferredTimer&&(D.resumeIdleTimer("loadDataForCells"),ra(this._deferredTimer),delete this._deferredTimer);
this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=null};a.sheetStyle=function(){return this._sheetStyle};a.webFonts=function(){return this._fonts};a.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&(d=this.getCell(a,b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,f=b,h=d.f,g=0,B=0;e=a;if(this._showAnnotations)for(var m=0;m<e;m++){var n=
this._cols[m];n&&n.title()==S.DEL&&e--}if(this._showAnnotations)for(m=0;m<f;m++)(n=this._rows[m])&&n.title()==S.DEL&&f--;c.fr||(g=e-d.c,B=f-d.r);d=zd(h,g,B,D.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};a.showHidden=function(a){if(a){this._showHidden||(this._showHidden={columns:!1,rows:!1});if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;break;case "columns":this._showHidden.columns=
!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};a.embeddingCount=function(){return this._embeds?this._embeds.length:0};a.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=y.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||a.node.hasClass("oit-image-embed")||(a.node=
a.node.parent())),a};a.embedByUID=function(a){return gb(this._embeds,"uid",a)};a.getCell=function(a,b){var c,d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||null};a.cellFromPos=function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);!1!==c&&(c=
this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return ta(a,b)};a.prevTextCell=function(a,b){var c,d,e,f=a-50;0>f&&(f=0);if(this._colMajor)for(e=a-1;e>=f;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var h=this._rows[b];if(h)for(e=a-1;e>=f;e--)if((d=h.getCell(e))&&(d.t||d.v)){c=e;break}}return c};a.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};a.rowCount=function(){void 0===this._bottom&&this.updateDimensions();
return this._extRowCount};a.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};a.eachRow=function(a){for(var b in this._rows)a(Number(b))};a.eachCol=function(a){for(var b in this._cols)a(Number(b))};a.rowHeight=function(a){return(a=this._rows[a])?a.size():this._defRowHeight};a.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};a.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Za(a),this._rows[a]=c=new Ea(null,this._defRowHeight,c));
c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};a.setColWidth=function(a,b){var c=this._cols[a];c||(c=Va(a),this._cols[a]=c=new Ea(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};a.showRow=function(a){return(a=this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};a.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=
void 0,this.cellGridChanged(!0),!0):!1};a.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};a.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};a.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};a.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};a.rowHidden=function(a){return(a=this._rows[a])?a.hidden():!1};a.rowOriginalHidden=
function(a){return(a=this._rows[a])?a.originalHidden():!1};a.colDeleted=function(a){return(a=this._cols[a])?a.deleted():!1};a.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};a.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};a.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+
(a-b)*this._defRowHeight};a.rowBottom=function(a){return this.rowTop(a+1)};a.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};a.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};a.colRight=function(a){return this.colLeft(a+
1)};a.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};a.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};a.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};a.colTitle=function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=Va(a)));return c};a.rowTitle=function(a,b){var c,
d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),!1!==b&&(c=Za(a)));return c};a.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};a.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};a.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];break}}return c};a.containsRange=function(a){var b=
!1;if("text"===a.type){var c=a.acc;a=a.accend;var d=this.findCellsForRange(c,a);if(-1!=d)for(var e=this.getACCMap(),f=this._colMajor?this._cols:this._rows;d<e.length;d++){var g=f[e[d]];if(g){if(g.acc()>a)break;if(g.getCellsForRange(c,a)){b=!0;break}}}}else b=a.page===this._page.index;return b};a.getACCMap=function(){if(!this._accmap){this._accmap=[];var a=this._colMajor?this._cols:this._rows,b;for(b in a){var c=Number(b),d=a[c];d&&void 0!==d.acc()&&this._accmap.push(c)}}return this._accmap};a.findCellsForRange=
function(a,b){var c=this.getACCMap(),d=this._colMajor?this._cols:this._rows;if(0===c.length)return-1;for(var e=0;e<d.length&&!d[e];)e++;for(var f=d.length-1;0<=f&&!d[f];)f--;if(!d[e]||!d[f]||b<d[e].acc()||a>d[f].accend())return-1;for(var e=0,f=c.length-1,g;e<=f;){g=Math.floor((e+f)/2);var h=d[c[g]];if(b<h.acc())f=g-1;else if(a>h.accend())e=g+1;else break}for(;0<g&&d[c[g-1]].accend()>a;)g--;return g};a.getCellsForRange=function(a,b){var c=this.findCellsForRange(a,b);if(-1!=c){for(var d=this.getACCMap(),
e=this._colMajor?this._cols:this._rows,f=void 0;c<d.length;c++){var g=e[d[c]];if(g){if(g.acc()>b)break;(g=g.getCellsForRange(a,b))&&(f?Array.prototype.push.apply(f,g):f=g)}}return f}};a.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Xa(a,this._selectedRange)&&(this.select(null),c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=ha(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;
delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,b.highlightsChanged=!0;b=!0}return b};a.addHighlight=function(a){var b=!1,c,d;if(a&&!a.isHidden())if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(b=this._page.containsRange(a.range))}else if(a.isCompoundRedaction()&&
"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};a.updateHighlight=function(a){var b;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c)for(a=0;a<c.length;a++)c[a].highlightsChanged=!0}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(a=
0;a<c.length;a++)if(b=c[a],b=this.getCell(b.cell.c,b.cell.r))b.highlightsChanged=!0};a.removeHighlight=function(a){if(a){var b,c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&(Na(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&
b.highlights&&(Na(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0)}return!1};a.expandRange=function(a){a=ha(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};a.getHoverText=
function(){if(!w.showCellTooltips||this.isRangeSelected())return null;var a=T.cellSelection();return(a=this.getCell(a.c1,a.r1))&&a.clipped?a.t||a.v:null};a.isRangeSelected=function(){var a=!1,b=T.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};a.getSelectedText=function(){var a="",b;switch(T.selectionType()){case "text":if(this._selectedCells){b=
T.textSelection();for(var c=this._selectedCells,d=0;d<c.length;d++){var e=c[d];if(e.t){var f=b.acc-e.a;0>f&&(f=0);var g=b.accend-e.a;g>f&&(a&&(a+="\t"),a+=e.t.substring(f,g))}}}break;case "cell":if(b=T.cellSelection(),this.isRangeSelected())for(c=0,d=b.r1;d<=b.r2;d++){e=0;for(f=b.c1;f<=b.c2;f++){if(g=this.getCellText(f,d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=g}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};a.mapToCells=function(a){if("text"==
a.type){var b=[],c=a.acc;a=a.accend;var d=this.getACCMap();if(this._colMajor){var e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++){var e=d[e],f=this._cols[e];if(f){if(f.acc()>a)break;var g=e,h=b;if(f){var m=f.getCellsForRange(c,a);if(m)for(var l=0;l<m.length;l++){var n=f.getIndexForCell(m[l]),x=this.getMergedCell(g,n);x?h.push(ha(x.range)):h.push(ta(g,n))}}}}}else{e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++)if(e=d[e],f=this._rows[e]){if(f.acc()>a)break;g=e;
h=b;if(f&&(m=f.getCellsForRange(c,a)))for(l=0;l<m.length;l++)n=f.getIndexForCell(m[l]),(x=this.getMergedCell(n,g))?h.push(ha(x.range)):h.push(ta(n,g))}}return b}};a.mapToText=function(a){if("cell"==a.type){var b;a=f(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var g=e.a+e.t.length;b||(b=[]);e=sa(e.a,g);e.cell={c:d,r:c};b.push(e)}}return b}};a.decomposeRange=function(a,b){if("cell"==a.type){a=f(a);var c=this.mapToText(a);if(b)c?c.push(a):
c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var g=null,h=a.c1;h<=a.c2;h++){var m=this.getCell(h,e);m&&m.v&&(g&&g.c2==h-1?g.c2=h:(g=ta(a.page,h,e,h,e),d.push(g)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(g=d[e]){for(h=e+1;h<d.length;h++)(m=d[h])&&m.r1==g.r2+1&&m.c1==g.c1&&m.c2==g.c2&&(g.r2=m.r2,d[h]=null);c.push(g)}}return c}};var f=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,f;b>c&&(f=b,b=c,c=f);d>e&&(f=d,d=e,e=f);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&
c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=ta(a.page,b,d,c,e)}return b},g=function(a,b){var c,d,e,f,g,h,m;delete a._accmap;var l=a._colMajor?a._cols:a._rows;c=0;var n,x=[];for(e=0;e<b.length;e++){var k=b[e];k instanceof Array?n=c:(c=k.i,n=k.e||k.i,k=k.d);var p;a._colMajor?(p=new Ea(null,a._defColWidth,null),void 0===f&&(f=c,g=0,m=a.rowCount())):(p=new Ea(null,a._defRowHeight,null),void 0===g&&(g=c,f=0,h=a.colCount()));for(var q=c;q<=n;q++){a._colMajor?h=q:m=q;l[q]||(l[q]=p);l[q].setCellData(k);
for(var B=0,F=0;B<k.length;B++){d=k[B];d.fr&&x.push(d);if(d.mh||d.mv)a._merged||(a._merged=[]),c=a._colMajor?ta(q,F,q,F):ta(F,q,F,q),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?F+=d.e:F++}}c=n+1}for(e=0;e<x.length;e++)for(d=x[e],c=Jb(d.fr),l=c.c1;l<=c.c2;l++)for(n=c.r1;n<=c.r2;n++)(k=a.getCell(l,n))&&k!==d&&(k.fr=d.fr,k.fm=d.fm);return ta(a._page.index,f,g,h,m)},k=function(a,b,c){for(var d;0<=b&&b<a.length;b+=c){var e=a[b];if(e&&void 0!==e.acc()){d=e;break}}return d},
t=function(a,b){if(b){var c,d;a._colMajor?(c=k(a._cols,b.c1,1),d=k(a._cols,b.c2,-1)):(c=k(a._rows,b.r1,1),d=k(a._rows,b.r2,-1));c&&d&&(P.each(function(b){b.addToPage(a._page.index,!0)},function(b){b=P.highlight(b).range;return"text"!==b.type?b.page===a._page.index:b.acc<d.accend()&&b.accend>c.acc()}),J.update(!0))}},v=function(a,b,c,d,e,f,m){f.loaded=!0;delete f.ajax;0===--e._ajaxLoading&&e._hideMsg&&(oa.hideMessage(),e._hideMsg=!1);if(200===d){var h=JSON.parse(c);h.cells&&(h=g(e,h.cells),t(this,
h))}else e.logAJAXError(null,"Failed to load the spreadsheet data for sheet "+(e._page+1)+" from the server",a,d,c);D.resumeIdleTimer("loadSSDataFromServer");this.cellGridChanged(!0);J.update(!0);if(m){for(var h=[e],l=7;l<arguments.length;l++)h.push(arguments[l]);m.apply(null,h)}},q=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&(d=Ra(u.baseURL,d));D.pauseIdleTimer("loadSSDataFromServer");b.ajax=Ma({url:d,context:a,complete:v,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;
a._ajaxLoading++}};a.hasPendingContent=function(){return this._data||0<this._ajaxPending||0<this._ajaxLoading};a.loadRange=function(a,b){var c=!0;if(this._data)switch(a.type){case "text":var d=this.mapToCells(a);d&&0!==d.length||(da(p,0,this,this,a,b),c=!1);break;case "cell":this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b),c=!1}b&&c&&b(a)};var p=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){q(a,e,p,b,c);
break}}};a.loadDataForCells=function(a,b,c,d,e,f){if(void 0===a||void 0===b||void 0===c||void 0===d)f&&f();else if(this._data){this._colMajor||(a=b,c=d);var g;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&!b.loaded&&!b.ajax){if(b.i>c)break;if(b.iend>=a){var h=!1;if(this._colMajor)for(var l=b.i;l<=b.iend;l++){if(!this.colHidden(l)){h=!0;break}}else for(l=b.i;l<=b.iend;l++)if(!this.rowHidden(l)){h=!0;break}h&&(g||(g=[]),g.push(b))}}g?e?(this._deferredTimer?(ra(this._deferredTimer),delete this._deferredTimer):
D.pauseIdleTimer("loadDataForCells"),this._deferredTimer=da(function(a,b){delete this._deferredTimer;D.resumeIdleTimer("loadDataForCells");m.call(this,a,b)},200,this,g,f)):m.call(this,g,f):f&&f()}else f&&f()};var m=function(a,b){for(var c=0;c<a.length;c++)q(this,a[c],b)},l=function(a){var b;if(a&&void 0!==a.sheet){var c=z.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,g=a.r2,h=a=!1;void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=
0,g=d.rowCount()-1,h=!0):void 0===g&&(g=e);b=ta(c.index,b,e,f,g);a&&(b.selectingRows=!0);h&&(b.selectingCols=!0)}}}return b},K=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=l(c.ref);d&&(delete c.ref,c.range=d)}},F=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=ja.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},N=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||
b.page||(b.page=z.page(b.ref.sheet)),b.range=l(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=l(b.oldref),b.oldrange&&delete b.oldref),b.user_name?b.author=b.user_name:b.user&&(c&&(b.author=c[b.user]),delete b.user),b.ref||b.oldref||(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},H=function(a,b){var c=b.indexOf(a);if(-1==
c)for(var d in b){var e=b[d];if(e&&e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,10);break}}return c},R=function(a,b){if(b&&(b.col||b.row)){var c=ha(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=H(b.col,a._annoCols),-1!=d&&(c.c1=d)),delete b.col);b.col2?(a._annoCols&&(d=H(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=H(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=H(b.row2,a._annoRows),-1!=d&&(c.r2=d)),delete b.row2):
f&&(c.r2=c.r1);return c}};a.processRevisions=function(a,b,c){var d=!1;if(a&&a.revisions){var e=this,f;e._deletedCols=0;for(f=e._deletedRows=0;f<a.revisions.length;f++)N(e,a.revisions[f],a.users);if(e._revisions){a=ta(e._page.index,0,0,0,0);for(f=0;f<e._revisions.length;f++)d=e._revisions[f],ub(a,d.range),ub(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),f=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;e._normalCols=
e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=e._rowCount;e._annoRowCount=e._rowCount+e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var g=e._revisions[a],h,m,l,k=e;m=g;g=g.range;h=d;var q=f;if(g)switch(m.type){case "add_row":g.row=q[g.r1];g.row||(l=Za(g.r1),g.row=q[g.r1]=new Ea(null,k._defRowHeight,l),k._annoRows[g.r1]||(k._annoRows[g.r1]=g.row));g.col=h[g.c1];g.col2=h[g.c2];g.row.revision(m);q.splice(g.r1,1);break;case "add_col":g.col=
h[g.c1];g.col||(l=Va(g.c1),g.col=h[g.c1]=new Ea(null,k._defColWidth,l),k._annoCols[g.c1]||(k._annoCols[g.c1]=g.col));g.row=q[g.r1];g.row2=q[g.r2];g.col.revision(m);h.splice(g.c1,1);break;case "delete_row":l=g;var p=k,r=m,H=new Ea(null,p._defRowHeight,S.DEL);H.revision(r);r.target=H;K(p,r,H);for(var p=0,C=[],t=0;t<r.cells.length;t++){var N=r.cells[t];N.range.c1>p&&(C.push({e:N.range.c1-p}),p=N.range.c1);C.push(F(N));p++}H.setCellData(C);l.row=H;g.col=h[g.c1];g.col2=h[g.c2];for(g.row.revision(m);g.r1>
q.length;)q.push(null);q.splice(g.r1,0,g.row);h=0<g.r1?(h=q[g.r1-1])?k._annoRows.indexOf(h)+1:g.r1:(h=q[g.r1+1])?k._annoRows.indexOf(h):g.r1;for(;h>k._annoRows.length;)k._annoRows.push(null);k._annoRows.splice(h,0,g.row);if(k._colMajor)for(l=0;l<k._annoCols.length;l++)if(h=k._annoCols[l])m=k._normalCols.indexOf(h),-1!=m&&(m=h,h=m.clone(),k._annoCols[l]=h,m=q.indexOf(m),-1!=m&&(q[m]=h)),h.insertCell(g.r1);break;case "delete_col":l=g;p=k;r=m;H=new Ea(null,p._defColWidth,S.DEL);H.revision(r);r.target=
H;K(p,r,H);p=0;C=[];for(t=0;t<r.cells.length;t++)N=r.cells[t],N.range.r1>p&&(C.push({e:N.range.r1-p}),p=N.range.r1),C.push(F(N)),p++;H.setCellData(C);l.col=H;g.row=q[g.r1];g.row2=q[g.r2];for(g.col.revision(m);g.c1>h.length;)h.push(null);h.splice(g.c1,0,g.col);h=0<g.c1?(h=h[g.c1-1])?k._annoCols.indexOf(h)+1:g.c1:(h=h[g.c1+1])?k._annoCols.indexOf(h):g.c1;for(;h>k._annoCols.length;)k._annoCols.push(null);k._annoCols.splice(h,0,g.col);if(!k._colMajor)for(l=0;l<k._annoRows.length;l++)if(h=k._annoRows[l])m=
k._normalRows.indexOf(h),-1!=m&&(m=h,h=m.clone(),k._annoRows[l]=h,m=q.indexOf(m),-1!=m&&(q[m]=h)),h.insertCell(g.c1);break;case "clear_cell":for(;g.c2>=h.length;)l=Va(h.length),m=new Ea(null,k._defColWidth,l),h.push(m),k._annoCols.push(m);for(;g.r2>=q.length;)l=Za(q.length),m=new Ea(null,k._defRowHeight,l),q.push(m),k._annoCols.push(m);case "new_cell":case "modify_cell":case "move_cells":g.col=h[g.c1],g.row=q[g.r1],g.c2!=g.c1&&(g.col2=h[g.c2]),g.r2!=g.r1&&(g.row2=q[g.r2])}}for(a=0;a<e._revisions.length;a++){f=
e;d=e._revisions[a];if(k=R(f,d.range))d.annoRange=k;if(f=R(f,d.oldrange))d.oldAnnoRange=f}if(a=e._page.comments())for(d=0;d<a.length;d++)g=a[d],"cell"===g.type&&g.range&&"cell"===g.range.type&&(f=g,k=e,g=g.range,k._normalCols&&k._normalRows?(g.col=k._normalCols[g.c1],g.row=k._normalRows[g.r1],g.c2!=g.c1&&(g.col2=k._normalCols[g.c2]),g.r2!=g.r1&&(g.row2=k._normalRows[g.r2]),k=R(k,g)):k=void 0,f.annoRange=k);e.showAnnotations(w.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};a.revisions=
function(){return this._revisions};a.rowRevisions=function(a){if(a=this._rows[a])return a.revision()};a.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var C=function(a,b,c){a[b]?(Array.isArray(a[b])||(a[b]=[a[b]]),a[b].push(c)):a[b]=c},M=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,h=a[d];h||(h=a[d]=[]);h[f]?(Array.isArray(h[f])||(h[f]=[h[f]]),h[f].push(g)):h[f]=g}},G=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,
a):b.push(a));return b};a.getCellRevisions=function(a,c){var f;if(this._revisions){if(!this._revisionMap){for(var g=this._revisions,h={cols:[],rows:[],cells:[]},m=0;m<g.length;m++){var l=g[m],k=l.annoRange||l.range,q=l.oldAnnoRange||l.oldrange;b[l.type]?(k&&C(h.rows,k.r1,l),q&&C(h.rows,q.r1,l)):e[l.type]?(k&&C(h.rows,k.c1,l),q&&C(h.rows,q.c1,l)):d[l.type]&&(k&&M(h.cells,k,l),q&&M(h.cells,q,l))}this._revisionMap=h}f=G(this._revisionMap.cols[a],f);f=G(this._revisionMap.rows[c],f);(g=this._revisionMap.cells[c])&&
(f=G(g[a],f))}return f};return c}(),Ad=function(){var b={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,c,d,e){this._data=a=a||{};this._model=c;this._style=a.s?c.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var f=c.getMergedCell(d,e);f&&(d>f.range.c1||e>f.range.r1)&&(this._mergedOut=!0);var f=this._style,g=a.e&&a.gs?
c.colStyle(d):{},m=c.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var h in b)if(b.hasOwnProperty(h)){var l=f[h]||g[h]||m[h];void 0!==l&&(this[b[h]]=l)}"null"==this._fill&&(this._fill=null);"null"==this._fillBg&&(this._fillBg=null);a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/
180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=
void 0;if(a=c.getCellComments(d,e,!0))this._comments=a;if(c=c.getCellRevisions(d,e))for(a=0;a<c.length;a++)if(h=c[a],h.range&&h.range.c1==d&&h.range.r1==e||h.oldrange&&h.oldrange.c1==d&&h.oldrange.r1==e){this._hasRevision=!0;break}},d=Z(e);d.hasText=function(){return this._text&&0<this._text.length};d.textRight=function(){return this._textRight};d.horizontalMerge=function(){return this._data.mh||0};d.verticalMerge=function(){return this._data.mv||0};d.horizontalAlign=function(){return this._align};
d.leftBorder=function(){return this._leftBorder||null};d.topBorder=function(){return this._topBorder||null};d.rightBorder=function(){return this._rightBorder||null};d.bottomBorder=function(){return this._bottomBorder||null};d.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var f=b[e],g=f.x,h=f.y,m=f.o,l=0;l<f.spans.length;l++){var k=f.spans[l],
q=m+k.t.length;if(q>d&&m<a){var m=g+k.w,p=h+f.h;c?(g<c.left&&(c.left=g),h<c.top&&(c.top=h),m>c.right&&(c.right=m),p>c.bottom&&(c.bottom=p)):c={left:g,top:h,right:m,bottom:p}}g+=k.w;m=q}return c}};d.drawTextBackground=function(a,b,c,d,e,f,g){!this._mergedOut&&(0>this._textLeft||this._textRight>f)&&(b=d+this._textLeft,d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,g-1,"#ffffff"))};d.drawBackground=
function(a,b,c,d,e,f,g){if(!this._mergedOut&&(this._fill||this.horizontalMerge()||this.verticalMerge()))if(this._fillHatch){b=new qc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";"d"==this._fillHatch.charAt(0)?c.lineWidth=2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,
-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,0,0,8)}b=a.createPattern(y.unwrap(b),"repeat");a.fillStyle=b;a.globalAlpha=1;a.fillRect(d,e,f,g)}else a.oitrect(d,e,f,g,this._fill||"#ffffff")};var c=function(a,b,c,d,e){c||(c=1);var f=2*c;switch(b){case "dotted":b=[f,f];break;case "dashed":b=[2*f,f];break;case "dashdot":b=
[2*f,f,f,f];break;case "dashdotdot":b=[2*f,f,f,f,f,f];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var g=f=0;g<b.length;g++)f+=b[g];e%=f;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},a=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b]},f=function(b,c){var d=0,e=0,f;b&&"double"===b.s&&(f=a(b),d=-f[0]);c&&"double"===c.s&&(f=a(c),
e=f[1]);return d&&e?d>e?-d:-e:d?d:e},g=function(b,c){var d=0,e=0,f;b&&"double"===b.s&&(f=a(b),d=-f[0]);c&&"double"===c.s&&(f=a(c),e=f[1]);return d&&e?[-d,-e]:d?[-d,d]:[e,-e]},k=function(b,d,e,m,l,k,q,h,p){c(b,l.s,l.w,l.c,d);"double"===l.s?(l=a(l),k=g(k,q),h=g(h,p),k[0]||(k[0]=-.5),k[1]||(k[1]=-.5),h[0]||(h[0]=.5),h[1]||(h[1]=.5),b.beginPath(),b.moveTo(d-k[0],e+l[0]),b.lineTo(m+h[0],e+l[0]),b.moveTo(d-k[1],e+l[1]),b.lineTo(m+h[1],e+l[1])):(l=f(k,q),h=f(h,p),l||(l=-.5),h||(h=.5),b.beginPath(),b.moveTo(d-
l,e+.5),b.lineTo(m+h,e+.5));b.stroke()},t=function(b,d,e,m,l,k,q,h,p){c(b,l.s,l.w,l.c,e);"double"===l.s?(l=a(l),k=g(k,q),h=g(h,p),k[0]||(k[0]=-.5),k[1]||(k[1]=-.5),h[0]||(h[0]=.5),h[1]||(h[1]=.5),b.beginPath(),b.moveTo(d+l[0],e-k[0]),b.lineTo(d+l[0],m+h[0]),b.moveTo(d+l[1],e-k[1]),b.lineTo(d+l[1],m+h[1])):(l=f(k,q),h=f(h,p),l||(l=-.5),h||(h=.5),b.beginPath(),b.moveTo(d+.5,e-l),b.lineTo(d+.5,m+h));b.stroke()},v=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>
c.w)&&(c=d)}return c},q=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};d.drawBorder=function(a,b,d,e,f,g,m,h){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var l=e+g;m=f+m;a.lineCap="square";a.lineJoin="miter";a.globalAlpha=1;var p;this._leftBorder&&0<=this._textLeft&&0<b&&(b=v(h[0][0],h[1][0]),p=v(h[1][0],h[2][0]),t(a,e,f,m,this._leftBorder,b,this._topBorder,p,this._bottomBorder));this._topBorder&&0<d&&(b=
q(h[0][0],h[0][1]),d=q(h[0][1],h[0][2]),k(a,e,f,l,this._topBorder,b,this._leftBorder,d,this._rightBorder));this._rightBorder&&this._textRight<=g&&(d=v(h[0][2],h[1][2]),g=v(h[1][2],h[2][2]),t(a,l,f,m,this._rightBorder,this._topBorder,d,this._bottomBorder,g));this._bottomBorder&&(p=q(h[2][0],h[2][1]),g=q(h[2][1],h[2][2]),k(a,e,m,l,this._bottomBorder,this._leftBorder,p,this._rightBorder,g));c(a,null)}};var p=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>
e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=La(d));return e}};d.layoutText=function(a,b,c,d,e,f,g){if(!this._mergedOut&&this.hasText()){var h,k,q;c=!1;var t=null;h=this._data.selection;var r=this._data.highlights;if(h||r&&0<r.length){t=[];h&&(q=T.style()||"background-color:#3399FF;",k=kb(q,"color"),q=kb(q,"background-color"),(k=p(this,h,k,q))&&t.push(k));if(r)for(h=0;h<r.length;h++){var u=r[h];if(q=u.highlightStyleProps())k=q.color,q=q["background-color"],
(k=p(this,u.range,k,q))&&t.push(k)}delete this._data.highlightsChanged}this._wrappedText&&zc(t,this._highlightSpecs,!0)||(this._highlightSpecs&&!t?delete this._highlightSpecs:this._highlightSpecs=t,this._wrappedText=null);this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+d):(this._clearLeft=f,this._clearRight=g);d!=this._layoutWidth&&(this._wrappedText=null);e!=this._layoutHeight&&(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=
this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),h=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,h,e):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a,void 0,e):(b=this.createLine(0,this._text.length,null),m(a,b,this),l(a,b,this),this._wrappedText=[b]),a=this._wrappedText))if(h=void 0!==this._data.v,h="r"==this._align||"rs"==this._align||h&&"g"==this._align,
"c"==this._align||"cs"==this._align)for(h=0;h<a.length;h++)b=a[h],b.x=(d-b.w)/2,f=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),f>this._textRight&&(this._textRight=f);else if(h)for(h=0;h<a.length;h++)b=a[h],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(h=0;h<a.length;h++)b=a[h],b.x=this._indent,f=b.x+b.w,f>this._textRight&&(this._textRight=f);this._layoutHeight=e;if(c)for(a=this._wrappedText,d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&
(c=e-d-2),h=0;h<a.length;h++)b=a[h],b.y=c,c+=b.h}};d.drawText=function(a,b,c,d,e,f,g){b=this._wrappedText;if(!this._mergedOut&&b){c=!1;var h=b[b.length-1],h=h.y+h.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>f||h>g){f=d+this._textLeft;var m=d+this._textRight;if(f<this._clearLeft||void 0!==this._clearRight&&m>this._clearRight||h>g)f<this._clearLeft&&(f=this._clearLeft),void 0!==this._clearRight&&m>this._clearRight&&(m=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle=
"black",a.rect(f,e,m-f,g),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(f=0;f<b.length;f++){h=b[f];if(h.y>g)break;for(var m=d+h.x,l=e+h.y,k=0;k<h.spans.length;k++){var q=h.spans[k],p=this._font,t=this._fontSize,u=this._fontStyle,L=this._fontWeight,v=this._color,n=this._textdec,x=this._baseline,C=null;q.s&&
(q.s.f&&(p=q.s.f),q.s.s&&(t=q.s.s),q.s.fs&&(u=q.s.fs),q.s.fw&&(L=q.s.fw),q.s.c&&(v=q.s.c),q.s.d&&(n=q.s.d),q.s.ba&&(x=q.s.ba),q.s.bg&&(C=q.s.bg));q.hs&&(q.hs.c&&(v=q.hs.c),q.hs.bg&&(C=q.hs.bg));var E=Q(l+h.a);x&&("sup"===x?(E+=-.35*h.a,t*=.65):"sub"===x&&(E+=.141*h.a,t*=.65));if(C){x=C;C=1;if(0===x.indexOf("rgba(")||0===x.indexOf("rgb(")){var y=Da(x);y&&(x=La(y.r,y.g,y.b),C=y.a)}a.fillStyle=x;a.globalAlpha=C;a.fillRect(m-1,E-h.a,q.w+2,h.h+2)}a.font=w(p,t,u,L);a.fillStyle=v||"black";a.globalAlpha=
1;a.fillText(q.t,m,E);if(n){var H,G,F;switch(n){case "u":F=1;H=E+F;break;case "d":F=1;H=E+F;G=H+F+F;break;case "l":F=1,H=E-.25*q.a}void 0!==H&&(H=Q(H)+.5,a.strokeStyle=v,a.lineWidth=F,a.beginPath(),a.moveTo(m,H),a.lineTo(m+q.w,H),void 0!==G&&(G=Q(G)+.5,a.moveTo(m,G),a.lineTo(m+q.w,G)),a.stroke(),a.closePath())}m+=q.w}}c&&a.restore()}};d.drawFlags=function(a,b,d,e,f,g,m){this._mergedOut||void 0===this._data.fm||(b=f+m,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgba(52,113,183,0.5)",
a.fillStyle="rgba(52,113,183,0.5)",a.lineWidth=1,a.beginPath(),a.moveTo(e,b),a.lineTo(e,b-6),a.lineTo(e+6,b),a.lineTo(e,b),a.fill(),c(a,null));this._comments&&(e+=g,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgb(255,0,0)",a.fillStyle="rgb(255,0,0)",a.lineWidth=1,a.beginPath(),a.moveTo(e,f),a.lineTo(e,f+6),a.lineTo(e-6,f),a.lineTo(e,f),a.fill(),c(a,null))};d.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a},e,f,g,h;if(c){h=a;for(var m,l=0;l<c.length;l++){e=c[l];
if(e.o>h&&(f=e.o,f>b&&(f=b),h=this._text.substring(h,f),d.spans.push({t:h,w:0,s:m}),h=f,h>=b))break;m=this._model.cellStyle(e.s)}h<b&&(h=this._text.substring(h,b),d.spans.push({t:h,w:0,s:m}))}else h=this._text.substring(a,b),d.spans.push({t:h,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=this._highlightSpecs[b],h=a,m=0;m<d.spans.length;m++)l=d.spans[m],f=h+l.t.length,c.o<f&&c.oend>h&&(e=c.o-h,0<e&&(f=l.t.substring(0,e),g=l.t.substring(e),e={t:f,w:0},l.s&&(e.s=l.s),
l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(m,0,e),m++,l.t=g,h+=f.length,f=h+l.t.length),e=c.oend-h,e<l.t.length&&(f=l.t.substring(0,e),g=l.t.substring(e),e={t:g,w:0},l.s&&(e.s=l.s),l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(m+1,0,e),l.t=f,f=h+l.t.length),l.hs||(l.hs={}),c.s.c&&(l.hs.c=c.s.c),c.s.bg&&(l.hs.bg=c.s.bg)),h=f;return d};var m=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=b.spans[d],f=c._font,g=c._fontSize,
h=c._fontStyle,l=c._fontWeight,m=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(g=e.s.s),e.s.fs&&(h=e.s.fs),e.s.fw&&(l=e.s.fw),e.s.baseline&&(m=e.s.baseline));m&&("sup"===m?g*=.65:"sub"===m&&(g*=.65));a.font=w(f,g,h,l);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},l=function(a,b,c){Ia||(Ia=y.create("div","oit-textmeasure"),u.rootNode.append(Ia));b.h=0;b.a=0;Ia.css("display","inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,f=c._fontSize,g=c._fontStyle,h=c._fontWeight;d.s&&(d.s.f&&
(e=d.s.f),d.s.s&&(f=d.s.s),d.s.fs&&(g=d.s.fs),d.s.fw&&(h=d.s.fw));Ia.text(d.t);var l=y.create("span");Ia.append(l);Ia.css("font",w(e,f,g,h));Ia.offsetHeight>b.h&&(b.h=Ia.offsetHeight);d.a=l.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Ia.html("");Ia.attr("style","");Ia.css("display",null)};d.wrapText=function(a,b,c){var d=[];void 0!==b&&(b-=4);var e=0,f=0,g=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=this._layoutHeight;else{var h=
Math.tan(this._angle),k=-this._layoutHeight-h,q=2*this._layoutHeight+h,h=Math.min(Math.min(Math.sqrt(k*k),Math.sqrt(h*h+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+q*q));h<b&&(b=h)}h=this._text;h=this._data.cs||void 0!==b?h.replace(/\s/g,"\ufffd"):h.replace(/\n/g,"\ufffd");for(k=0;e<this._text.length;){g=h.indexOf("\ufffd",g);-1==g&&(g=h.length);q=this.createLine(e,g,this._data.cs);m(a,q,this);var p=void 0!==b&&q.w>b;if(p||"\n"==this._text[g]||g>=this._text.length){if(p)if(f>
e)g=f,q=this.createLine(e,g,this._data.cs),m(a,q,this);else for(p=e+1;g>p&&!(q.w<=b);)if(g=p+Math.floor(b/q.w*(g-p)),q=this.createLine(e,g,this._data.cs),m(a,q,this),g>p&&q.w<=b){for(;q.w<=b;)g++,q=this.createLine(e,g,this._data.cs),m(a,q,this);g--;q=this.createLine(e,g,this._data.cs);m(a,q,this)}l(a,q,this);q.y=k;k+=q.h;d.push(q);if(void 0!==c&&k>=c)break;g<this._text.length&&(e=this._text[g]," "!=e&&"\t"!=e&&"\n"!=e||g++);e=g}else f=g++}if(0!==d.length)return d};var w=function(a,b,c,d){0>=b&&(b=
10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Ia=null,kd=function(){return function(b,e){var d=this,c=b,a=e,f,g,k,t,v,q,p,m,l,K,F,N,H,R,C,M=[],G,h,B,V,I=0,r=0,A=40,J=22,O,L,X,n,x=w.zoom,W="database"!==e.type,E,ba=-1,S=-1,ma=-1,qa=-1,Ga=!1,ka,pa,ya;this.unload=function(){ya&&(D.resumeIdleTimer("update"),ra(ya),ya=null);d.hidePopup(!0);ka&&(ka.destroy(),ka=null);D.offscroll(Z);T.offselectionchanged(Y);z.offpageload(U);la.offresize(aa);R&&R.destroy();
for(var b=c.embeddingCount(),e=0;e<b;e++)c.embed(e).node=void 0;K&&(a.append(K),K=void 0);v&&v.destroy();p&&p.destroy();l&&l.destroy();f&&f.destroy();Ia&&(Ia.destroy(),Ia=null);G=M=C=R=F=K=l=m=p=q=v=t=f=a=c=d=null};this.layoutChanged=function(a){w.zoom!=x&&(d.hidePopup(),aa())};var U=function(b){K&&(a.append(K),F=K=void 0);aa()};this.maxPageWidth=function(){var a=c.sheetRight();void 0!==E&&E>a&&(a=E);return a};this.maxPageHeight=function(){return c.sheetBottom()};this.padding=function(){return{left:A,
top:J,right:0,bottom:0}};this.visibleRange=function(){return ta(r,I,n,X)};this.visibleHeight=function(){return Pa(X)-Wa(I)};this.scrollOffset=function(a,b){void 0===a&&(a=r);void 0===b&&(b=I);var d=Q(c.colLeft(a)*x)+1,e=Q(c.rowTop(b)*x)+1;return{left:d,top:e}};var Z=function(a,b,e,f,g){var h=I;f/=x;if(0<e)for(;!(c.rowBottom(h)>=f);)h++;else if(0>e)for(e=I;0<=e;e--)if(c.rowTop(e)<=f){h=e;break}e=r;f=b/x;if(0<a)for(;!(c.colRight(e)>=f);)e++;else if(0>a)for(a=r;0<=a;a--)if(c.colLeft(a)<=f){e=a;break}if(e!=
r||h!=I)r=e,I=h,!1!==g&&(d.update(),d.hidePopup())},Y=function(b,d){if(d){if(C){var e=c.getSelectedText();C.html(e);C.select()}if(c.isRangeSelected())ka.disable(),ka.setText(void 0);else if(e=D.cellSelection()){var f=c.getFormulaText(e.c1,e.r1);f||(f=c.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);ka.enable();ka.setText(f)}else ka.setText(void 0);if(w.showAnnotations){var g,e=D.cellSelection(),f=a.annotationPane();if(e&&f){g=!c.isRangeSelected();!pa||pa.c==e.c1&&pa.r==e.r1||(pa=null);var h=pa?pa.anno:
null,n=null,l=c.getCellComments(e.c1,e.r1),m=c.getCellRevisions(e.c1,e.r1);h&&g&&(l&&(g=l.indexOf(h),-1!=g&&((n=l[g+1])||(n=m?m[0]:l[0]))),!n&&m&&(g=m.indexOf(h),-1!=g&&((n=m[g+1])||(n=l?l[0]:m[0]))));n||((n=Da(l,e))||(n=Da(m,e)),n||(l?n=l[0]:m&&(n=m[0])));n&&(pa={anno:n,c:e.c1,r:e.r1},f.activate(n))}}}fa();ja()};this.showHidden=function(b,e){if(c){var f=!1;!0===b?c.eachCol(function(a){c.showCol(a)&&(f=!0)}):!1===b&&c.eachCol(function(a){c.resetCol(a)&&(f=!0)});!0===e?c.eachRow(function(a){c.showRow(a)&&
(f=!0)}):!1===e&&c.eachRow(function(a){c.resetRow(a)&&(f=!0)});f&&(E=void 0,P.deactivate(),T.update(),d.update(),P.positionAll(a),D.dispatchPageEvents())}};var aa=function(a){var b=u.viewNode;t&&g==b.clientWidth&&k==b.clientHeight&&x==w.zoom||(g=b.clientWidth,k=b.clientHeight,x=w.zoom,Q(g/x),Q(k/x),(b=hb())&&(1==x?b.css("transform",null):b.css("transform","scale("+x+","+x+")")),t&&(t.destroy(),q.destroy(),m.destroy()),v||(v=y.create("div","oit-ssgrid"),p=y.create("div","oit-sscolheader"),p.onmousemove(Ea),
p.ondragstart(Fa),p.ondragmove(Ra),p.ondragend(Oa),p.ondragcancel(Oa),p.onpress(Ja),p.onpressup(La),l=y.create("div","oit-ssrowheader"),l.onmousemove(Ta),l.ondragstart(Ya),l.ondragmove(Aa),l.ondragend(Ma),l.ondragcancel(Ma),l.onpress(Na),l.onpressup(Ua),f.append(v,p,l)),f.css({width:g+"px",height:k+"px"}),A=l.offsetWidth,J=p.offsetHeight,t=v.createCanvas(),q=p.createCanvas(),m=l.createCanvas(),c.updateDimensions(),!1!==a&&d.update())};this.pageRect=function(b,d){if("view"===d||"overlay"===d||d===
a){var e=0,f=0,g=c.sheetRight(),h=c.sheetBottom();if("view"===d||"overlay"===d){var n=w.zoom;1!=n&&(e*=n,f*=n,g*=n,h*=n);"view"===d&&(n=this.scrollOffset(),e+=A-n.left,f+=J-n.top,g+=A-n.left,h+=J-n.top)}return new ia(e,f,g,h,d)}};this.rangeRect=function(b,d,e){var f;if("cell"===b.type){f=b.r1;var g=b.r2,n=b.c1,l=b.c2,m=b.offsets;b.offsets?f=new ia(c.colLeft(n)+m.left,c.rowTop(f)+m.top,c.colLeft(l)+m.right,c.rowTop(g)+m.bottom,a):(b.selectingRows&&(n=0,l=c.colCount()-1),b.selectingCols&&(f=0,g=c.rowCount()-
1),f=new ia(c.colLeft(n)+1,c.rowTop(f)+1,c.colRight(l),c.rowBottom(g),a))}else if("rect"===b.type)"px"!==b.units&&(b=ha(b),xa(b,"px")),f=new ia(b),void 0!==b.embedId&&(g=c.embedByUID(b.embedId),b=a.embeddingRect(b.embedId),g&&b&&f.offset(b.left,b.top));else if("text"==b.type&&(g=c.mapToCells(b)))for(n=0;n<g.length;n++){var k=g[n],l=c.colLeft(k.c1),m=c.rowTop(k.r1),q;a:{q=k.c1;var p=k.r1;if(q>=G.c1&&q<=G.c2&&p>=G.r1&&p<=G.r2){var x=M[p-G.r1];if(x){q=x[q-G.c1];break a}}q=h&&q==B&&p==V?h:void 0}p=!1;
q||(q=c.getCell(k.c1,k.r1),q=za(k.c1,k.r1,q),p=!0);p&&(p=t.getContext("2d"),p.save(),p.font="12px Arial,Helvetica,sans-serif",sa(p,k.c1,k.r1,q),p.restore());if(k=q.rangeRect(b))k.left+=l,k.right+=l,k.top+=m,k.bottom+=m,f?f.union(k):f=new ia(k,a)}if(f)return!0===e&&(e=u.viewNode,e=new ia(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=f.origin,f.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===f.width||0===f.height)&&(f=void 0),f&&d&&(f.origin=d),f};this.rangeFromRect=function(b,f,g,
h,n,l,m,k,q,p){b=new ia(f,g,h,n,l);b.origin=a;if(void 0!==k)return q=e.embeddingRect(k),"move"===m?b.constrain(q):b.intersect(q),b.offset(-q.left,-q.left),f=b.toRange(),f.embedId=k,xa(f,"pct"),f;"move"!==m&&"resize"!==m&&"extend"!==m&&("view"===l&&(f-=A,g-=J),p|=f<c.colLeft(r),q|=g<c.rowTop(I));k=new ia(0,0,c.sheetRight(),c.sheetBottom(),a);"move"===m?b.constrain(k):b.intersect(k);k=!p&&!q;f=c.cellFromPos(b.left,b.top,k);k=c.cellFromPos(b.right,b.bottom,k);p?(f.c1=0,f.c2=c.colCount()-1,f.selectingRows=
!0):f.c2=k.c1;q?(f.r1=0,f.r2=c.rowCount()-1,f.selectingCols=!0):f.r2=k.r1;if("move"===m||"resize"===m)m=d.rangeRect(f,a,!1),b.left-1>m.left&&f.c1<f.c2&&(f.c1+=1),b.top-1>m.top&&f.r1<f.r2&&(f.r1+=1),b.right<m.right&&f.c1<f.c2&&--f.c2,b.bottom<m.bottom&&f.r1<f.r2&&--f.r2;p||q?(p&&(f.selectingRows=!0),q&&(f.selectingCols=!0)):(f.offsets={left:b.left-c.colLeft(f.c1),top:b.top-c.rowTop(f.r1),right:b.right-c.colLeft(f.c2),bottom:b.bottom-c.rowTop(f.r2)},f=c.expandRange(f));return f};this.extendRange=function(a,
b,c,e){var f=d.rangeRect(a,e,!1),g=f.left,f=f.top,g=a.selectingRows?g-A:g+1,f=a.selectingCols?f-J:f+1;b=d.rangeFromRect(a.page,g,f,b,c,e,"extend",void 0,a.selectingCols,a.selectingRows);b.offsets&&!a.offsets&&delete b.offsets;return b};this.update=function(a){ya||(D.pauseIdleTimer("update"),ya=da(this.doUpdate,0,this,a))};this.doUpdate=function(b){ya&&(D.resumeIdleTimer("update"),ra(ya),ya=null);var d=u.viewNode;if(!Ga){Ga=!0;var e=c.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)Hc.loadWebFont(e[f])}var h=
Q(-c.colLeft(r)*x),m=Q(-c.rowTop(I)*x);u.drawing.setOrigin(h+A,m+J);L=r;n=void 0;for(var l=A;L<c.colCount();){if(!c.colHidden(L)&&(l+=Q(c.colWidth(L)*x),l>=d.clientWidth)){l==d.clientWidth?n=L:(n=L-1,n<r&&(n=r));break}L++}void 0===n&&(n=L);O=I;X=void 0;for(var k=J;O<c.rowCount();){if(!c.rowHidden(O)&&(k+=Q(c.rowHeight(O)*x),k>=d.clientHeight)){k==d.clientHeight?X=O:(X=O-1,X<I&&(X=I));break}O++}void 0===X&&(X=O);c.loadDataForCells(r,I,L,O,!0);var q=fb();if(q){var p=u.viewNode,v=p.pos(p.parent());q.css({left:v.left+
A+"px",top:v.top+J+"px",width:p.clientWidth-A+"px",height:p.clientHeight-J+"px"});hb().css({left:h+"px",top:m+"px"});for(var y=c.embeddingCount(),B=0;B<y;B++){var C=c.embed(B);if(C&&C.node&&C.position)if(void 0===C.c2)C.node.css({left:C.position.left-C.adjustX+"px",top:C.position.top-C.adjustY+"px"});else if(C.position.left===C.position.right||C.position.top===C.position.bottom)C.node.css("display","none");else{var z=(C.position.right-C.position.left)/C.w,F=(C.position.bottom-C.position.top)/C.h,
Sc,K;if(1!=z||1!=F)Sc="scale("+z+","+F+")",K="left top";C.node.css({display:null,left:C.position.left-C.adjustX*z+"px",top:C.position.top-C.adjustY*F+"px",transform:Sc,"transform-origin":K})}}}var R=t.getContext("2d");R.clearRect(0,0,t.width,t.height);R.save();var ma,V=G,ba,ka;c.cellGridChanged()?(M=V=G=null,c.cellGridChanged(!1)):!0===b&&(G=null);var qa=r;if(0<r)for(ba=I;ba<=O;ba++)if(!c.rowHidden(ba)&&(ma=c.getCell(r,ba),!ma||!ma.t&&!ma.v)){var pa=c.prevTextCell(r,ba);void 0!==pa&&pa<qa&&(qa=pa)}if(G&&
(G.c1!=qa||G.c2!=L||G.r1!=I||G.r2!=O)){if(qa>G.c2||L<G.c1||I>G.r2||O<G.r1)M=V=null;G=null}if(!G){G=ta(qa,I,L,O);var P=M;M=[];for(ba=G.r1;ba<=G.r2;ba++)c.rowHidden(ba)||(M[ba-G.r1]=[]);var S=null,U=null;for(ba=G.r1;ba<=G.r2;ba++)if(!c.rowHidden(ba))for(ka=G.c1;ka<=G.c2;ka++){ma=c.getCell(ka,ba);var Z=c.colStyle(ka),ea=c.getCellComments(ka,ba),na=c.getCellRevisions(ka,ba),Y=ea||na||ma!==S||null!==Z?null:U;if(!Y){if(V){var Ca=ba-V.r1;if(0<=Ca&&Ca<P.length&&P[Ca]){var ca=ka-V.c1;0<=ca&&ca<P[Ca].length&&
(Y=P[Ca][ca])}}Y||(Y=za(ka,ba,ma))}M[ba-G.r1][ka-G.c1]=Y;S=ma;U=Y}}R.font="12px Arial,Helvetica,sans-serif";var da=Q((c.colRight(c.colCount()-1)-c.colLeft(r))*x),Ha=Q((c.rowBottom(c.rowCount()-1)-c.rowTop(I))*x),Sa=u.viewNode,ga=Sa.clientWidth,ha=Sa.clientHeight;W||(ga>da&&(ga=da),ha>Ha&&(ha=Ha));R.oitrect(0,0,ga,ha,"#ffffff");R.fillStyle=W?"#f3f3f3":"#eaeaea";Sa.clientWidth>da&&R.fillRect(da,0,Sa.clientWidth-da,Sa.clientHeight);Sa.clientHeight>Ha&&R.fillRect(0,Ha,Sa.clientWidth,Sa.clientHeight-Ha);
for(var ia=!1,la=r+1;;la++){var Mb=c.colHidden(la);if(!Mb||!ia){var ua=ab(la);if(ua>ga)break;var va=ua+.5;R.oitline(va,0,va,ha,"#e0e0e0")}ia=Mb}for(var ia=!1,wa=I+1;;wa++){var xa=c.rowHidden(wa);if(!xa||!ia){var Lb=Wa(wa);if(Lb>ha)break;var Db=Lb+.5;R.oitline(0,Db,ga,Db,"#e0e0e0")}ia=xa}var Ba=E;c.colLeft(r);c.rowTop(I);for(var Da=0,Ea=0;Ea<M.length;Ea++){var Oa=M[Ea],Pa=Ea+G.r1,Ia=c.rowHeight(Pa);if(0<Ia){var Fa=0;G.c1!=r&&(Fa=c.colLeft(G.c1)-c.colLeft(r));for(var Ra=Fa,Ja=0;Ja<Oa.length;Ja++){var Qa=
Ja+G.c1,La=c.colWidth(Qa);if(0<La){var Ma=Oa[Ja];if(Ma&&Ma.hasText()){sa(R,Qa,Pa,Ma,Ra,Fa,Da,La,Ia);var Ta=c.colLeft(Qa)+Ma.textRight();if(void 0===E||Ta>E)E=Ta;Ra=Fa+La}Fa+=La}}Da+=Ia}}var Va=d.clientWidth,Ya=d.clientHeight,Aa,Na=c.sheetRight(),Ua=c.sheetBottom();void 0!==E&&E>Na&&(Na=E);a.width=Na;a.height=Ua;var Xa=u.viewNode,Za=Xa.clientWidth/x,cb=Xa.clientHeight/x,$a=20/x,ib=A/x,jb=J/x,Eb=Na+ib+$a;if(Eb>Za){for(var bb=c.colCount()-1;c.colLeft(bb)<Na;)bb++;for(var lb=bb,gb=c.colWidth(lb),Cb=lb-
1;0<=Cb;Cb--){var ob=gb+c.colWidth(Cb);if(ob>Za)break;gb=ob}Aa=Za-gb;0>Aa&&(Aa=0);Aa+=$a;var pb=c.colRight(bb)+ib+Aa;pb>Eb&&(Eb=pb)}var db=Ua+jb+$a;if(db>cb){for(var eb=c.rowCount()-1;c.rowTop(eb)<Ua;)eb++;for(var rb=eb,kb=c.rowHeight(rb),nb=rb-1;0<=nb;nb--){var wb=kb+c.rowHeight(nb);if(wb>cb)break;kb=wb}Aa=cb-kb;0>Aa&&(Aa=0);Aa+=$a;var yb=c.rowBottom(eb)+jb+Aa;yb>db&&(db=yb)}void 0===N&&(N=Dc(a),H=Ec(a));var sb=Math.ceil(Eb*x),tb=Math.ceil(db*x);sb>N&&(D.hiddenContent("large-sheet-unsupported"),
sb=N);tb>H&&(D.hiddenContent("large-sheet-unsupported"),tb=H);a.css({width:sb+"px",height:tb+"px"});if(E!=Ba||Va!=d.clientWidth||Ya!=d.clientHeight)R.restore(),g=-1,aa();else{R.scale(x,x);oa(R,"drawTextBackground");oa(R,"drawBackground");oa(R,"drawBorder",!0);R.restore();R.save();var vb=c.revisions();if(vb&&w.showAnnotations){R.save();for(var zb=0;zb<vb.length;zb++){var mb=vb[zb],Kb=mb.annoRange||mb.range,Fb=mb.oldAnnoRange||mb.oldrange;switch(mb.type){case "new_cell":qb(R,Kb,null,"rgba(44,156,58,0.5)");
break;case "modify_cell":qb(R,Kb,null,"rgba(148,57,174,0.5)");break;case "clear_cell":qb(R,Kb,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Gb=R,ub=Kb.r1;if(ub<=O&&ub>=I){var Hb=ta(a.index,0,ub,c.colCount()-1,ub),xb=Ka(Hb);Gb.oitrect(xb.left,xb.top,xb.width,xb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Ib=R,Ab=Kb.c1;if(Ab<=L&&Ab>=r){var Jb=ta(a.index,Ab,0,Ab,c.rowCount()-1),Bb=Ka(Jb);Ib.oitrect(Bb.left,Bb.top,Bb.width,Bb.height,"rgba(234,158,158,0.1)")}break;case "move_cells":qb(R,
Fb,null,"rgba(213,61,61,0.5)"),qb(R,Kb,null,"rgba(44,156,58,0.5)")}}R.restore()}R.scale(x,x);oa(R,"drawText");oa(R,"drawFlags");R.restore();fa();ja();T.update(!1)}};this.hidePopup=function(a){};this.moveto=function(a,b,d){var e=!1;if(kc(a))if("text"===a.type)(a=c.mapToCells(a))&&0<a.length&&(e=this.moveto(a[0],b,d));else if("cell"===a.type){for(e=a.c1;e<=a.c2;e++)if(c.colHidden(e)){w.showHiddenColumns=!0;break}for(e=a.r1;e<=a.r2;e++)if(c.rowHidden(e)){w.showHiddenRows=!0;break}a.selectingRows||a.selectingCols||
(a=c.expandRange(a));e=u.viewNode.scroll();this.scrollToRange(a.c1,a.r1,a.c2,a.r2);a=u.viewNode.scroll();Z(a.left-e.left,a.left,a.top-e.top,a.top,!0);b&&b(d);e=!0}return e};this.scrollToRange=function(a,b,d,e){var f=u.viewNode,g,h;if(a<r)g=a;else if(d>n){var m=f.clientWidth-A;for(g=d;0<=g;){m-=Q(c.colWidth(g)*x);if(0===m)break;if(0>m){g++;break}if(0===g)break;g--}a<g&&(g=a)}if(b<I)h=b;else if(e>X){a=f.clientHeight-J;for(h=e+1;0<=h;){a-=Q(c.rowHeight(h)*x);if(0===a)break;if(0>a){h++;break}if(0===h)break;
h--}b<h&&(h=b)}b=this.scrollOffset(g,h);var l,k;void 0!==g&&(l=b.left);void 0!==h&&(k=b.top);f.scroll(l,k)};var fa=function(){var a=q.getContext("2d");a.save();a.oitrect(0,0,p.clientWidth,p.clientHeight,"#eaeaea");a.oitrect(0,0,A,J,"#eaeaea");a.oitrect(A-11.5,J-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=x?a.font="12px Arial,Helvetica,sans-serif":(b*=x,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=D.cellSelection(),d=
J/2,e=0,f=!1,g=r,h=r;W||h<=c.colCount();h++){var n=0;c.colHidden(h)?e++:(n=Q(c.colWidth(h)*x),0===n?e++:e&&(e=0,f=!0));if(1>=e){var m=ab(h)+A;h==r?(m-=.5,n+=1):m+=.5;if(m>p.clientWidth)break;f&&(m+=2,f=!1);var l=null;if(w.showAnnotations){var k=c.colRevisions(h);if(k){for(var t=!1,L=!1,u=0;u<k.length;u++)"add_col"==k[u].type?t=!0:L=!0;t&&L?l="rgba(201,156,214,0.5)":t?l="rgba(149,205,156,0.5)":L&&(l="rgba(234,158,158,0.5)")}}!l&&b&&h>=b.c1&&h<=b.c2&&(l="#d0d0d0");l&&(a.oitrect(m,0,n,J,"#FFF"),a.oitrect(m,
0,n,J,l),a.fillStyle="black");a.strokeStyle=b&&h>b.c1&&h<=b.c2?"#c1c1c1":"#d0d0d0";a.oitline(m,0,m,J,a.strokeStyle);if(!W&&h>=c.colCount())break;0<n&&(a.save(),a.beginPath(),a.rect(m,0,n,J),a.clip(),(l=c.colTitle(h,!1))||(l=Va(g)),a.measureText(l).width>=n?(n=m+1,a.textAlign="left"):(n=m+n/2,a.textAlign="center"),c.colOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(l,n,d),a.restore())}c.colDeleted(h)||g++}b=.5;a.oitline(0,b,p.clientWidth,b,"#d0d0d0");b=J-.5;a.oitline(0,b,p.clientWidth,
b,"#d0d0d0");a.restore()},ja=function(){var a=m.getContext("2d");a.save();a.oitrect(0,0,l.clientWidth,l.clientHeight,"#eaeaea");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=x?a.font="12px Arial,Helvetica,sans-serif":(b*=x,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=D.cellSelection(),d=A/2,e=0,f=!1,g=I,h=I;W||h<=c.rowCount();h++){var n=0;c.rowHidden(h)?e++:(n=Q(c.rowHeight(h)*x),0===n?e++:e&&(e=0,f=!0));if(1>=e){var k=Wa(h);h==I?(k-=.5,n+=1):k+=.5;
if(k>l.clientHeight)break;f&&(k+=2,f=!1);var q=null;if(w.showAnnotations){var p=c.rowRevisions(h);if(p){for(var t=!1,L=!1,r=0;r<p.length;r++)"add_row"==p[r].type?t=!0:L=!0;t&&L?q="rgba(201,156,214,0.5)":t?q="rgba(149,205,156,0.5)":L&&(q="rgba(234,158,158,0.5)")}}!q&&b&&h>=b.r1&&h<=b.r2&&(q="#d0d0d0");q&&(a.oitrect(0,k,A,n,"#FFF"),a.oitrect(0,k,A,n,q),a.fillStyle="black");.5<k&&(a.strokeStyle=b&&h>b.r1&&h<=b.r2?"#c1c1c1":"#d0d0d0",a.oitline(0,k,A,k,a.strokeStyle));if(!W&&h>=c.rowCount())break;0<n&&
(a.save(),a.beginPath(),a.rect(0,k,A,n),a.clip(),(q=c.rowTitle(h,!1))||(q=Za(g)),n=k+n/2,c.rowOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(q,d,n,A),a.restore())}c.rowDeleted(h)||g++}b=A-.5;a.oitline(b,0,b,l.clientHeight,"#d0d0d0");a.restore()},Ka=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=ab(a.c1);b.right=Qa(a.c2);b.top=Wa(a.r1);b.bottom=Pa(a.r2);a=u.viewNode.clientWidth;var c=u.viewNode.clientHeight;b.left=ca(b.left,-100,a+100);b.right=ca(b.right,-100,a+100);
b.top=ca(b.top,-100,c+100);b.bottom=ca(b.bottom,-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},qb=function(a,b,c,d){b&&b.c1<=L&&b.c2>=r&&b.r1<=O&&b.r2>=I&&(b=Ka(b),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},ga=function(a,b){return!a||0>b||b>=a.length?null:a[b]},oa=function(a,b,d){var e=0,f,g;d&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var h,n=null,m=0<M.length?M[0]:null,l=0;l<
M.length;l++){h=n;var n=m,m=l+1<M.length?M[l+1]:null,k=l+G.r1,q=c.rowHeight(k);if(0<q){var p=0;G.c1!=r&&(p=c.colLeft(G.c1)-c.colLeft(r));for(var x=0;x<n.length;x++){var t=x+G.c1,L=c.colWidth(t),u=n[x];if(0<L&&u){var v=u.horizontalMerge(),E=u.verticalMerge(),y=L,w=q;for(g=1;g<=v;g++)y+=c.colWidth(t+g);for(g=1;g<=E;g++)w+=c.rowHeight(k+g);!0===d&&(f[0][0]=ga(h,x-1),f[0][1]=ga(h,x),f[0][2]=ga(h,x+1),f[1][0]=ga(n,x-1),f[1][1]=u,f[1][2]=ga(n,x+1),f[2][0]=ga(m,x-1),f[2][1]=ga(m,x),f[2][2]=ga(m,x+1));u[b](a,
t,k,p,e,y,w,f)}p+=L}e+=q}}},sa=function(a,b,d,e,f,g,h,n,m){var l,k;void 0===g&&(g=c.colLeft(b)-c.colLeft(r));void 0===h&&(h=c.rowTop(d)-c.rowTop(I));void 0===n&&(n=c.colWidth(b));void 0===m&&(m=c.rowHeight(d));if(void 0===f)for(f=g,l=b-1;0<=l;l--){var q=c.getCell(l,d);if(q&&(q.t||q.v))break;f=c.colLeft(l)-c.colLeft(r)}var q=e.horizontalMerge(),p=e.verticalMerge();if((l="cs"===e.horizontalAlign())||0<q)for(k=1;(l||k<=q)&&!(l&&(l=c.getCell(b+k,d),l=!l||l.t||l.v?!1:"cs"===c.cellStyle(l.s).a,!l&&k>q));)n+=
c.colWidth(b+k),k++;for(k=1;k<=p;k++)m+=c.rowHeight(d+k);q=c.colLeft(r);p=c.colRight(L)-q;k=void 0;W||(k=c.colRight(b)-q);for(b+=1;;b++){l=c.getCell(b,d);if(!l)break;if(l.t||l.v){k=c.colLeft(b)-q;break}l=c.colRight(b)-q;if(l>p)break;W||(k=l)}e.layoutText(a,g,h,n,m,f,k)},za=function(a,b,d){h=d=new Ad(d,c,a,b);B=a;V=b;return d},ua=function(a){var b;if(a>=A){a-=A;for(var d=r;d<c.colCount();){var e=Qa(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=d,a<=e))break;d++}}return b},va=function(a){var b;
if(a>=A)for(a-=A,b=r;!(a<Qa(b));b++);return b},wa=function(a){var b;if(a>=J){a-=J;for(var d=I;d<c.rowCount();){var e=Pa(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=d,a<=e))break;d++}}return b},Ba=function(a){var b;if(a>=J)for(a-=J,b=I;!(a<Pa(b));b++);return b},Da=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Xa(e.range,b)){c=e;break}if(e.oldrange&&0===Xa(e.oldrange,b)){c=e;break}}return c},Ea=function(a){-1==qa&&-1==S&&(a=u.viewNode.mousePos(a),a=void 0!==ua(a.x)?"col-resize":
null,q.css("cursor",a))},Fa=function(a){return-1==qa&&(a=ua(a.center.x),void 0!==a)?(S=a,!1):!0},Ra=function(b){if(-1!=qa)b=va(b.center.x),T.select(ta(a.index,qa,0,b,c.rowCount()-1));else if(-1!=S){b=Q((b.center.x-A)/x)+c.colLeft(r);var e=c.colLeft(S);b=b>=e?b-e:0;b!=c.colWidth(S)&&(c.setColWidth(S,b),T.update(),d.update(),P.positionAll(a))}return!1},Oa=function(b){-1!=S&&(S=-1,aa(),P.positionAll(a));return!1},Ja=function(b){qa=va(b.center.x);T.select(ta(a.index,qa,0,qa,c.rowCount()-1))},La=function(a){qa=
-1},Ta=function(a){-1==ma&&-1==ba&&(a=u.viewNode.mousePos(a),a=void 0!==wa(a.y)?"row-resize":null,m.css("cursor",a))},Ya=function(a){return-1==ma&&(a=wa(a.center.y),void 0!==a)?(ba=a,!1):!0},Aa=function(b){if(-1!=ma)b=Ba(b.center.y),T.select(ta(a.index,0,ma,c.colCount()-1,b));else if(-1!==ba){b=Q((b.center.y-J)/x)+c.rowTop(I);var e=c.rowTop(ba);b=b>=e?b-e:0;b!=c.rowHeight(ba)&&(c.setRowHeight(ba,b),T.update(),d.update(),P.positionAll(a))}return!1},Ma=function(b){-1!==ba&&(ba=-1,aa(),P.positionAll(a));
return!1},Na=function(b){ma=Ba(b.center.y);T.select(ta(a.index,0,ma,c.colCount()-1,ma))},Ua=function(a){ma=-1},Wa=function(a){return Q((c.rowTop(a)-c.rowTop(I))*x)},Pa=function(a){return Q((c.rowBottom(a)-c.rowTop(I))*x)},ab=function(a){return Q((c.colLeft(a)-c.colLeft(r))*x)},Qa=function(a){return Q((c.colRight(a)-c.colLeft(r))*x)},fb=function(){void 0===K&&(K=a.childByClass("oit-sheet-embedpane"))&&u.viewNode.parent().append(K);return K},hb=function(){if(void 0===F){var a=fb();F=a?a.childByClass("oit-sheet-embedlist"):
null}return F};(function(){var b=u.viewNode;f=b.parent().childByClass("oit-ssoverlay");f||(f=y.create("div","oit-ssoverlay"),b.parent().insert(f,b));f.html("");R=a.overlay.childByClass("oit-sel-text");R||(R=y.create("div"),a.overlay.append(R));C=y.create("pre");R.addClass("oit-sel-text");R.html("");R.append(C);ka=new yd;ka.show();D.onscroll(Z);T.onselectionchanged(Y);z.onpageload(U);la.onresize(aa);b=b.scroll();Z(b.left,b.left,b.top,b.top,!1);aa(!1);da(function(){P.eachOnPage(function(a){c.addHighlight(a);
P.link(a)},a)},0)})()}}(),zd=function(){function b(a,b,c){this.value=a;this.type=b;this.subtype=c}function e(){this.items=[];this.add=function(a,c,d){d||(d="");a=new b(a,c,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==
this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function d(){this.items=[];this.pushToken=function(a,c,d){this.items.push(new b(a,c,d))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new b(a.value,a.type,z)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?
this.token().value:""};this.type=function(){return this.token()?this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function c(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(n,"");a=a.replace(W,"@");a=a.replace(E,"");var l=a.length,m=a.indexOf("!")+1,k="";0<m&&(k=a.slice(0,m-1));var q=a.slice(m,a.length),p=k.match(x);if(p&&d){var t=""+p[0],p="'";t.charCodeAt(0)==X&&(t=t.slice(1,t.length),p="");t=t.slice(1,t.length-1);t=parseInt(t,10);0<t&&t--;if(t<d.length){d=d[t];
d=d.replace(O,"\\");var t=d.lastIndexOf("\\"),u;0<=t?(u=d.slice(t+1,d.length),d=d.slice(0,t+1)):(u=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));k="'"+k.replace(x,d+"["+u+"]")+p;k=k.replace(ba," ")}}p=a.charCodeAt(m);m<l&&p==r&&(e=!0,m++,p=a.charCodeAt(m));for((d=m<l&&p>=A&&p<=J)||(g=e);m<l&&p>=A&&p<=J;)f=26*f+(p-A+1),m++,p=a.charCodeAt(m);16172<f&&(d=!1);m<l&&p==r&&(g=!0,m++,p=a.charCodeAt(m));for(t=m<l&&p>=P&&p<=L;m<l&&p>=P&&p<=L;)h=10*h+(p-P),m++,p=a.charCodeAt(m);e||(f+=b);g||
(h+=c);0<f&&f--;""!==k&&(k+="!");return m==l&&(d||t)?k+(d?(e?"$":"")+Va(f):"")+(t?(g?"$":"")+h:""):k+q}function a(a){for(var b=new e,c=new d,x=0,L=function(){return a.substr(x,1)},r="",v=!1,E=!1,X=!1,A=!1;0<a.length;)if(" "==a.substr(0,1))a=a.substr(1);else{"="==a.substr(0,1)&&(a=a.substr(1));break}for(var F=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(x>=a.length);)if(v)'"'==L()?'"'==a.substr(x+1,1)?(r+='"',x+=1):(v=!1,b.add('"'+r+'"',g,H),r=""):r+=L(),x+=1;else if(E)"'"==L()?"'"==a.substr(x+1,1)?(r+="'",x+=1):
(r+=L(),E=!1):r+=L(),x+=1;else if(X)"]"==L()&&(X=!1),r+=L(),x+=1;else if(A)r+=L(),x+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+r+",")&&(A=!1,b.add(r,g,M),r="");else if(-1!="+-".indexOf(L())&&1<r.length&&r.match(F))r+=L(),x+=1;else if('"'==L())0<r.length&&(b.add(r,y),r=""),v=!0,x+=1;else if("'"==L())0<r.length?(b.add(r,y),r=""):r+=L(),E=!0,x+=1;else if("["==L())X=!0,r+=L(),x+=1;else if("#"==L())0<r.length&&(b.add(r,y),r=""),A=!0,r+=L(),x+=1;else if("{"==L())0<r.length&&(b.add(r,
y),r=""),b.add("{",k,w),c.pushToken("}",k,z),b.add("",k,w),c.pushToken("",k,z),x+=1;else if(";"==L())0<r.length&&(b.add(r,g),r=""),b.addRef(c.pop()),b.add(";",u),b.add("",k,w),c.pushToken("",k,z),x+=1;else if("}"==L())0<r.length&&(b.add(r,g),r=""),b.addRef(c.pop()),b.addRef(c.pop()),x+=1;else if(" "==L())for(0<r.length&&(b.add(r,g),r=""),b.add("",l),x+=1;" "==L()&&!(x>=a.length);)x+=1;else-1!=",>=,<=,<>,".indexOf(","+a.substr(x,2)+",")?(0<r.length&&(b.add(r,g),r=""),b.add(a.substr(x,2),p,C),x+=2):
(-1!="+-*/^&=><".indexOf(L())?(0<r.length&&(b.add(r,g),r=""),b.add(L(),p)):-1!="%".indexOf(L())?(0<r.length&&(b.add(r,g),r=""),b.add(L(),m)):"("==L()?0<r.length?(b.add(r.replace(n,"")+"(",k,w),c.pushToken(")",k,z),r=""):(b.add("(",t,w),c.pushToken(")",t,z)):","==L()?(0<r.length&&(b.add(r,g),r=""),c.type()!=k?b.add(L(),p,I):b.add(L(),u)):")"==L()?(0<r.length&&(b.add(r,g),r=""),b.addRef(c.pop())):r+=L(),x+=1);0<r.length&&b.add(r,g);for(c=new e;b.moveNext();)r=b.current(),r.type==l?b.BOF()||b.EOF()||
(b.previous().type==k&&b.previous().subtype==z||b.previous().type==t&&b.previous().subtype==z||b.previous().type==g)&&(b.next().type==k&&b.next().subtype==w||b.next().type==t&&b.next().subtype==w||b.next().type==g)&&c.add(" ",p,D):c.addRef(r);for(;c.moveNext();)r=c.current(),r.type==p&&"-"==r.value?c.BOF()?r.type=q:c.previous().type==k&&c.previous().subtype==z||c.previous().type==t&&c.previous().subtype==z||c.previous().type==m||c.previous().type==g?r.subtype=h:r.type=q:r.type==p&&"+"==r.value?c.BOF()?
r.type=f:c.previous().type==k&&c.previous().subtype==z||c.previous().type==t&&c.previous().subtype==z||c.previous().type==m||c.previous().type==g?r.subtype=h:r.type=f:r.type==p&&0===r.subtype.length?-1!="<>=".indexOf(r.value.substr(0,1))?r.subtype=C:r.subtype="&"==r.value?B:h:r.type==g&&0===r.subtype.length?isNaN(parseFloat(r.value))?r.subtype="TRUE"==r.value||"FALSE"==r.value?C:G:r.subtype=R:r.type==k&&"@"==r.value.substr(0,1)&&(r.value=r.value.substr(1));c.reset();for(b=new e;c.moveNext();)c.current().type!=
f&&b.addRef(c.current());b.reset();return b}var f="noop",g="operand",k="function",t="subexpression",u="argument",q="operator-prefix",p="operator-infix",m="operator-postfix",l="white-space",y="unknown",w="start",z="stop",H="text",R="number",C="logical",M="error",G="range",h="math",B="concatenate",D="intersect",I="union",r=36,A=65,J=90,P=48,L=57,X=39,n=/\u005F[^\u002E]*\u002E/,x=/^'?\u005B[0-9]+\u005D/,W=/\u005B\u0023This Row\u005D/,E=/\u005B\u005D/,ba=/%20/g,O=/\u002F/g;return function(b,d,e,f){b=
a(b);for(var g="",h;b.moveNext();){var n=b.current();if(n.subtype!=I&&n.type!=u||!h||h.subtype!=G||64!=h.value.charCodeAt(h.value.length-1)){if(n.subtype==G){h=n;var m;m=n.value;var l=d,k=e,q=f,p=m.lastIndexOf(":");m=0<p?c(m.slice(0,p),l,k,q)+":"+c(m.slice(p+1),l,k,q):c(m,l,k,q);h.value=m}g+=n.value}h=n}return g}}(),vd=function(){var b={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",
ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",
FI_OUTLOOK_MSG_JOURNAL:"journal",FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",
ai:"vector",bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",
pgm:"image",pic:"vector",pif:"vector",png:"image",ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},d=function(c){U.call(this,c);y.attach(this);this._page=z.forNode(c);if(!this._page._fields&&(c=(c=this.byClass("oit-maildata"))?
c[0]:y.byId("oit-maildata"))){var d=this.byClass("oit-emhdrlabel"),C=this.byClass("oit-emhdrvalue"),H=[];if(d&&C&&d.length==C.length)for(var G=0;G<d.length;G++){var h=d[G],B=C[G];if("oit-email_attachments"!=h.id){var D={},I;h.id&&0===h.id.indexOf("oit-email_")&&(I=h.id.substring(10).toUpperCase(),D.id=b[I]||I);if(!D.id)for(I=0;;I++){var r=h.classList.item(I);if(!r)break;if(0===r.indexOf("oit-email_")){I=r.substring(10).toUpperCase();D.id=b[I]||I;break}}D.id||(D.label=h.html());h=B.attr("data-acc");
1==B.dom.childElementCount?B=B.firstChildElem():(I=y.create("div"),I.transferFrom(B),B=I);h&&(B.attr("data-acc",h),"none"===h&&B.addClass("oit-noacc"));D.value=B.dom.outerHTML;H.push(D)}}this._page._fields=H;c.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');this._hdrtable=this.byClass("oit-maildata")[0];
c=this.parent().parent();c.hasClass("oit-emailstream")&&(d=y.create("div","oit-emailbk"),d.transferFrom(c),c.append(d),c.addClass("oit-emailfill"));d=this._page._fields;c=this.byClass("oit-em_allheaders")[0];if(w.removeExtraEmailHeaders||u.isMobile)c.destroy(),c=null;a(d);switch(this.data("subtype")){case "journal":C=w.journalHeader;break;case "contact":C=w.contactHeader;break;case "note":C=w.noteHeader;break;case "appt":C=w.appointmentHeader;break;case "task":C=w.taskHeader;break;case "post":C=w.postHeader;
break;case "dist":C=w.distroHeader;break;default:C=w.emailHeader}H=this._page._fields;if(C.subjectField)if(D=m(H,C.subjectField),G=m(H,C.dateField),!C.subjectField&&!C.dateField||D||!1===C.defaultSubject||(D=new Tc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),D){if(D.addedToHeader=!0,B=this.subjectBar=y.create("div","oit-email-subjectbar"),h=D.clone(),h.addContainerClass("oit-email-subject"),h.appendAsDiv(B),h.labelElem.html(""),this.fixedSubjectField=
h,h.valueElem.text()||(h.valueElem.addClass("oit-nosubject"),h.valueElem.text(S.NO_SUBJECT)),h=this._hdrtable.parent(),h.insert(B,h.firstChildElem()),D.hide(),G&&(this.headerDateField=G,D=G.clone(),D.addContainerClass("oit-email-date"),D.appendAsDiv(B),this.fixedDateField=D,G.appendAsRow(this._hdrtable),G.hide()),!u.isMobile&&(G=B.clone(!0)))this.stickyHeader=y.create("div","oit-email-stickyheader"),this.stickyHeader.append(G),this.stickyHeader.onmouseover(this,l),this.stickyHeader.onmouseout(this,
K),this.stickyHeader.ontap(this,F),u.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");C.photoField&&(G=m(H,C.photoField))&&(G.addContainerClass("oit-email-photo"),G.insertAsDiv(this._hdrtable.parent(),this._hdrtable),G.labelElem.html(""));C.logoField&&(G=m(H,C.logoField))&&
(G.addContainerClass("oit-email-logo"),G.insertAsDiv(this._hdrtable.parent(),this._hdrtable),G.labelElem.html(""));if(C.headerFields)for(B=y.create("tbody"),D=0;D<C.headerFields.length;D++)if(h=C.headerFields[D],"string"==typeof h||Array.isArray(h))(I=m(H,h))&&I.appendAsRow(this._hdrtable);else if(h.fields)if(h.multi){I=[];for(G=0;G<h.fields.length;G++)p(H,h.fields[G],null,I);for(G=0;G<I.length;G++)I[G].appendAsRow(this._hdrtable)}else if(h.title){r=[];for(G=0;G<h.fields.length;G++)if(I=m(H,h.fields[G]))I.showType(!1),
r.push(I);if(0<r.length)for(B.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+S["EMAIL_"+h.title]+S.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(B.firstChildElem()),G=0;G<r.length;G++)r[G].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=y.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;C=y.wrap(this._hdrtable.clone(!0));G=!1;B=0;for(D=C.firstChildElem();D;D=H)H=D.nextSiblingElem(),B++,G||(20<B?G=!0:D.firstChildElem().hasClass("oit-emhdrsection")&&
(G=!0)),G&&D.destroy();this.stickyHeaderDetail.append(C);this.stickyHeader.append(this.stickyHeaderDetail);this.stickyDateHeaderField=C.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=C.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());q(this.stickyHeader)}f(d)&&(this._emailExpander=y.create("div","oit-showemail"),
this._emailExpander.onclick(this,v),this._emailExpander.ontap(this,v),this._hdrtable.parent().insert(this._emailExpander,this._hdrtable),w.showEmailAddresses?k.call(this):t.call(this));if(c)if(C=c.firstChildElem(),d=g(C,d))for(this.allHeaders=new Bd(this,c,"oit-email_gear_icon",18,18,S.SHOWDETAILS,S.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),C=0;C<d.length;C++)d[C].tab=this.allHeaders;else c.destroy(),c=null;c||this.removeExtraEmailHeaders();if((c=this._page._attachments)&&
0<c.length){d=this.byClass("oit_attachments")[0];C=y.create("div");for(H=0;H<c.length;H++)G=c[H],G.ext||(B=G.name,D=B.lastIndexOf("."),G.ext="",-1!=D&&(G.ext=B.substring(D+1).toLowerCase())),(B=e[G.file_id]||e[G.ext])||(B="generic"),B=['<div class="oit-attached-file" data-index="',G.id,'">','<div class="oit-ficon oit-ficon-',B,'"><div></div></div>','<div class="oit-attinfo">',"<div>",G.displayName||G.name,"</div>"],G.size&&(B.push("<div>"),G.size&&B.push(Cc(G.size)),B.push("</div>")),B.push("</div></div>"),
C.html(B.join("")),B=C.firstChildElem(),d.append(B),wb.on.addElement(B,G.id);C.html('<div style="clear:both;"></div>');d.append(C.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},c=Z(d,U);c.destroy=function(){wb.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();U.prototype.destroy.call(this)};c.scrollPadding=function(){if(this.stickyHeaderVisible)return{top:this.stickyHeader.offsetHeight}};var a=function(b,c){if(b)for(var d=
0;d<b.length;d++){var e=b[d];e.appendAsRow||(b[d]=new Tc(e,c));e.subfields&&a(e.subfields,b[d])}},f=function(a){var b=!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=f(d.subfields)))break}return b},g=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,m=c,l=e.subfields;if(l)for(var k=
!0,q=0;q<l.length;q++){var p=l[q];if(!p.addedToHeader&&(p.hasValue()||p.subfields)){if(e&&k){var t=S["EMAIL_"+e.fieldId];if(t||e.fieldDef.label){var u,k=[];k.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(u=e.fieldType.substring(1,e.fieldType.length-1));t?k.push('<span data-acc="none" class="oit-noacc">',t):k.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');u&&k.push(" (",u,")");k.push(S.LABEL_SEPARATOR,"</span></td><td></td></tr>");k=k.join("");t=y.create("tbody");
t.html(k);f.append(t.firstChildElem())}k=!1}p.appendToExtra(f);m.push(p)}p.subfields&&g(f,p.subfields,m)}}}return 0===c.length?null:c};c.applyShowEmailAddresses=function(){this._emailExpander&&(w.showEmailAddresses?k.call(this):t.call(this),this.applyViewSize(!0))};var k=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),z.each("pageLayoutChanged"))},
t=function(){this._emailExpander&&(this._page.removeClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),z.each("pageLayoutChanged"))},v=function(){w.showEmailAddresses=!w.showEmailAddresses},q=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())q(a)},p=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<
b.length;e++)p(a,b[e],null,d);else if(b.g)for(c=b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=a[e],f.subfields&&f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&p(f.subfields,b.id,b.d,d):p(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var g=null;if(c&&"string"==typeof c)for(var m=0;m<a.length;m++){var l=a[m];if(l.hasValue()&&!l.addedToHeader&&l.fieldId==c){g=l;break}}f.setDisplayField(g)}}},
m=function(a,b){if(a&&b){var c=[];p(a,b,null,c);if(1<=c.length)return c[0]}},l=function(){if(this.stickyHeaderDetail&&!T.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},K=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},F=function(){this.stickyHeaderDetailShown?K.call(this):l.call(this)};c.applyViewSize=function(a){var b;this.stickyHeader&&
this.stickyHeader.css("width",null);this.fixedSubjectField&&(a=this.fixedSubjectField.containerWidth(),this.fixedDateField&&(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=u.viewNode.clientWidth,w.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&
this.fixedDateField.show(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display",null),this.headerDateField&&this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=u.viewNode.clientWidth,w.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())P.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};c.finishAnimation=
function(){this._page&&this._page.finishAnimation()};c.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),w.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!w.nochrome)){var a=u.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};c.hideStickyHeader=function(){this.stickyHeader&&
this.subjectBar&&this.stickyHeaderVisible&&(this.stickyHeader.removeClass("oit-email-shvisible"),this.stickyHeaderVisible=!1)};c.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};c.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};c.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=
0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=e.subfieldByRange(a))return b}}};c.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};c.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!w.showEmailAddresses)for(var f=
0;f<e.length;f++){var g=e[f].address;if(g){var m=g.acc;if(m+g.text.length>=a.acc&&m<=a.accend){w.showEmailAddresses=!0;break}}}b&&b(c)}return d}};c.onStyleChanged=function(){this.applyEmailHeaderStyles()};c.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(H){this.logError("email header style","An error occurred setting email header style")}};var D=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)D(a.subfields[d],
b)&&a.subfields.splice(d,1);if(!a.addedToHeader||a.extra)a.range&&b.push(a.range),c=!0;return c};c.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)D(a[c],b)&&a.splice(c,1);b.length&&(ja.replaceRawText(b),P.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return d}(),Bd=function(){var b=function(a,b,c,e,t,u,q){U.call(this,"div","oit-button");y.attach(this);
c&&this.addClass(c);this._header=a;this._minHeight=this._fullHeight=t;this._clientDiv=b;this._active=!1;this._utip=u;q&&(this._atip=q);u&&this.attr("title",u);if(this._clientDiv)this._clientDiv.on("scroll",null,d,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=Z(b,U);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(d),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);U.prototype.destroy.call(this)};var d=
function(a,b){var c=b._clientDiv.scroll();b._scroll&&c.left==b._scroll.left&&c.top==b._scroll.top||(b._scroll=c,c=z.page(0),P.deactivate(),c.pageLayoutChanged(),P.positionAll(c))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=y.wrap(a.startContainer);a=y.wrap(a.endContainer);var c=y.isDescendantOf(b,this._clientDiv);if(c||y.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(a){if(this._clientDiv.childByClass("oit-emheadervalues")&&
(a=J.rangeRect(a,"view"))){var b=0,c=0,e=u.viewNode.clientWidth,t=u.viewNode.clientHeight;0>a.left?b=a.left-10:a.right>e&&(b=a.right+10-e);0>a.top?c=a.top-10:a.bottom>t&&(c=a.bottom+10-t);if(b||c)u.viewNode.dscroll(b,c),d(null,this)}};var c=function(a,b,c){(b=b.getEmailFieldForRange(a.range))&&b.tab&&(a.id==P.active()&&P.deactivate(),a.removeFromPage(c))};e.activate=function(a,b){var d=this._active;"toggle"==b?d=!d:"boolean"===typeof b&&(d=b);if(d!==this._active){var e=this._header._page;this._header.finishAnimation();
(this._active=d)||"tab"!==this._selectionPos||T.select(null);d||(P.each(c,e,this._header,e.index),u.viewNode.scroll(0,0));d?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return b}(),Tc=function(){var b="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],d=function(a,b){U.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=y.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},c=Z(d,U);c.clone=function(){return new d(this.fieldDef)};c.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};c.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};c.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};c.showType=function(a){this.showGroupType=!!a};c.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};c.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Jc(this.range,a)&&(b=this);return b};c.toTagName=function(a,b){var c=f(this.container,a);if(this.labelElem){var d=f(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=f(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};c.containerWidth=function(){return this.container.offsetWidth};c.addContainerClass=function(a){this.container.addClass(a)};c.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};c.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};c.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};c.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};c.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};c.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],a(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=b.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};c.parseStandardEmailAddresses=function(){if(this.range){var a=y.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=y.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var f=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?(e.accend=f,e.text+=d.nodeValue):(e={text:d.nodeValue,acc:b,accend:f},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var f=[],g=d.toUpperCase(),k=(d.match(/@/g)||[]).length,v=(g.match(/CN=/g)||[]).length,g=(g.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,k=0===v?k+g:0===g?k+v:k+Math.min(v,g);if(0===k)d=f;else{var w=u(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,k),v=u(d,/((?:[^;"]|"[^"]*")+)/g,k),g=
u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,k),k=u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,k);if(!w||v&&v.diff<w.diff)w=v;if(!w||g&&g.diff<w.diff)w=g;if(!w||k&&k.diff<w.diff)w=k;if(w){if(k=w.list)for(var z=0,v=0;v<k.length;v++){g=k[v];z=d.indexOf(g,z);if(-1==z)break;var w=e+z,z=z+g.length,D=null,h=null,B=-1,J=-1,I=g.lastIndexOf("<"),r=g.lastIndexOf(">"),A=g.lastIndexOf("["),P=g.lastIndexOf("]"),O=void 0,L=void 0;0<=I&&r>I?(O=I,L=r):0<=A&&P>A&&(O=A,L=P);void 0!==O&&L+1<g.length&&(O=void 0);void 0!==O?(D=g.substring(0,
O),B=w,h=g.substring(O+1,L),J=w+O+1):(r=g.toUpperCase(),I=r.indexOf("CN="),0<I&&"/"!==r.charAt(I-1)&&(I=-1),0<=I?(h=g,J=w,D=g.indexOf("/",I),-1==D&&(D=g.length),D=g.substring(I+3,D),B=w+I+3):-1!=g.indexOf("@")?(h=g,J=w):(D=g,B=w));D=t(D,B);h=t(h,J);D||(D=h,h=null);(D||h)&&f.push({name:D,address:h})}d=f}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};c.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=
0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};var a=function(b,c){switch(b.fieldId){case "ORGANIZER":case "ATTENDEE":var d=b.subfieldById("DISPLAYAS"),e=b.subfieldById("EMAIL")||b.subfieldById("ORGANIZER");if(d&&d.fieldDef&&d.fieldDef.value&&d.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var f=y.create("div");f.html(d.fieldDef.value);var g=f.text();f.html(e.fieldDef.value);f=f.text();g=t(g,d.fieldDef.range.acc);f=t(f,e.fieldDef.range.acc);g&&f&&(c.push({name:g,
address:f}),b.markAddedToHeader(!0))}break;case "ATTENDEES":for(d=0;d<b.subfields.length;d++)a(b.subfields[d],c)}};c.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=y.create("div");b.html(a.fieldDef.value);var c=t(b.text(),a.range.acc);b.html(this.fieldDef.value);b=t(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};c.hasValue=
function(){return"string"==typeof this.fieldDef.imageurl||"string"==typeof this.fieldDef.value};c.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=S["EMAIL_"+a.id])&&(a.label=c);var d=y.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(S.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",
this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(S.LABEL_SEPARATOR)||b.push(S.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=y.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=y.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<
c&&g(", ",b),d.name&&k(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:null,null,null,b),d.address&&(k(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=y.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+
"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;this.valueElem.hasClass("oit-datetime-field")?e=Nb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=Ac(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=Bc(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var f=function(a,b){var c=y.create(b);c.addClass(a.attr("class"));
var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",d);return c},g=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},k=function(a,b,c,d,e,f,k){a=Bb(a);d=Bb(d);k.push("<span");d&&k.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&k.push(' class="',c,'"');e||f?(k.push(">"),e&&(0>b?k.push(e):g(e,k)),k.push("<span",' data-acc="'),0<b?k.push(b):k.push("none"),k.push('">',a,"</span>"),f&&(0>b?k.push(f):g(f,k))):(k.push(' data-acc="'),
0<b?k.push(b):k.push("none"),k.push('">',a));k.push("</span>")},t=function(a,b){if(a){for(var c=0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=t(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},u=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].toUpperCase().indexOf("CN="))&&b++;if(0<b)return{list:a,
count:b,diff:Math.abs(b-c)}}};return d}(),Cd=function(){var b=function(){U.call(this,"div","oit-scrollpane");this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),
!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),!1,!0);this.prop("scrollup",this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);u.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,t),this.onpanmove(this,v));this.scrollbar.onclick(this,c);this.scrollbar.ontap(this,c);this.scrollthumb.ondragstart(this,a);this.scrollthumb.ondragmove(this,f);this.scrollthumb.ondragend(this,g);this.scrollthumb.ondragcancel(this,g);this.scrollthumb.onclick(this,
k);this.prop("content",this.childByClass("oit-scrollpanecontent"),!1,!0);this.content.onwheel(this,d);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});y.attach(this)},e=Z(b,U);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=
this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},contentHeight:{get:function(){return this.content.outerHeight}},visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof O.UIEvent?c=new UIEvent("scroll"):
(c=Y.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",!0,!1,O,null,2),c&&this.dispatchCustom("scroll",c)):!1!==b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof U?b=a.rect(this.content):a instanceof ia&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof ia?b=a:a instanceof U&&(b=a.rect(this.content));return b?(a=this.scrollTop*w.zoom,
b.top<a+this.visibleHeight*w.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",
b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",c?null:0)}}};var d=function(a){if(!a.ctrlKey&&this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},c=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},a=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",
.1);return!1},f=function(a){var b=this.content.outerHeight,c=100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},g=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},k=function(a){return!1},t=function(a){return!1},v=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(a){var b=!0;"wheel"==a.type&&(d.call(this,a),b=!1);return b};return b}(),Rb={paragraph:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",
badgeCls:null,title:"COMMENT"},add:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},move:{requireText:!1,skipIfNoText:!0,
showIcon:!1,showTo:!1,showFrom:!0,checkRanges:!0,textCls:"oit-anno-move",badgeCls:null,title:"MOVED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,
textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!1,showFrom:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},wd=function(){var b=/\S/,e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),d=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',
S.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',S.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',S.LOCATION,'</option><option value="author">',S.AUTHOR_A_TO_Z,'</option><option value="rauthor">',S.AUTHOR_Z_TO_A,'</option><option value="date">',S.OLDEST_FIRST,'</option><option value="rdate">',S.NEWEST_FIRST,'</option><option value="type">',S.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),c=function(a){U.call(this,
"div","oit-annopane");this._page=a;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(d);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];this._title=this.byClass("oit-annotitle")[0];this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];
this._scrollPane=new Cd;this._block.append(this._scrollPane);this.onclick(z.deactivateAnnotation);this.ontap(z.deactivateAnnotation);this._sortSelect.onchange(this,C);this._scrollPane.onscroll(this,aa);la.onresize(this,aa);D.onzoom(this,aa);this._isHidden=!0;this.css("display","none");this.attach()},a=Z(c,U);a.destroy=function(){this._scrollPane.offscroll(this,aa);D.offzoom(this,aa);la.offresize(this,aa);D.offidle(this,p);D.offidle(this,A);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();
U.prototype.destroy.call(this)};a.update=function(){this.isHidden()||this._resizeTimer||(aa.call(this),this.layout(),this.scrollPane().update())};var f=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=b?a._title.text(S.ANNOTATIONS):a._title.text(S.LOADING+" ("+b+"%)")};a.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};a.isEmpty=function(){return 0===this._annos.length&&
0===this._batches.length&&0===this._newGroups.length};a.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};a.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};a.range=function(){return this._range};var g=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=g(a[d],b));d++);else a.range&&(c=cb(a.range,b));return c},k=function(a,
b){var c=a.anno;return g(c.text,b)||g(c.oldtext,b)||g(c.last_save_date||c.create_date||c.date,b)||g(c.author,b)},t=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)t(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ja.getRawText(a.range.acc,a.range.accend))},v=function(a,b,c,d){var e=null,f;if("string"===typeof b)e=y.create("p"),c.append(e),f=y.create("span"),e.append(f),q(a,b,f);else if(Array.isArray(b))for(var g=!0,h=0;h<b.length;h++){var n=b[h];n.range&&d&&(g=a._page.containsRange(n.range));
g&&(e||(e=y.create("p"),c.append(e)),t(n),n.text?(f=y.create("span"),e.append(f),q(a,n,f)):e=null)}},q=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>a._range.accend&&(a._range.accend=b.range.accend)):a._range=ha(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight",
"bold"),b.i&&c.css("font-style","italic")))},p=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var c=this._page,d=c.overlay?c.overlay.layer("comments"):void 0,g,h=0;h<a.length;h++){var k=a[h],l=Rb[k.type],m=!!l;if(l&&l.skipIfNoText){var t=k,u=!1;if(t.text)for(g=0;g<t.text.length;g++){var w=t.text[g];if(w.text&&b.test(w.text)){u=!0;break}}u||(m=!1)}if(m&&k.range){t=m=null;if(k.parentid)for(u=0;u<this._annos.length;u++)if(g=this._annos[u],g.anno.id==k.parentid){m=
g;t=g.groupInfo;break}t||(t={groupDiv:y.create("div","oit-annogroup"),annos:[]},this._newGroups.push(t));u=y.create("div","oit-anno");u.attr("id","oita"+k.id);g=y.create("div","oit-anno-text");if(w=l.title)switch(w=S[w],k.type){case "add_row":w+=" "+Za(k.range.r1);break;case "delete_row":w+=" "+Za(k.range.r1);break;case "add_col":w+=" "+Va(k.range.c1);break;case "delete_col":w+=" "+Va(k.range.c1);break;case "cell":w+=" "+nb(k.range);break;case "new_cell":w+=" "+nb(k.range);break;case "modify_cell":w+=
" "+nb(k.range);break;case "clear_cell":w+=" "+nb(k.range);break;case "move_cells":w+=" "+nb(k.oldrange)+" to "+nb(k.range)}if(l.showFrom&&k.oldtext){if(l.showTo){var z=y.create("div","oit-anno-change-sep oit-noacc");z.attr("data-acc","none");z.text(S.ANNO_CHANGE_FROM);g.append(z)}v(this,k.oldtext,g,l.checkRanges);l.showTo&&(z=y.create("div","oit-anno-change-sep oit-noacc"),z.attr("data-acc","none"),z.text(S.ANNO_CHANGE_TO),g.append(z))}if(l.showTo)if(k.text)v(this,k.text,g,l.checkRanges);else if(l.requireText){z=
y.create("p","oit-noacc oit-unsupportedcontent");z.attr("data-acc","none");var A=y.create("span");A.text(S.UNSUPPORTED_CONTENT);z.append(A);g.append(z)}z=y.create("div","oit-anno-meta");if(A=k.last_save_date||k.create_date||k.date){var C=null;"string"===typeof A?C=Nb(A):A.text&&(C=Nb(A.text));if(C){var F=y.create("span","oit-anno-date");C===A.text?q(this,A,F):(F.text(C),F.addClass("oit-noacc"),F.attr("data-acc","none"));z.append(F)}}C="";A=null;k.author&&(C=y.create("span","oit-anno-author"),q(this,
k.author,C),z.append(C),C=C.text().trim(),0<C.length&&(A=this._authorColors[C],A||(this._authorColors[C]=A=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),C=C.charAt(0).toUpperCase()));if(w){F=y.create("div","oit-anno-type oit-noacc");F.attr("data-acc","none");if(C){var G=y.create("div","oit-badge");A&&G.css("background",A);G.text(C);F.append(G)}G=y.create("span");G.text(w);F.append(G);u.append(F)}u.append(g,z);t.groupDiv.append(u);g={anno:k,annoDiv:u,groupInfo:t};
t.annos.push(g);u.onclick(this,B,g);u.ontap(this,B,g);"text"===k.range.type?(g.spans=Hb(c,k.range,l.textCls,k.id,"page"),m||(g.badge=new pd(c.index,d,l.badgeCls,C),A&&g.badge.css("background",A),g.badge.onclick(this,Q,g),g.badge.ontap(this,Q,g),g.badge.onmouseover(this,I,g),g.badge.onmouseout(this,r,g),g.badge.hide())):l.showIcon&&(m?(g.parent=m,g.icon=m.icon,m.icon.removeClass("oit-commenticon"),m.icon.addClass("oit-commenticonmulti"),m.icon.resetDefaultSize(),k=m.icon.defaultSize(),m.icon.move(void 0,
void 0,k.width,k.height)):(k=new od(c.index,d,"oit-commenticon"),t.groupDiv.data("commenticon",k),k.data("comment",t.groupDiv),k.onclick(this,Q,g),k.ontap(this,Q,g),k.onmouseover(this,I,g),k.onmouseout(this,r,g),g.icon=k,k.hide()));g.index=this._annos.length;this._annos.push(g)}}Y(this)}M(this,!0);this.update()}0===this._batches.length&&(D.offidle(this,p),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,
delete this._processBatchCallbackArg));f(this)};a.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||(this._processingBatches=!0,b&&(this._processBatchCallbackFn=b,this._processBatchCallbackArg=c),D.onidle(this,p),p.call(this));f(this)}};a.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=
0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,Q,b);d.ontap(this,Q,b);d.onmouseover(this,I,b);d.onmouseout(this,r,b)}}Y(this);M(this);this.update()}};a.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();
if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,Q);d.offtap(this,Q);d.offmouseover(this,I);d.offmouseout(this,r)}}G(this)};a.isHidden=function(){return!!this._isHidden};a.panelRect=function(a){return z.elementRect(this._scrollPane,a)};a.contentRect=function(a){return z.elementRect(this._scrollPane.content,a)};a.getSpanMap=function(){this._spanMap||(this._spanMap=new Qc(this._page,this._scrollPane.content));return this._spanMap};a.scrollPane=function(){return this._scrollPane};
a.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};a.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};a.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};a.containsRange=function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};a.annoRect=function(a,
b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new ia(a.icon.rect(u.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=
z.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=J.rangeRect(c,"view");break;default:d=J.expandRange(c),d=J.rangeRect(d,"view")}else d=J.rangeRect(c,"view",!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(u.viewNode),d=new ia(d,"view"),d.width=0,d.height=0);return d};a.annoTextHeight=function(a,b){var c=
0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var m=function(a,b){var c=a.annos[0],d=b.annos[0],c=Xa(c.anno.annoRange||c.anno.range,d.anno.annoRange||d.anno.range);0===c&&(c=K(a,b));return c},l=function(a,b){return-m(a,b)},K=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;
c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},F=function(a,b){return-K(a,b)},N=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=K(a,b));return e},H=function(a,b){return-N(a,b)},O=function(a,b){var c=a.annos[0].anno.type,
d=b.annos[0].anno.type,e=Rb[c],f=Rb[d];e&&e.title&&(c=S[e.title]);f&&f.title&&(d=S[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=m(a,b));return e},C=function(){var a=y.unwrap(this._sortSelect),a=a.item(a.selectedIndex);w.annotationSort=a?a.value:"index"};a.applySort=function(a){var b=w.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=K;break;case "rdate":a=F;break;case "rlocation":a=l;break;case "author":a=N;break;case "rauthor":a=H;break;case "type":a=
O;break;default:a=m}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);y.unwrap(this._sortSelect).value=b;this._spanMap&&P.each("removeFromPage","inAnnotation",this._page.index,!0);delete this._spanMap;this._groupOffsets=[];this.update()}};var M=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display",
"none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};a.onResize=function(a){var b=this._header.clientWidth;if(!0===a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)ra(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],
b.visible&&b.groupDiv.css("height",null);this._resizeTimer=da(function(){this._groupOffsets=[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();M(this);delete this._resizeTimer;this.update()},100,this)}};a.layout=function(){var a=this._page,b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,
d,e=w.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",null)));this._scrollPane.update();a.pagePos("overlay");for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+
g.bottom)/2-10;var g=b.bottom-20-5,h;do{if(d>g)break;for(var k=h=0;k<e;k++)if(k!=e&&this._annos[k].badge){var l=this._annos[k].badge.position(),m=l.bottom- -2;d>l.top-l.height+-2&&d<m&&(d=m,h++)}}while(h&&20>=h);d>g||20<h?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=J.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",
.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new ia(c,d,c+20,d+20,a),0>g.left?g.left=0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};var G=function(a){a._hasUpdateListener||(la.onupdate(a,h),a._hasUpdateListener=!0);la.invalidateCanvas()};a.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=
!1!==a,la.invalidateCanvas())};var h=function(a){if(!this._isHidden&&w.showAnnotations&&this._activeAnno){var b=this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=T.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!cb(d,e)&&cb(d,f)&&(c=f)}if(d=this.annoRect(b,!0,c)){e=u.rootNode;f=u.viewNode;c=f.rect(e);d.origin="view";d.offset(c.left,c.top);var g=d.left,h=d.top,k=d.right,l=d.bottom;0>g&&0<k&&(g=0);k>f.clientWidth&&g<f.clientWidth&&
(k=f.clientWidth);0>h&&0<l&&(h=0);l>f.clientHeight&&h<f.clientHeight&&(l=f.clientHeight);d.move(g,h,k,l);k=b.annoDiv.rect(e);0===k.height&&(k=b.groupInfo.groupDiv.rect(e));J.padding();var m=10;b.spans&&(m=.7*this.annoTextHeight(b,"view"),10>m?m=10:40<m&&(m=40));var p,q,r;p="cell"===b.anno.range.type;q="add_sheet"===b.anno.type||"rename_sheet"===b.anno.type;var h=!1,l=!0,t=k.top+20,v=k.bottom-20,f=k.left,g=t,b=f-10;if(p)h=!0,q?(m=(d.right+d.left)/2,p=d.top,q=m,r=p-10,l=!1):(m=d.right+2,p=d.top+d.height/
2,q=m+10,q>b&&(q=m),r=p);else{var y=d.top-m;r=d.bottom+m;m=(d.right+d.left)/2;p=d.bottom;q=m;var z=this._page.pageRect("view").clone();z.offset(c.left,c.top);if(r>=z.bottom||g<p&&y>z.top)p=d.top,r=y;g=r>v?v:r<t?t:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<k.top?(g=e.bottom,d=!1):g>k.bottom&&(g=e.top,d=!1);l&&q>=b&&(q=m,r=p,b=f);if(m<f||!l)a.save(),e=u.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),
h&&a.arc(m,p,2,0,2*Math.PI,!0),a.moveTo(m,p),a.lineTo(q,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",a.lineWidth=3,a.stroke(),a.restore()}}}};a.deactivate=function(a,b){this.activate(null,!1,!1,a,b)};a.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else if(f._annos){!1!==
b&&(b=!0);var g,h,m;if(a)if(h=wa(a))for(m=0;m<f._annos.length;m++){if(k(f._annos[m],h)){g=f._annos[m];break}}else if(a.anno&&a.groupInfo.groupDiv)g=a;else if(a.id)for(m=0;m<f._annos.length;m++)if(f._annos[m].anno===a){g=f._annos[m];break}if(g)z.deactivateAnnotation(),f._activating=g,w.showAnnotations||(w.showAnnotations=!0),z.movetoEx(this._page.index,{animate:!0,callbackFn:function(){z.scrollToAnnotationPane(function(){f._activeAnno=g;z.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=
0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());G(f);g.annoDiv.addClass("oit-active");if(b){var k;h&&(k=f.getSpanMap().findRange(h.acc,h.accend));if(k){for(var m,a=0;a<k.length;a++){var l=k[a].textRect(h);l&&(m?m.union(l):m=l)}m&&(m.origin=f._scrollPane.content,m.scale(1/w.zoom),f._scrollPane.scrollIntoView(m))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),f._scrollPane.scrollIntoView(g.annoDiv)}if(k=g.anno.annoRange||g.anno.range)if(J.moveto(k),
c&&"cell"===k.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){k=(m=T.cellSelection())&&g.anno.oldrange&&!cb(m,k)&&cb(m,g.anno.oldrange)?ha(g.anno.oldrange):ha(k);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":k.autoExpand=!1}P.pauseAutoHighlight(!0);T.select(k);P.pauseAutoHighlight(!1)}d&&d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||
a.anno.embeds){if(a.spans)for(m=0;m<a.spans.length;m++)a.spans[m].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),"slide"!==a.anno.type&&a.icon.hide());G(f);a.annoDiv.removeClass("oit-active");z.activeAnnotationPane(null);a=null}d&&d(e)}}};var B=function(a,b){this.activate(b,!1,!0);return!1},Q=function(a,b){if(0===y.selectedText().length)return P.deactivate(),T.reset(),this.activate(b,!0,!0),!1},I=function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},r=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},
A=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();f(this);aa.call(this);0===this._newGroups.length&&(this._processingGroups=!1,D.offidle(this,A),M(this,!0),this.applySort(!0),P.queueAddAllToPage(this._page.index,!1,!1,!0))}},Y=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=
D.onidle(a,A),f(a),A.call(a))},aa=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=w.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&(c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",
b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||(c*=w.zoom,d*=w.zoom);for(a=0;a<this._groups.length;a++)if(b=this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=
(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);G(this)}};return c}(),fd=function(){return function(){var b='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+S.ANNOTATIONS+"</span></div></div>",e,d,c;this.show=function(){if(e&&c){var a=w.annoBarWidth;0<a?e.show({size:a}):e.show();c.show()}};this.hide=function(){e&&(c&&c.hide(),e.hide())};this.destroy=function(){ua.offresizeinternal(this,f);z.offchange(this,
a);w.offshowAnnotations(this,a);w.offannoBarWidth(this,a);e&&ua.removeInternal(-3);d&&d.destroy();d=e=null};var a=function(){var a=z.activePage(),a=a?a.annotationPane():null;a!==c&&(c&&(c.css("width",null),c.hide(),z.activeAnnotationPane(null),d.remove(c),c.toolbarMode(!1),c=null),c=a)&&(z.activeAnnotationPane(c),d.append(c),c.toolbarMode(!0),c.scrollPane().setScrollTop(0,!0));a=w.annoBarWidth;0>=a&&(a=void 0);e.applySize(a,void 0,!0);c&&w.showAnnotations?this.show():this.hide()},f=function(a,b,e,
f,q){-3===a&&d&&c&&(0<e&&(w.annoBarWidth=e,e+="px",d.css("width",e),c.css("width",e)),c.showLeader(!q),c.onResize(),la.invalidateCanvas())};d=y.create("div","oit-annobar");e=new Sb(-3,"right",d,null,ua.internalParent(-3));e.resizable(!0,60,30,b);ua.addInternal(-3,e);ua.onresizeinternal(this,f);z.onchange(this,a);w.onshowAnnotations(this,a);w.onannoBarWidth(this,a);a.call(this)}}(),Wb=function(){function b(b,a){var c=b,d;for(d in a)if(a.hasOwnProperty(d))var e=a[d],c=c.replace(new RegExp(("{"+d+"}").replace(/[.*+?^${}()|[\]\\]/g,
"\\$&"),"gm"),e);return c}var e=function(b){if(!b)return this.logError("OIMultimedia","missing options argument"),null;if("string"!==typeof b.url)return this.logError("OIMultimedia","url is missing or not a string"),null;this._url=b.url;this._display=b.display||"multimedia";this._didPlay=this._didFallback=this._didWarn=!1;this._failedToPlay=this._canPlay=null;U.call(this,b.tag,b.selector,b.parentNode);this.attr("controls","");this.attr("controlsList","nodownload");var a=Oa.getOptions().disableCaching?
"?t="+(new Date).getUTCMilliseconds():"";b.parentNode.hasOwnProperty("media_subtype")&&this.attr("type",b.tag+"/"+b.parentNode.media_subtype);this.attr("src",b.url+a);y.attach(this);this._origin=null;this.hide();this._registerListeners()},d=Z(e,U);d.load=function(){Oa.load(this)};d._registerListeners=function(){var b=this;this._failedToPlay=function(){b.onFailedToPlay.apply(b,arguments)};this._canPlay=function(){b.onCanPlay.apply(b,arguments)};this._internalError=function(){b.onInternalError.apply(b,
arguments)};this._missingContent=function(){b.onMissingContent.apply(b,arguments)};Oa.on.failedToPlay.listen(this._failedToPlay);Oa.on.canPlay.listen(this._canPlay);Oa.on.internalError.listen(this._internalError);Oa.on.missingContent.listen(this._missingContent)};d.onFailedToPlay=function(b,a){if(b===this)if(this._didPlay&&!this._didWarn){this._didWarn=!0;var c=new Ob({title:S.MULTIMEDIA_PLAYBACK_WARNING_TITLE,collapseButton:!0});c.message(S.MULTIMEDIA_PLAYBACK_WARNING_MESSAGE);c.expand(!0)}else this._didPlay||
this.fallback(S.MULTIMEDIA_UNSUPPORTED_FORMAT)};d.onMissingContent=function(c,a){if(c===this){var d;switch(a){case Oa.MissingContentStatus.MISSING_AUDIO:d={STREAM_TYPE:S.MULTIMEDIA_AUDIO,STREAM_TYPE_IND:S.MULTIMEDIA_AUDIO_IND};break;case Oa.MissingContentStatus.MISSING_VIDEO:d={STREAM_TYPE:S.MULTIMEDIA_VIDEO,STREAM_TYPE_IND:S.MULTIMEDIA_VIDEO_IND};break;default:d={STREAM_TYPE:S.MULTIMEDIA,STREAM_TYPE_IND:S.MULTIMEDIA_IND}}var e=b(S.MULTIMEDIA_MISSING_STREAM_TITLE_FMT,d);d=b(S.MULTIMEDIA_MISSING_STREAM_MESSAGE_FMT,
d);e=new Ob({title:e,collapseButton:!0});e.message(d);e.expand(!0)}};d.onInternalError=function(b,a){b===this&&(Oa.on.failedToPlay.unlisten(this._failedToPlay),this.fallback(S.MULTIMEDIA_INTERNAL_ERROR))};d.onCanPlay=function(b){b===this&&(this._didPlay=!0,Oa.on.canPlay.unlisten(this._canPlay),this.show())};d.fallback=function(b){this._didFallback||(this._didFallback=!0,this.handleFallback(b))};d.handleFallback=function(b){b=b||S.MULTIMEDIA_UNSUPPORTED_FORMAT;this.hide();var a=new U("div","oit-multimedia-fallback",
this.parent());a.html(b);this.parent().append(a)};return e}(),ud=function(){var b=function(b,d){Wb.call(this,{url:b,tag:"audio",display:"audio",selector:"oit-audio",parentNode:d})};Z(b,Wb);return b}(),Rc=function(){var b=function(b,d){Wb.call(this,{url:b,tag:"video",display:"video",selector:"oit-video",parentNode:d})};Z(b,Wb);return b}(),Ob=function(){var b,e=function(){if(b){var a=u.viewNode,a=a.offsetHeight-a.clientHeight;0===a?b.css("bottom",null):b.css("bottom",a+"px")}};la.onresize(e);D.onzoom(e);
var d=function(a){a=a||{};U.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var c=[];a.collapseButton&&c.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');a.closeButton&&c.push('<input class="oit-closebutton" type="button" value="x">');c.push('<div class="oit-title"></div><div class="oit-body"></div>');this.html(c.join(""));a.collapseButton&&(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,v),this.collapseButton.ontap(this,
v));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,p),this.closeButton.ontap(this,p));this.prop("titletext",this.childByClass("oit-title"));this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,q);this.ontap(this,q);this.onmouseenter(this,f);this.onmouseleave(this,g);y.attach(this);b||(b=y.create("div","oit-toastpane"),u.viewNode.parent().append(b),e());c=b.firstChildElem();a.collapseButton||!c?b.append(this):
b.insert(this,c);a.title&&this.title(a.title);a.content&&this.message(a.content)},c=Z(d,U);c.customEvent("expand");c.customEvent("collapse");var a=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};c.title=function(b){if(void 0!==b){this.titletext.html(b);b=this.attr("class");var c=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,
height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};a(this);this.attr("class",b);this.css("display",c)}return this.titletext.html()};c.message=function(b){if(void 0!==b){this.messagetext.html(b);b=this.attr("class");var c=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",null);this.css({width:null,height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};a(this);this.attr("class",b);this.css("display",c)}return this.messagetext.html()};
c.isCollapsed=function(){return this._collapsed};c.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};c.hideNow=function(){this._hidden=!0;this._pendingHidden=!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};c.show=function(){if(this._hidden||this._pendingHidden)this._pendingHidden=this._hidden=!1,this.css("display",null),delete this._hideCallback};var f=function(){this._mouse=!0},g=function(){this._mouse=
!1;this._pendingHidden&&this.hideNow()},k=function(){this.offtransitionend(k);this._tto&&(ra(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});hb()};c.collapse=function(b){if(this._collapsed)return!1;this._tto&&ra(this._tto);this._collapsed=!0;!1===b?(this.removeClass("oit-expanded"),a(this),this.dispatchCustom("collapse",{})):(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(k),da(function(){a(this)},0,this),this._tto=
da(function(){delete this._tto;k.call(this)},400,this));hb();return!0};var t=function(){this.offtransitionend(t);this._tto&&(ra(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",{});hb()};c.expand=function(b){if(!this._collapsed)return!1;this._tto&&ra(this._tto);this._collapsed=!1;!1===b?(this.addClass("oit-expanded"),a(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(t),a(this),this._tto=
da(function(){delete this._tto;t.call(this)},400,this));hb();return!0};var v=function(a){if(this.collapse())return!1},q=function(a){if(this.expand())return!1},p=function(a){this.hideNow()};D.onreset(function(){b&&(b.destroy(),b=null)});return d}();u.libversion="2020.1.0.110";console.log("Loaded oit.js version 2020.1.0.110");(function(b){Qa.install.dispatch();Qa.install.reset();O.addEventListener("load",function(){Qa.init.dispatch();Qa.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
